---
authors:
- Youssef Ouazzani Chahdi
- Nathan De Carvalho
- GrÃ©goire Szymanski
doc_id: arxiv:2601.03215v1
family_id: arxiv:2601.03215
is_current: true
taxonomy:
  alpha_families: []
  asset_classes: []
  horizons: []
  themes: []
title: Trading with market resistance and concave price impact
url_abs: http://arxiv.org/abs/2601.03215v1
url_html: https://arxiv.org/html/2601.03215v1
venue: arXiv q-fin
version: 1
year: 2026
---


Youssef O. Chahdi
MICS, CentraleSupÃ©lec, youssef.ouazzani-chahdi@centralesupelec.fr

Nathan De Carvalho
LPSM, UniversitÃ© Paris CitÃ©, decarvalho@lpsm.paris

GrÃ©goire Szymanski
DMATH, UniversitÃ© du Luxembourg, gregoire.szymanski@uni.lu

(January 6, 2026)

###### Abstract

We consider an optimal trading problem under a market impact model with endogenous market resistance generated by a sophisticated trader who (partially) detects metaorders and trades against them to exploit price overreactions induced by the order flow. The model features a concave transient impact driven by a power-law propagator with a resistance term responding to the traderâ€™s rate via a fixed-point equation involving a general resistance function. We derive a (non)linear stochastic Fredholm equation as the first-order optimality condition satisfied by optimal trading strategies. Existence and uniqueness of the optimal control are established when the resistance function is linear, and an existence result is obtained when it is strictly convex using coercivity and weak lower semicontinuity of the associated profit-and-loss functional. We also propose an iterative scheme to solve the nonlinear stochastic Fredholm equation and prove an exponential convergence rate. Numerical experiments confirm this behavior and illustrate optimal round-trip strategies under â€œbuyâ€ signals with various decay profiles and different market resistance specifications.

Keywords: Optimal trading, market resistance, concave market impact, propagator model, power-law decay, square root-law, Fredholm equations.
  
  
Mathematics Subject Classification (2020): 91G08, 46N10, 60H30, 91G80.
  
  
JEL Classification: C02, C61, C63, G11, G14.

## 1 Introduction

A central feature of modern financial markets is market impact, that is, the empirically observed positive correlation between the sign of a sizable incoming market order and the subsequent price change. Market impact plays a crucial role in execution costs, risk management, and market design; see, for instance, Almgren etÂ al. [[6](https://arxiv.org/html/2601.03215v1#bib.bib6)], Freyre-Sanders etÂ al. [[21](https://arxiv.org/html/2601.03215v1#bib.bib21)], Hey etÂ al. [[24](https://arxiv.org/html/2601.03215v1#bib.bib24)], Robert etÂ al. [[34](https://arxiv.org/html/2601.03215v1#bib.bib34)], and Bouchaud etÂ al. [[14](https://arxiv.org/html/2601.03215v1#bib.bib14)]. Modeling this phenomenon is particularly relevant when devising strategies for executing metaordersâ€”large transactions placed by institutional traders and implemented through a sequence of smaller child orders over a given time horizon. The presence of market impact has long been recognized as a fundamental feature of market microstructure, and understanding its form is essential from both empirical and theoretical perspectives.

Measuring market impact is inherently challenging due to its noisy nature. Statistical studies therefore tend to focus on the execution of metaorders, which induces a persistent liquidity imbalance and generates price moves that can be identified statistically. However, during the execution of any given metaorder, numerous other trades occur simultaneously, contributing additional noise. Careful statistical procedures and averaging over many metaorders help to filter out part of this noise, allowing some universal properties of market impact to emerge; see, for example, Almgren etÂ al. [[6](https://arxiv.org/html/2601.03215v1#bib.bib6)], Bacry etÂ al. [[7](https://arxiv.org/html/2601.03215v1#bib.bib7)], Bershova and Rakhlin [[11](https://arxiv.org/html/2601.03215v1#bib.bib11)], and Bucci etÂ al. [[15](https://arxiv.org/html/2601.03215v1#bib.bib15)]. Numerous empirical studies document that prices react mechanically during the execution of a metaorder, exhibiting a concave dependence on traded volume that peaks at the end of the metaorderâ€”a phenomenon known as the square-root lawâ€”followed by a convex relaxation phase; see Lillo etÂ al. [[30](https://arxiv.org/html/2601.03215v1#bib.bib30)], Hopman [[26](https://arxiv.org/html/2601.03215v1#bib.bib26)], Almgren etÂ al. [[6](https://arxiv.org/html/2601.03215v1#bib.bib6)], Bershova and Rakhlin [[11](https://arxiv.org/html/2601.03215v1#bib.bib11)], Gatheral [[23](https://arxiv.org/html/2601.03215v1#bib.bib23)], Moro et al. [[31](https://arxiv.org/html/2601.03215v1#bib.bib31)], Bouchaud etÂ al. [[14](https://arxiv.org/html/2601.03215v1#bib.bib14)], Kyle and Obizhaeva [[28](https://arxiv.org/html/2601.03215v1#bib.bib28)], and Sato and Kanazawa [[35](https://arxiv.org/html/2601.03215v1#bib.bib35)]. This square-root dependence, however, primarily holds for large traded volumes, while the impact of small orders is approximately linear in volume, as shown in Bucci etÂ al. [[15](https://arxiv.org/html/2601.03215v1#bib.bib15)]. To capture this dual behavior, Benzaquen and Bouchaud [[9](https://arxiv.org/html/2601.03215v1#bib.bib9)] propose the market impact model

|  |  |  |
| --- | --- | --- |
|  | Mâ€‹Iâ€‹(Qt)â‰ˆcâ€‹Ïƒâ€‹(QtV)1/2â€‹â„±â€‹(QtV),MI(Q\_{t})\approx c\sigma\bigg(\frac{Q\_{t}}{V}\bigg)^{1/2}\mathcal{F}\bigg(\frac{Q\_{t}}{V}\bigg), |  |

where cc is a constant of orderÂ 1, Ïƒ\sigma denotes the daily volatility, VV the typical daily traded volume, QtQ\_{t} the executed volume of the metaorder at time tt, and â„±\mathcal{F} a monotone function satisfying â„±â€‹(x)â‰ˆx\mathcal{F}(x)\approx\sqrt{x} as xâ†’0x\to 0 and â„±â€‹(x)â†’a\mathcal{F}(x)\to a as xâ†’âˆx\to\infty for some a>0a>0.

On the one hand, several theoretical frameworks have been developed to rationalize these empirical findings, ranging from latent order book models, such as those of TÃ³th etÂ al. [[38](https://arxiv.org/html/2601.03215v1#bib.bib38)] and Donier etÂ al. [[18](https://arxiv.org/html/2601.03215v1#bib.bib18)], to equilibrium models with strategic traders; see Gabaix etÂ al. [[22](https://arxiv.org/html/2601.03215v1#bib.bib22)]. More recently, the impact of limit orders has also been investigated, see Chahdi etÂ al. [[16](https://arxiv.org/html/2601.03215v1#bib.bib16)]. A notable recent contribution is due to Durin etÂ al. [[20](https://arxiv.org/html/2601.03215v1#bib.bib20)], who introduce a model with informed traders. The key idea is that certain sophisticated agents can detect the presence of a metaorder and infer its effect on the observed price. Their framework distinguishes between the true price of the asset, which excludes the marketâ€™s overreaction to the metaorder, and the observed price, which incorporates the mechanical impact of the metaorder. By trading strategically against the detected order flow, informed traders generate a form of market resistance that alters the shape of the impact curve. Their analysis leads to two square-root laws of market impactâ€”one in time and one in participation rateâ€”providing a microstructural foundation for well-established empirical results and offering a refined perspective on how informed liquidity provision affects price formation.

On the other hand, a substantial body of literature aims to formalize the connection between reduced-form market impact models IXI^{X} and price features such as signals or volatility, with the goal of deriving trading strategies XX that minimize execution costs. In the seminal work of Almgren etÂ al. [[6](https://arxiv.org/html/2601.03215v1#bib.bib6)], the execution cost of a trading strategy combines temporary and permanent impact terms that shift the asset price linearly with the total traded volume. The traderâ€™s objective is then to minimize the expected cost and risk of liquidation over a finite horizon, typically expressed through a meanâ€“variance functional. A key refinement concerns the transient nature of impact, whereby the observed asset price is modeled as the convolution of past order flow with a decaying kernel GG â€“ a formulation known as the linear propagator, introduced in discrete time by Bouchaud etÂ al. [[12](https://arxiv.org/html/2601.03215v1#bib.bib12)]. In continuous time, the impacted price SXS^{X} is written as

|  |  |  |  |
| --- | --- | --- | --- |
|  | StX=S0+ItX,ItX:=âˆ«0tGâ€‹(tâˆ’s)â€‹dXs,tâ‰¥0,S\_{t}^{X}=S\_{0}+I\_{t}^{X},\qquad I\_{t}^{X}:=\int\_{0}^{t}G(t-s)\,\differential X\_{s},\qquad t\geq 0, |  | (1) |

where XX denotes the signed traded volume. The kernel GG governs how the impact of past trades decays over time: an exponential decay Ã  la Obizhaeva and Wang [[33](https://arxiv.org/html/2601.03215v1#bib.bib33)] corresponds to short memory, whereas power-law kernels, as in the framework of AbiÂ Jaber and Neuman [[1](https://arxiv.org/html/2601.03215v1#bib.bib1)], capture long-lasting effects and are more consistent with empirical propagator estimates; see Bouchaud etÂ al. [[13](https://arxiv.org/html/2601.03215v1#bib.bib13)] and Donier etÂ al. [[18](https://arxiv.org/html/2601.03215v1#bib.bib18)]. A central concern for such models is ensuring financial well-posedness, meaning that the impact model itself cannot be exploited to generate positive profits. Gatheral [[23](https://arxiv.org/html/2601.03215v1#bib.bib23)] showed that this requirement is equivalent to the positive semi-definiteness of the kernel GG, yielding the so-called â€œno-dynamic-arbitrageâ€ condition.

Building on the optimal execution framework with linear price impact, recent works have formulated increasingly general optimal trading problems of the form

|  |  |  |  |
| --- | --- | --- | --- |
|  | supuâˆˆğ’œğ”¼â€‹[âˆ«0T(Î±tâˆ’ItX)â€‹dXt+Mâ€‹(X)],\sup\_{u\in\mathcal{A}}\mathbb{E}\bigg[\int\_{0}^{T}(\alpha\_{t}-I\_{t}^{X})\,\differential X\_{t}+M(X)\bigg], |  | (2) |

where Î±\alpha captures stochastic signals, MM encodes soft constraints and risk-aversion penalties, and ğ’œ\mathcal{A} denotes the set of admissible trading strategies. For instance, AbiÂ Jaber etÂ al. [[3](https://arxiv.org/html/2601.03215v1#bib.bib3)] extend the linear propagator framework to incorporate linear functional constraints (e.g., no-shorting or no-buying constraints, stochastic stop-trading rules), demonstrating that such constraints can be handled within a non-Markovian continuous-time model while preserving numerical tractability. To account for the concave nature of price impact, Alfonsi etÂ al. [[5](https://arxiv.org/html/2601.03215v1#bib.bib5)] introduce a nonlinear impact function applied to exponentially decaying kernels, extending the model of Obizhaeva and Wang [[33](https://arxiv.org/html/2601.03215v1#bib.bib33)], and Hey etÂ al. [[25](https://arxiv.org/html/2601.03215v1#bib.bib25)] derive explicit optimal inventories in this setting under general price signals. Building on these results, AbiÂ Jaber etÂ al. [[4](https://arxiv.org/html/2601.03215v1#bib.bib4)] propose a general nonlinear propagator model formulated in terms of the trading rate, which naturally encompasses nonlinear impact functions as well as power-law decay, and develop numerical methods to compute optimal strategies.

The goal of this paper is to study optimal trading strategies in a market impact setting that incorporates market resistance, following the microstructural insights of Durin etÂ al. [[20](https://arxiv.org/html/2601.03215v1#bib.bib20)]. Leveraging the techniques developed in AbiÂ Jaber etÂ al. [[4](https://arxiv.org/html/2601.03215v1#bib.bib4)], we first establish theoretical results ensuring the well-posedness of the problem, and then derive a first-order optimality condition expressed as a nonlinear stochastic Fredholm equation. This characterization enables the use of numerical methods based on NystrÃ¶m approximations and Fredholm operator inversion, through which we compute optimal trading strategies in practice.

The remainder of the paper is organized as follows. SectionÂ [2](https://arxiv.org/html/2601.03215v1#S2 "2 Inception: a sophisticated trader as a market resistance â€£ Trading with market resistance and concave price impact") introduces market resistance through a simple game-theoretic model and presents the market impact framework of Durin etÂ al. [[20](https://arxiv.org/html/2601.03215v1#bib.bib20)] together with its microstructural foundations. SectionÂ [3](https://arxiv.org/html/2601.03215v1#S3 "3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact") formulates the corresponding optimal trading problem, establishes the main existence results, and derives the associated first-order optimality condition as a (non)linear stochastic Fredholm equation. SectionÂ [4](https://arxiv.org/html/2601.03215v1#S4 "4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact") then presents the numerical scheme used to solve this equation and illustrates the resulting optimal round trips in the presence of stochastic â€œbuyâ€ signals.

## Notations

We fix a finite time horizon T>0T>0 and a filtered probability space (Î©,â„±,(â„±t)tâˆˆ[0,T],â„™)(\Omega,\mathcal{F},(\mathcal{F}\_{t})\_{t\in[0,T]},\mathbb{P}) satisfying the usual conditions. We denote by dt\differential t the Lebesgue measure on the Borel Ïƒ\sigma-algebra â„¬â€‹([0,T])\mathcal{B}([0,T]), and by dtâŠ—â„™\differential t\otimes\mathbb{P} the product measure on the Ïƒ\sigma-algebra â„¬â€‹([0,T])âŠ—â„±\mathcal{B}([0,T])\otimes\mathcal{F}. For all pâ‰¥1p\geq 1, we introduce the standard Banach spaces

|  |  |  |
| --- | --- | --- |
|  | â„’p:={f:[0,T]Ã—Î©â†’â„â€‹progressively measurable:ğ”¼â€‹[âˆ«0T|ft|pâ€‹dt]<âˆ},\mathcal{L}^{p}:=\bigg\{f:[0,T]\times\Omega\to\mathbb{R}\ \text{progressively measurable}\;:\;\mathbb{E}\bigg[\int\_{0}^{T}|f\_{t}|^{p}\differential t\bigg]<\infty\bigg\}, |  |

and, for p=2p=2, we equip â„’2\mathcal{L}^{2} with the inner product

|  |  |  |
| --- | --- | --- |
|  | âŸ¨f,gâŸ©:=ğ”¼â€‹[âˆ«0Tftâ€‹gtâ€‹dt],f,gâˆˆâ„’2,\langle f,g\rangle:=\mathbb{E}\bigg[\int\_{0}^{T}f\_{t}g\_{t}\,\differential t\bigg],\quad f,g\in\mathcal{L}^{2}, |  |

which makes it a Hilbert space with associated norm â€–fâ€–:=âŸ¨f,fâŸ©\|f\|:=\sqrt{\langle f,f\rangle}. Similarly, we denote by LpL^{p}, pâ‰¥1p\geq 1, the standard Banach spaces with respect to the Lebesgue measure. For uâˆˆâ„’1u\in\mathcal{L}^{1} and tâˆˆ[0,T]t\in[0,T], we denote by ğ”¼tâ€‹u\mathbb{E}\_{t}u the conditional expectation of uu with respect to the Ïƒ\sigma-algebra â„±t\mathcal{F}\_{t}.

## 2 Inception: a sophisticated trader as a market resistance

### 2.1 A two-player toy model

Consider a market with a risky asset and two traders, Alice and Bob, observing each otherâ€™s decisions, with the following motivations:

1. 1.

   Alice wants to trade the risky asset following her market signal Î±\alpha,
2. 2.

   Bob distrusts Aliceâ€™s signal and seeks only to profit by trading against her flow; his orders create a resistance flow that opposes her impact.

Denoting by uA,uBu^{A},u^{B} the respective trading rates of Alice and Bob, assume they both suffer trading costs linear in the sum of their trading rates u:=uA+uBu:=u^{A}+u^{B}, following the linear propagator model ([1](https://arxiv.org/html/2601.03215v1#S1.E1 "In 1 Introduction â€£ Trading with market resistance and concave price impact")) with instantaneous slippage as inÂ [[1](https://arxiv.org/html/2601.03215v1#bib.bib1)]. Formally, we write

|  |  |  |
| --- | --- | --- |
|  | Iu:=12â€‹u+ğ†â€‹u,I^{u}:=\frac{1}{2}u+\mathbf{G}u, |  |

where IuI^{u} is the aggregated market impact from both Aliceâ€™s and Bobâ€™s trades, and (ğ†â€‹u)t:=âˆ«0tGâ€‹(t,s)â€‹usâ€‹ds(\mathbf{G}u)\_{t}:=\int\_{0}^{t}G(t,s)u\_{s}\differential s captures the transient nature of market impact via the kernel GG. Their respective PnL functionals are given by

|  |  |  |  |
| --- | --- | --- | --- |
|  | ğ’¥Aâ€‹(uA)\displaystyle\mathcal{J}^{A}(u^{A}) | :=ğ”¼â€‹[âˆ«0T(Î±tAâ€‹(uB)âˆ’ItuA)â€‹utAâ€‹dt],\displaystyle:=\mathbb{E}\bigg[\int\_{0}^{T}\big(\alpha^{A}\_{t}(u^{B})-I\_{t}^{u^{A}}\big)u\_{t}^{A}\differential t\bigg], |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  | ğ’¥Bâ€‹(uB)\displaystyle\mathcal{J}^{B}(u^{B}) | :=ğ”¼â€‹[âˆ«0T(Î±tBâ€‹(uA)âˆ’ItuB)â€‹utBâ€‹dt],\displaystyle:=\mathbb{E}\bigg[\int\_{0}^{T}\big(\alpha^{B}\_{t}(u^{A})-I\_{t}^{u^{B}}\big)u\_{t}^{B}\differential t\bigg], |  |

where Aliceâ€™s and Bobâ€™s respective effective signals Î±A,Î±B\alpha^{A},\alpha^{B} are given by

|  |  |  |
| --- | --- | --- |
|  | Î±Aâ€‹(uB):=Î±âˆ’12â€‹uBâˆ’ğ†â€‹uB,Â andÂ Î±Bâ€‹(uA):=âˆ’12â€‹uAâˆ’ğ†â€‹uA.\displaystyle\alpha^{A}(u^{B}):=\alpha-\frac{1}{2}u^{B}-\mathbf{G}u^{B},\qquad\text{ and }\qquad\alpha^{B}(u^{A}):=-\frac{1}{2}u^{A}-\mathbf{G}u^{A}. |  |

The main question is: can we find a couple of strategies (u^A,u^B)(\hat{u}^{A},\hat{u}^{B}) that maximizes ğ’¥A\mathcal{J}^{A} and ğ’¥B\mathcal{J}^{B} respectively?

ApplyingÂ [[2](https://arxiv.org/html/2601.03215v1#bib.bib2), Proposition 5.1], the first-order conditions for Aliceâ€™s and Bobâ€™s trading problems write respectively

|  |  |  |
| --- | --- | --- |
|  | uA=(ğ¢ğâˆ’ğ)âˆ’1â€‹aÎ±Aâ€‹(uB),Â andÂ uB=(ğ¢ğâˆ’ğ)âˆ’1â€‹aÎ±Bâ€‹(uA),\displaystyle u^{A}=(\mathbf{id}-\mathbf{B})^{-1}a^{\alpha^{A}(u^{B})},\qquad\text{ and }\qquad u^{B}=(\mathbf{id}-\mathbf{B})^{-1}a^{\alpha^{B}(u^{A})}, |  |

where the operator ğ\mathbf{B} as well as the processes aÎ±Aâ€‹(uB)a^{\alpha^{A}(u^{B})}, aÎ±Bâ€‹(uA)a^{\alpha^{B}(u^{A})} are explicitly given by

|  |  |  |  |
| --- | --- | --- | --- |
|  | atÎ±\displaystyle a\_{t}^{\alpha} | :=Î±tâˆ’âŸ¨ğŸ™{t<.}G(.,t),ğƒtâˆ’1ğŸ™{t<.}ğ”¼t[Î±.]âŸ©L2,Î±âˆˆâ„’2\displaystyle:=\alpha\_{t}-\langle\mathds{1}\_{\{t<.\}}G(.,t),\mathbf{D}\_{t}^{-1}\mathds{1}\_{\{t<.\}}\mathbb{E}\_{t}[\alpha\_{.}]\rangle\_{L^{2}},\quad\alpha\in\mathcal{L}^{2} |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  | Bâ€‹(t,s)\displaystyle B(t,s) | :=ğŸ™{s<t}(âŸ¨ğŸ™{t<.}G(.,t),ğƒtâˆ’1ğŸ™{t<.}G(.,s)âŸ©L2âˆ’G(t,s)),\displaystyle:=\mathds{1}\_{\{s<t\}}(\langle\mathds{1}\_{\{t<.\}}G(.,t),\mathbf{D}\_{t}^{-1}\mathds{1}\_{\{t<.\}}G(.,s)\rangle\_{L^{2}}-G(t,s)), |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  | ğƒt\displaystyle\mathbf{D}\_{t} | :=ğ¢ğ+ğ†t+(ğ†t)âˆ—,Gtâ€‹(s,r):=Gâ€‹(s,r)â€‹ğŸ™râ‰¥t,tâˆˆ[0,T].\displaystyle:=\mathbf{id}+\mathbf{G}\_{t}+(\mathbf{G}\_{t})^{\*},\quad G\_{t}(s,r):=G(s,r)\mathds{1}\_{r\geq t},\quad t\in[0,T]. |  |

Now injecting the definition of uAu^{A} into that of uBu^{B} yields the following fixed-point equation for Bobâ€™s trading rate uBu^{B}

|  |  |  |  |
| --- | --- | --- | --- |
|  | uB=(ğ¢ğâˆ’ğ)âˆ’1â€‹aÎ±Bâ€‹((ğ¢ğâˆ’ğ)âˆ’1â€‹aÎ±Aâ€‹(uB)).u^{B}=(\mathbf{id}-\mathbf{B})^{-1}a^{\alpha^{B}((\mathbf{id}-\mathbf{B})^{-1}a^{\alpha^{A}(u^{B})})}. |  | (3) |

Therefore, if there is a u^B\hat{u}^{B} that satisfiesÂ ([3](https://arxiv.org/html/2601.03215v1#S2.E3 "In 2.1 A two-player toy model â€£ 2 Inception: a sophisticated trader as a market resistance â€£ Trading with market resistance and concave price impact")), setting

|  |  |  |
| --- | --- | --- |
|  | u^A=(ğ¢ğâˆ’ğ)âˆ’1â€‹aÎ±Aâ€‹(u^B)\hat{u}^{A}=(\mathbf{id}-\mathbf{B})^{-1}a^{\alpha^{A}(\hat{u}^{B})} |  |

yields a couple (u^A,u^B)(\hat{u}^{A},\hat{u}^{B}) that maximizes ğ’¥A\mathcal{J}^{A} and ğ’¥B\mathcal{J}^{B} respectively. Finally, denoting by r^B:=âˆ’u^B\hat{r}^{B}:=-\hat{u}^{B} the resistance induced by Bobâ€™s trades, Aliceâ€™s optimal PnL rewrites as follows

|  |  |  |  |
| --- | --- | --- | --- |
|  | ğ’¥Aâ€‹(u^A)\displaystyle\mathcal{J}^{A}(\hat{u}^{A}) | =ğ”¼â€‹[âˆ«0T(Î±âˆ’12â€‹(u^Aâˆ’r^B)âˆ’ğ†â€‹(u^Aâˆ’r^B))â€‹u^tAâ€‹dt],\displaystyle=\mathbb{E}\bigg[\int\_{0}^{T}\big(\alpha-\frac{1}{2}(\hat{u}^{A}-\hat{r}^{B})-\mathbf{G}(\hat{u}^{A}-\hat{r}^{B})\big)\hat{u}\_{t}^{A}\differential t\bigg], |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  | r^B\displaystyle\hat{r}^{B} | =âˆ’(ğ¢ğâˆ’ğ)âˆ’1â€‹aÎ±Bâ€‹((ğ¢ğâˆ’ğ)âˆ’1â€‹aÎ±Aâ€‹(âˆ’r^B)),\displaystyle=-(\mathbf{id}-\mathbf{B})^{-1}a^{\alpha^{B}\big((\mathbf{id}-\mathbf{B})^{-1}a^{\alpha^{A}(-\hat{r}^{B})}\big)}, |  |

and this simple two-player game setting indeed motivates the introduction of a market resistance caused by the presence of an informed trader, and solution to a fixed-point equation.

### 2.2 A general market resistance model

Starting again from the linear propagator framework ([1](https://arxiv.org/html/2601.03215v1#S1.E1 "In 1 Introduction â€£ Trading with market resistance and concave price impact")), consider the following impact kernel specification

|  |  |  |  |
| --- | --- | --- | --- |
|  | Gâ€‹(t):=Îºâˆ+GÎ»,Î½â€‹(t),t>0,G(t)\;:=\;\kappa\_{\infty}+G\_{\lambda,\nu}(t),\quad t>0, |  | (4) |

which combines a permanent component proportional to Îºâˆâ‰¥0\kappa\_{\infty}\geq 0 capturing the traderâ€™s contribution to the long-term fundamental value of the asset, and a power-law decaying kernel

|  |  |  |  |
| --- | --- | --- | --- |
|  | GÎ»,Î½â€‹(t):=Î»â€‹tÎ½âˆ’1,Î»>0,Î½âˆˆ(12,1),G\_{\lambda,\nu}(t):=\lambda t^{\nu-1},\quad\lambda>0,\quad\nu\in\bigg(\frac{1}{2},1\bigg), |  | (5) |

reproducing the transient long-memory price impact of trades empirically observed in order flow, see Chapter 13.2.1 from [[14](https://arxiv.org/html/2601.03215v1#bib.bib14)] and references therein. GG is positive semi-definite, which ensures the absence of dynamic price manipulation and rules out profitable round trips [[23](https://arxiv.org/html/2601.03215v1#bib.bib23)]. Although we focus on specification ([4](https://arxiv.org/html/2601.03215v1#S2.E4 "In 2.2 A general market resistance model â€£ 2 Inception: a sophisticated trader as a market resistance â€£ Trading with market resistance and concave price impact")) for concreteness and interpretation, the framework extends naturally to other admissible kernels, such as completely monotone kernels or sums of exponentials, which have also been proposed in the literature to capture different impact decay patterns, see for instance [[4](https://arxiv.org/html/2601.03215v1#bib.bib4)].

A key implication is that an impact of the form âˆ«0tGâ€‹(tâˆ’s)â€‹dXs\int\_{0}^{t}G(t-s)\,\differential X\_{s}, with GG given by ([4](https://arxiv.org/html/2601.03215v1#S2.E4 "In 2.2 A general market resistance model â€£ 2 Inception: a sophisticated trader as a market resistance â€£ Trading with market resistance and concave price impact")), overreacts at short horizons: for any finite t>0t>0, one has Gâ€‹(t)>limsâ†’âˆGâ€‹(s)=ÎºâˆG(t)>\lim\_{s\to\infty}G(s)=\kappa\_{\infty}. In economic terms, prices initially move more than what is justified by the long-run information content of the traderâ€™s order flow. This transient overshooting creates a temporary mispricing between the observed market price and the traderâ€™s contribution to the long-term efficient long-term price, which is considered a temporary price signal denoted by Î±r\alpha^{r} such that

|  |  |  |  |
| --- | --- | --- | --- |
|  | Î±tr:=âˆ«0t(Gâ€‹(tâˆ’s)âˆ’Gâ€‹(âˆ))â€‹(usâˆ’rsu)â€‹ds=âˆ«0tGÎ»,Î½â€‹(tâˆ’s)â€‹(usâˆ’rsu)â€‹ds.\alpha\_{t}^{r}:=\int\_{0}^{t}\big(G(t-s)-G(\infty)\big)\big(u\_{s}-r^{u}\_{s}\big)\,\differential s=\int\_{0}^{t}G\_{\lambda,\nu}(t-s)\big(u\_{s}-r^{u}\_{s}\big)\,\differential s. |  | (6) |

In classical linear propagator models, Î±r\alpha^{r} is purely mechanical and is not acted upon. A key contribution of Durin etÂ al. [[20](https://arxiv.org/html/2601.03215v1#bib.bib20)] is to formulate an endogenous correction to such mispricing caused by the traderâ€™s strategy uu by introducing a continuous-time market resistance rur^{u}, generated by sophisticated traders. These agents partially detect the presence of the traderâ€™s metaorder, infer the transient component of its impact [[39](https://arxiv.org/html/2601.03215v1#bib.bib39), [37](https://arxiv.org/html/2601.03215v1#bib.bib37)], and trade against it to benefit from Î±r\alpha^{r}. Their activity produces an opposing flow that dampens impact dynamically, rather than
letting prices passively relax through the kernel GG. In their framework, the pathwise market impact of a metaorder with execution strategy uu at date tâ‰¥0t\geq 0, meaning that Xt=âˆ«0tusâ€‹dsX\_{t}=\int\_{0}^{t}u\_{s}\,\differential s, is given by

|  |  |  |  |
| --- | --- | --- | --- |
|  | Mâ€‹Iâ€‹(u,t)=âˆ«0tGâ€‹(tâˆ’s)â€‹(usâˆ’rsu)â€‹ds,MI(u,t)=\int\_{0}^{t}G(t-s)\big(u\_{s}-r^{u}\_{s}\big)\,\differential s, |  | (7) |

where rur^{u} represents the endogenous reaction rate of sophisticated traders. This reaction satisfies the following fixed-point equation

|  |  |  |  |
| --- | --- | --- | --- |
|  | rtu=ğ’°(Î±tr),i.e.,rtu=ğ’°(âˆ«0tGÎ»,Î½(tâˆ’s)(usâˆ’rsu)ds),r^{u}\_{t}=\mathcal{U}\!\left(\alpha\_{t}^{r}\right),\quad i.e.,\;r^{u}\_{t}=\mathcal{U}\!\left(\int\_{0}^{t}G\_{\lambda,\nu}(t-s)\big(u\_{s}-r^{u}\_{s}\big)\,\differential s\right), |  | (8) |

for some increasing function ğ’°:â„â†’â„\mathcal{U}:\mathbb{R}\to\mathbb{R}. A natural specification for ğ’°\mathcal{U} can be derived heuristically. Assume that price impact follows a square-root law, that is, if the sophisticated trader invests an amount xx proportional to this signal Î±r\alpha^{r}, the expected gain is Î±râ€‹x\alpha^{r}x, while the associated impact cost is kâ€‹xâ€‹xk\sqrt{x}\,x for some k>0k>0. The expected profit, Î±râ€‹xâˆ’kâ€‹xâ€‹x\alpha^{r}x-k\sqrt{x}\,x, is maximized for x=k~â€‹(Î±r)2x=\tilde{k}\,\left(\alpha^{r}\right)^{2} with k~>0\tilde{k}>0, which motivates taking ğ’°â€‹(x)\mathcal{U}(x) in ([8](https://arxiv.org/html/2601.03215v1#S2.E8 "In 2.2 A general market resistance model â€£ 2 Inception: a sophisticated trader as a market resistance â€£ Trading with market resistance and concave price impact")) proportional to x2x^{2}. This particular choice is not required in the remainder of the paper.

Importantly, the resistance mechanism is backed by a precise microstructural foundation where it can be derived from a high-frequency model in which market orders follow self-exciting point processes and prices are set as conditional expectations of future order flow. When informed agents partially filter out the metaorder component and trade against the resulting mispricing, the scaling limit of the model leads exactly to ([7](https://arxiv.org/html/2601.03215v1#S2.E7 "In 2.2 A general market resistance model â€£ 2 Inception: a sophisticated trader as a market resistance â€£ Trading with market resistance and concave price impact"))â€“([8](https://arxiv.org/html/2601.03215v1#S2.E8 "In 2.2 A general market resistance model â€£ 2 Inception: a sophisticated trader as a market resistance â€£ Trading with market resistance and concave price impact")). We refer to Durin etÂ al. [[20](https://arxiv.org/html/2601.03215v1#bib.bib20)] for the full derivation.

Economically, rur^{u} can be interpreted as a stabilizing force. When a metaorder pushes prices above their efficient level, sophisticated traders increase their activity, absorbing part of the order flow and limiting further price pressure. When the mispricing shrinks, their activity naturally subsides. The function ğ’°\mathcal{U} governs how aggressively the resistance reacts to perceived mispricing, as illustrated later on in FigureÂ [6](https://arxiv.org/html/2601.03215v1#S4.F6 "Figure 6 â€£ Optimal round-trips for different convexity parameters. â€£ 4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact").

### 2.3 Properties of the market resistance

The introduction of a resistance term rur^{u} satisfying ([8](https://arxiv.org/html/2601.03215v1#S2.E8 "In 2.2 A general market resistance model â€£ 2 Inception: a sophisticated trader as a market resistance â€£ Trading with market resistance and concave price impact")) fundamentally alters the shape of market impact. Assuming a buy strategy uâ‰¥0u\geq 0 with compact support, the market impact Mâ€‹IMI from ([7](https://arxiv.org/html/2601.03215v1#S2.E7 "In 2.2 A general market resistance model â€£ 2 Inception: a sophisticated trader as a market resistance â€£ Trading with market resistance and concave price impact")) is decomposed into a permanent and a transient components, denoted respectively by Pâ€‹Mâ€‹IPMI and Tâ€‹Mâ€‹ITMI, such that

|  |  |  |
| --- | --- | --- |
|  | Pâ€‹Mâ€‹Iâ€‹(u):=limtâ†’âˆMâ€‹Iâ€‹(u,t)=Îºâˆâ€‹âˆ«0âˆ(usâˆ’rsu)â€‹ds,\displaystyle PMI(u):=\lim\_{t\to\infty}MI(u,t)=\kappa\_{\infty}\int\_{0}^{\infty}\big(u\_{s}-r^{u}\_{s}\big)\,\differential s, |  |
|  |  |  |
| --- | --- | --- |
|  | Tâ€‹Mâ€‹Iâ€‹(u,t):=Mâ€‹Iâ€‹(u,t)âˆ’Pâ€‹Mâ€‹Iâ€‹(u)=âˆ«0tGÎ»,Î½â€‹(tâˆ’s)â€‹(usâˆ’rsu)â€‹dsâˆ’Îºâˆâ€‹âˆ«tâˆ(usâˆ’rsu)â€‹ds.\displaystyle TMI(u,t):=MI(u,t)-PMI(u)=\int\_{0}^{t}G\_{\lambda,\nu}(t-s)\big(u\_{s}-r^{u}\_{s}\big)\,\differential s-\kappa\_{\infty}\int\_{t}^{\infty}\big(u\_{s}-r^{u}\_{s}\big)\,\differential s. |  |

As in standard propagator models, impact is concave in time and decays as a power law with exponent Î½âˆ’1\nu-1; see [[14](https://arxiv.org/html/2601.03215v1#bib.bib14), SectionÂ 13.4.4] and FigureÂ [1](https://arxiv.org/html/2601.03215v1#S2.F1 "Figure 1 â€£ 2.3 Properties of the market resistance â€£ 2 Inception: a sophisticated trader as a market resistance â€£ Trading with market resistance and concave price impact").

![Refer to caption](x1.png)


(a) Market impact profile

![Refer to caption](x2.png)


(b) Trading rate uu and its resulting endogenous resistance rate rur^{u}

Figure 1: Market impact and trading rates for Î½=0.5\nu=0.5, Î»=1\lambda=1,
uâ€‹(t)=0.3â€‹â€‰10â‰¤tâ‰¤1u(t)=0.3\,\mathbf{1}\_{0\leq t\leq 1}, and ğ’°â€‹(x)=x2\mathcal{U}(x)=x^{2}.

A particularly important implication concerns the dependence of impact on the participation rate. Consider a normalized execution profile uu (i.e., âˆ«0âˆuâ€‹(s)â€‹ds=1\int\_{0}^{\infty}u(s)\,\differential s=1) and suppose trading occurs at rate Î³â€‹u\gamma u. In this setting, Î³\gamma has no unit, and acts as a proxy for the participation rate, which is Î³/(Î³+V)\gamma/(\gamma+V), where VV denotes the typical background market volume. Under the power-law specification ğ’°â€‹(x)=câ€‹xc\mathcal{U}(x)=cx^{c} with c>1c>1, Durin etÂ al. [[20](https://arxiv.org/html/2601.03215v1#bib.bib20), TheoremÂ 9] show that market impact satisfies

|  |  |  |
| --- | --- | --- |
|  | Mâ€‹Iâ€‹(Î³â€‹u,t)âˆ¼Î³â†’âˆÎ³1/c.MI(\gamma u,t)\sim\_{\gamma\to\infty}\gamma^{1/c}. |  |

Choosing c=2c=2 recovers the empirically observed square-root law. In this interpretation, the square-root scaling is not imposed exogenously but emerges from the interaction between aggressive execution and endogenous market resistance. Although this theorem is asymptotic and valid for large participation rates, FigureÂ [2](https://arxiv.org/html/2601.03215v1#S2.F2 "Figure 2 â€£ 2.3 Properties of the market resistance â€£ 2 Inception: a sophisticated trader as a market resistance â€£ Trading with market resistance and concave price impact") illustrates that the scaling remains a good approximation even for moderate values of Î³\gamma.

![Refer to caption](x3.png)


Figure 2: Market impact as a function of Î³\gamma for Î½=0.5\nu=0.5,
Î»=1\lambda=1, and ğ’°â€‹(x)=x2\mathcal{U}(x)=x^{2}. A power-law fit of the form
Mâ€‹I=1.172â‹…Î³0.6086MI=1.172\cdot\gamma^{0.6086} is shown.

## 3 Optimal trading with market resistance

### 3.1 Problem formulation

Consider a risky asset whose unaffected price process SS is given by

|  |  |  |  |
| --- | --- | --- | --- |
|  | St=Pt+Mt,tâˆˆ[0,T],S\_{t}=P\_{t}+M\_{t},\quad t\in[0,T], |  | (9) |

where PP a finite variation process valued in â„’2\mathcal{L}^{2} and MM is a centered square-integrable martingale. We consider an agent with an initial holding X0âˆˆâ„X\_{0}\in\mathbb{R} of this asset controlling his trading rate uâˆˆâ„’2u\in\mathcal{L}^{2} of his inventory XuX^{u} such that

|  |  |  |  |
| --- | --- | --- | --- |
|  | Xtu:=X0+âˆ«0tusâ€‹ds,tâˆˆ[0,T].X\_{t}^{u}:=X\_{0}+\int\_{0}^{t}u\_{s}\,\differential s,\quad t\in[0,T]. |  | (10) |

In particular,

|  |  |  |  |
| --- | --- | --- | --- |
|  | suptâˆˆ[0,T]ğ”¼â€‹[|Xtu|2]<âˆ.\sup\_{t\in[0,T]}\mathbb{E}[|X\_{t}^{u}|^{2}]<\infty. |  | (11) |

Furthermore, trading the asset at the rate uu impacts the unaffected price SS such that the effective trading price SuS^{u} becomes

|  |  |  |  |
| --- | --- | --- | --- |
|  | Su:=S+Iu,S^{u}:=S+I^{u}, |  | (12) |

where the price impact model IuI^{u} is specified as follows

|  |  |  |  |
| --- | --- | --- | --- |
|  | Itu:=Î³2â€‹ut+(ğ‡+ğ†)â€‹(uâˆ’ru)t,tâˆˆ[0,T].I\_{t}^{u}:=\frac{\gamma}{2}u\_{t}+(\mathbf{H}+\mathbf{G})(u-r^{u})\_{t},\quad t\in[0,T]. |  | (13) |

Here, ğ‡\mathbf{H} and ğ†\mathbf{G} are two operators on â„’2\mathcal{L}^{2} modeling the permanent and transient market impacts, respectively, while Î³â‰¥0\gamma\geq 0 denotes, from this point onward, the (constant) slippage cost intensity. As motivated in SectionÂ [2](https://arxiv.org/html/2601.03215v1#S2 "2 Inception: a sophisticated trader as a market resistance â€£ Trading with market resistance and concave price impact"), rur^{u} denotes the marketâ€™s reaction or resistance to the trading strategy uu, capturing the nonlinear nature of price impact as it solves the following nonlinear Volterra equation

|  |  |  |  |
| --- | --- | --- | --- |
|  | rtu=ğ’°â€‹(ğ†â€‹(uâˆ’ru)t),tâˆˆ[0,T],r^{u}\_{t}=\mathcal{U}\big(\mathbf{G}(u-r^{u})\_{t}\big),\quad t\in[0,T], |  | (14) |

where the ğ’°\mathcal{U} is called the resistance function. In order to ensure the well-posedness of the price impact modelÂ ([13](https://arxiv.org/html/2601.03215v1#S3.E13 "In 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact"))â€“([14](https://arxiv.org/html/2601.03215v1#S3.E14 "In 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")), we make the following assumptions on the operators ğ‡\mathbf{H}, ğ†\mathbf{G} and on the resistance function ğ’°\mathcal{U}.

###### Definition 3.1.

A Volterra kernel G:[0,T]2â†’â„G\colon[0,T]^{2}\to\mathbb{R} is said to be *admissible* if

|  |  |  |  |
| --- | --- | --- | --- |
|  | CG:=suptâˆˆ[0,T]âˆ«0t|Gâ€‹(t,s)|2â€‹ds<âˆ.C\_{G}:=\sup\_{t\in[0,T]}\int\_{0}^{t}|G(t,s)|^{2}\differential s<\infty. |  | (15) |

Any admissible kernel GG induces a unique linear and bounded integral operator ğ†:â„’2â†¦â„’2\mathbf{G}:\mathcal{L}^{2}\mapsto\mathcal{L}^{2} defined by

|  |  |  |
| --- | --- | --- |
|  | (ğ†â€‹u)t:=âˆ«0tGâ€‹(t,s)â€‹usâ€‹ds,tâˆˆ[0,T],uâˆˆâ„’2,(\mathbf{G}u)\_{t}:=\int\_{0}^{t}G(t,s)u\_{s}\differential s,\quad t\in[0,T],\quad u\in\mathcal{L}^{2}, |  |

such that, by Cauchy-Schwarzâ€™s inequality,

|  |  |  |  |
| --- | --- | --- | --- |
|  | â€–ğ†â€‹uâ€–2â‰¤Tâ€‹CGâ€‹â€–uâ€–2,uâˆˆâ„’2.\|\mathbf{G}u\|^{2}\leq TC\_{G}\|u\|^{2},\quad u\in\mathcal{L}^{2}. |  | (16) |

As a consequence of Fubiniâ€™s theorem and the tower property of the conditional expectation, the unique linear and bounded adjoint operator ğ†âˆ—:â„’2â†’â„’2\mathbf{G}^{\ast}:\mathcal{L}^{2}\to\mathcal{L}^{2} of ğ†\mathbf{G} is explicitly given by

|  |  |  |
| --- | --- | --- |
|  | (ğ†âˆ—â€‹u)t:=âˆ«tTGâ€‹(s,t)â€‹ğ”¼tâ€‹[us]â€‹ds,tâˆˆ[0,T],uâˆˆâ„’2.(\mathbf{G}^{\ast}u)\_{t}:=\int\_{t}^{T}G(s,t)\mathbb{E}\_{t}[u\_{s}]\differential s,\quad t\in[0,T],\quad u\in\mathcal{L}^{2}. |  |

The boundedness of ğ†âˆ—\mathbf{G}^{\ast} is ensured by conditional Jensenâ€™s inequality and Fubiniâ€™s theorem such that

|  |  |  |  |
| --- | --- | --- | --- |
|  | â€–ğ†âˆ—â€‹uâ€–2â‰¤Tâ€‹CGâ€‹â€–uâ€–2,uâˆˆâ„’2,\|\mathbf{G}^{\ast}u\|^{2}\leq TC\_{G}\|u\|^{2},\quad u\in\mathcal{L}^{2}, |  | (17) |

see for example [[19](https://arxiv.org/html/2601.03215v1#bib.bib19), Chapter 6, Section 2].

###### Assumption A.

The operator ğ†\mathbf{G} is an admissible convolution operator: there exists an admissible kernel function G:[0,âˆ)â†’â„G:[0,\infty)\to\mathbb{R} such that for each uâˆˆâ„’2u\in\mathcal{L}^{2} and each tâˆˆ[0,T]t\in[0,T], we have

|  |  |  |
| --- | --- | --- |
|  | ğ†â€‹ut=âˆ«0tGâ€‹(tâˆ’s)â€‹usâ€‹ds.\mathbf{G}u\_{t}=\int\_{0}^{t}G(t-s)u\_{s}\,\differential s. |  |

We also assume GG is continuous on (0,âˆ)(0,\infty), completely monotone (see DefinitionÂ [B.1](https://arxiv.org/html/2601.03215v1#A2.Thmtheorem1 "Definition B.1 (Completely monotone function). â€£ B.1 Completely monotone functions â€£ Appendix B Mathematical tools â€£ Trading with market resistance and concave price impact")), and L2L^{2} integrable on [0,T][0,T] and we write

|  |  |  |
| --- | --- | --- |
|  | â€–Gâ€–L2â€‹([0,T])2=âˆ«0TGâ€‹(s)2â€‹ds.\|G\|\_{L^{2}([0,T])}^{2}=\int\_{0}^{T}G(s)^{2}\,\differential s. |  |

Finally, we assume that GG satisfies the following continuity assumption

|  |  |  |
| --- | --- | --- |
|  | limtâ†’t0âˆ«0âˆ|Gâ€‹(t0âˆ’s)âˆ’Gâ€‹(tâˆ’s)|â€‹dsâ†’0.\lim\limits\_{t\to t\_{0}}\int\_{0}^{\infty}|G(t\_{0}-s)-G(t-s)|\,\differential s\to 0. |  |

###### Assumption B.

There exists a nonnegative constant Îºâˆ\kappa\_{\infty} such that for each uâˆˆâ„’2u\in\mathcal{L}^{2} and each tâˆˆ[0,T]t\in[0,T],

|  |  |  |  |
| --- | --- | --- | --- |
|  | ğ‡â€‹ut=Îºâˆâ€‹âˆ«0tusâ€‹ds.\mathbf{H}u\_{t}=\kappa\_{\infty}\int\_{0}^{t}u\_{s}\,\differential s. |  | (18) |

###### Assumption C.

The function ğ’°\mathcal{U} is LL-Lipschitz continuous with ğ’°â€‹(0)=0\mathcal{U}(0)=0 and satisfies

|  |  |  |
| --- | --- | --- |
|  | lim|x|â†’âˆğ’°â€‹(x)x=Î´â‰¥0.\lim\limits\_{|x|\to\infty}\frac{\mathcal{U}(x)}{x}=\delta\geq 0. |  |

###### Remark 1.

AssumptionÂ [C](https://arxiv.org/html/2601.03215v1#ThmAssumption3 "Assumption C. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact") implies that ğ’°\mathcal{U} is asymptotically close to linear. In particular, it includes the linear case, the bounded case and all cases of interest discussed in SectionÂ [3.3](https://arxiv.org/html/2601.03215v1#S3.SS3 "3.3 The general case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact"). Moreover, the assumption that ğ’°â€‹(0)=0\mathcal{U}(0)=0 is not essential but is considered to simplify the computations.

Given any trading strategy uâˆˆâ„’2u\in\mathcal{L}^{2}, the following lemma ensures that the resistance fixed-point equationÂ ([14](https://arxiv.org/html/2601.03215v1#S3.E14 "In 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")) admits a unique solution ruâˆˆâ„’2r^{u}\in\mathcal{L}^{2} under a linear growth assumption on ğ’°\mathcal{U}.

###### Lemma 3.2.

Let uâˆˆâ„’2u\in\mathcal{L}^{2}. Suppose that AssumptionsÂ [A](https://arxiv.org/html/2601.03215v1#ThmAssumption1 "Assumption A. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact") andÂ [B](https://arxiv.org/html/2601.03215v1#ThmAssumption2 "Assumption B. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact") hold and that ğ’°\mathcal{U} is Lipschitz continuous, then there exists a unique solution ruâˆˆâ„’2r^{u}\in\mathcal{L}^{2} toÂ ([14](https://arxiv.org/html/2601.03215v1#S3.E14 "In 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")). Moreover, the mapping uâ†¦ruu\mapsto r^{u} is Lipschitz continuous on â„’2\mathcal{L}^{2}.

###### Proof.

See AppendixÂ [D.1](https://arxiv.org/html/2601.03215v1#A4.SS1 "D.1 Proof of Lemma 3.2 â€£ Appendix D Properties of the market resistance ğ‘Ÿ^ğ‘¢ â€£ Trading with market resistance and concave price impact").
âˆ

LemmaÂ [3.2](https://arxiv.org/html/2601.03215v1#S3.Thmtheorem2 "Lemma 3.2. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact") guarantees that the price impact IuI^{u} fromÂ ([13](https://arxiv.org/html/2601.03215v1#S3.E13 "In 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")) as well as the execution price (Stu)tâˆˆ[0,T](S^{u}\_{t})\_{t\in[0,T]} fromÂ ([12](https://arxiv.org/html/2601.03215v1#S3.E12 "In 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")) are well-defined â„’2\mathcal{L}^{2} processes, for every uâˆˆâ„’2u\in\mathcal{L}^{2}. We are now in place to introduce the agentâ€™s Profit and Loss (PnL) functional

|  |  |  |  |
| --- | --- | --- | --- |
|  | ğ’¥â€‹(u):=ğ”¼â€‹[âˆ’âˆ«0TStuâ€‹utâ€‹dt+XTuâ€‹STâˆ’Ï•2â€‹âˆ«0T(Xtu)2â€‹dtâˆ’Ï±2â€‹(XTu)2],uâˆˆâ„’2,\mathcal{J}(u):=\mathbb{E}\bigg[-\int\_{0}^{T}S\_{t}^{u}u\_{t}\differential t+X\_{T}^{u}S\_{T}-\frac{\phi}{2}\int\_{0}^{T}(X\_{t}^{u})^{2}\differential t-\frac{\varrho}{2}(X\_{T}^{u})^{2}\bigg],\quad u\in\mathcal{L}^{2}, |  | (19) |

where the first term represents the profit and loss induced by the trading rate uu, the second one values the terminal inventory against the terminal unaffected price [[3](https://arxiv.org/html/2601.03215v1#bib.bib3), Remark 2.1], the third one encodes risk aversion with weight Ï•â‰¥0\phi\geq 0, and the last one penalizes the terminal inventory with weight Ï±â‰¥0\varrho\geq 0. Note that ğ’¥\mathcal{J} is indeed well-defined under AssumptionsÂ [B](https://arxiv.org/html/2601.03215v1#ThmAssumption2 "Assumption B. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact"),Â [A](https://arxiv.org/html/2601.03215v1#ThmAssumption1 "Assumption A. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact"),Â [C](https://arxiv.org/html/2601.03215v1#ThmAssumption3 "Assumption C. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact") andÂ ([11](https://arxiv.org/html/2601.03215v1#S3.E11 "In 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")). Our objective is to find trading strategies u^âˆˆâ„’2\hat{u}\in\mathcal{L}^{2} that maximize the performance functional ğ’¥\mathcal{J} such that

|  |  |  |  |
| --- | --- | --- | --- |
|  | ğ’¥â€‹(u^)=supuâˆˆâ„’2ğ’¥â€‹(u).\mathcal{J}(\hat{u})=\sup\_{u\in\mathcal{L}^{2}}\mathcal{J}(u). |  | (20) |

Inserting the definitions of the final inventory XTuX\_{T}^{u} fromÂ ([10](https://arxiv.org/html/2601.03215v1#S3.E10 "In 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")) and the effective price SuS^{u} fromÂ ([12](https://arxiv.org/html/2601.03215v1#S3.E12 "In 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")) into ğ’¥\mathcal{J} fromÂ ([19](https://arxiv.org/html/2601.03215v1#S3.E19 "In 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")), while using the tower property of the conditional expectation, allows us to rewrite the functional ğ’¥\mathcal{J} in the standard formÂ ([2](https://arxiv.org/html/2601.03215v1#S1.E2 "In 1 Introduction â€£ Trading with market resistance and concave price impact")) such that

|  |  |  |  |
| --- | --- | --- | --- |
|  | ğ’¥â€‹(u)=ğ”¼â€‹[âˆ«0T(Î±tâˆ’Itu)â€‹utâ€‹dt+Mâ€‹(Xu)]+X0â€‹ğ”¼â€‹[ST],uâˆˆâ„’2,\mathcal{J}(u)=\mathbb{E}\bigg[\int\_{0}^{T}(\alpha\_{t}-I\_{t}^{u})u\_{t}\differential t+M(X^{u})\bigg]+X\_{0}\mathbb{E}[S\_{T}],\quad u\in\mathcal{L}^{2}, |  | (21) |

where Î±\alpha is the alpha-signal from the drift of the fundamental asset price SS, defined by

|  |  |  |  |
| --- | --- | --- | --- |
|  | Î±t=ğ”¼tâ€‹[STâˆ’St]=ğ”¼tâ€‹[PTâˆ’Pt],tâˆˆ[0,T],\alpha\_{t}=\mathbb{E}\_{t}[S\_{T}-S\_{t}]=\mathbb{E}\_{t}[P\_{T}-P\_{t}],\quad t\in[0,T], |  | (22) |

and

|  |  |  |
| --- | --- | --- |
|  | Mâ€‹(Xu):=âˆ’Ï•2â€‹âˆ«0T(Xtu)2â€‹dtâˆ’Ï±2â€‹(XTu)2,M(X^{u}):=-\frac{\phi}{2}\int\_{0}^{T}(X\_{t}^{u})^{2}\differential t-\frac{\varrho}{2}(X\_{T}^{u})^{2}, |  |

in a similar way to AbiÂ Jaber etÂ al. [[3](https://arxiv.org/html/2601.03215v1#bib.bib3), [4](https://arxiv.org/html/2601.03215v1#bib.bib4)] and DeÂ Carvalho [[17](https://arxiv.org/html/2601.03215v1#bib.bib17)].

###### Remark 2.

A natural question concerns the choice of the window length TT. In a real-time trading setup, how should this model be applied, and what value of TT is appropriate?

In practice, trading firms typically rely on statistical alpha signals computed over short horizons. For example, suppose an agent trades every 10 minutes using a 10-minute alpha on a given stock. Solving the associated optimal trading problem requires, in our framework, a discrete iterative scheme that takes as input a known trajectory of the buy/sell signal. This assumption is somewhat unrealistic, since the agent only observes a single alpha value every 10 minutes rather than a continuous signal.

How, then, can this framework be used with a single discrete alpha observation? One approach is to solve a sequence of optimisation problems, each over a 10-minute window (or, more generally, at the rebalancing frequency of the strategy). Within each window, one may reconstruct a discrete trajectory for the signalâ€”either by recomputing the statistical alpha on smaller subwindows, or by treating the observed alpha as constant over these subintervalsâ€”and then apply the numerical scheme described in SectionÂ [4](https://arxiv.org/html/2601.03215v1#S4 "4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact"). This yields a practical real-time implementation consistent with the statistical nature of alpha signals.

#### Reformulation with operators on â„’2\mathcal{L}^{2}.

To better analyze the problem, we recast it in operator formulation.
First, note that in view of LemmaÂ [3.2](https://arxiv.org/html/2601.03215v1#S3.Thmtheorem2 "Lemma 3.2. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact"), we know that there exists an operator ğ‘:â„’2â†’â„’2\mathbf{R}:\mathcal{L}^{2}\to\mathcal{L}^{2} such that ru=ğ‘â€‹(u),uâˆˆâ„’2r^{u}=\mathbf{R}(u),\;u\in\mathcal{L}^{2}. Using this notation, the market impact ItuI\_{t}^{u} can be rewritten as

|  |  |  |
| --- | --- | --- |
|  | Itu=Î³2â€‹ut+((ğ‡+ğ†)âˆ˜(ğˆâˆ’ğ‘)â€‹u)t,tâˆˆ[0,T]I\_{t}^{u}=\frac{\gamma}{2}u\_{t}+\big((\mathbf{H}+\mathbf{G})\circ(\mathbf{I}-\mathbf{R})u\big)\_{t},\quad t\in[0,T] |  |

where ğˆ\mathbf{I} stands for the identity operator in â„’2\mathcal{L}^{2} such that ğˆâ€‹ut=ut\mathbf{I}u\_{t}=u\_{t} for every uâˆˆâ„’2u\in\mathcal{L}^{2} and tâˆˆ[0,T]t\in[0,T]. To use the same operator notations, we also write ğ—â€‹u=Xu{\mathbf{X}}u=X^{u} which defines an operator in â„’2\mathcal{L}^{2}. Thus, the gain functionalÂ ([21](https://arxiv.org/html/2601.03215v1#S3.E21 "In 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")) becomes

|  |  |  |  |
| --- | --- | --- | --- |
|  | ğ’¥â€‹(u)=âŸ¨u,Î±âŸ©âˆ’Î³2â€‹â€–uâ€–2âˆ’âŸ¨u,(ğ‡+ğ†)âˆ˜(ğˆâˆ’ğ‘)â€‹uâŸ©âˆ’Ï•2â€‹â€–ğ—â€‹uâ€–2âˆ’Ï±2â€‹ğ”¼â€‹[(ğ—â€‹u)T2]+X0â€‹ğ”¼â€‹[ST].\mathcal{J}(u)=\langle u,\alpha\rangle-\frac{\gamma}{2}\norm{u}^{2}-\langle u,(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}-\mathbf{R})u\rangle-\frac{\phi}{2}\norm{{\mathbf{X}}u}^{2}-\frac{\varrho}{2}\mathbb{E}[({\mathbf{X}}u)\_{T}^{2}]+X\_{0}\mathbb{E}[S\_{T}]. |  | (23) |

All these operators act on â„’2\mathcal{L}^{2}. However, we can also see them as operator on L2L^{2}. In the following, we consider either of each representation depending of the context.

### 3.2 The linear case

In this section, we assume ğ’°\mathcal{U} to be linear.
We focus on this case for two reasons. First, the operator ğ‘\mathbf{R} becomes linear, which renders the analysis of ğ’¥\mathcal{J} straightforward: ğ’¥\mathcal{J} becomes a quadratic form, and the existence and uniqueness of a maximzer follows from the positive semi-definiteness of the operator (ğ‡+ğ†)âˆ˜(ğˆâˆ’ğ‘)(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}-\mathbf{R}). Second, the linear case serves as a building block for the proofs in the general setting. We now formalize the main results of this section in the following statement.

###### Theorem 3.3.

Suppose that ğ’°â€‹(x)=aâ€‹x\mathcal{U}(x)=ax for some aâ‰¥0a\geq 0 for every xâˆˆâ„x\in\mathbb{R}. Suppose also that AssumptionsÂ [A](https://arxiv.org/html/2601.03215v1#ThmAssumption1 "Assumption A. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact") andÂ [B](https://arxiv.org/html/2601.03215v1#ThmAssumption2 "Assumption B. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact") hold. Then the functional âˆ’ğ’¥-\mathcal{J} is Î³\gamma-convex, coercive and therefore ğ’¥\mathcal{J} admits a unique maximizer u^\widehat{u} characterised by

|  |  |  |  |
| --- | --- | --- | --- |
|  | Î³â€‹u^+(ğ‡+ğ†)âˆ˜(ğˆ+aâ€‹ğ†)âˆ’1â€‹u^+(ğ‡âˆ—+ğ†âˆ—)âˆ˜(ğˆ+aâ€‹ğ†âˆ—)âˆ’1â€‹u^+ğ‡Ï•,Ï±â€‹u^+ğ‡Ï•,Ï±âˆ—â€‹u^=Î±,\gamma\widehat{u}+(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}+a\mathbf{G})^{-1}\widehat{u}+(\mathbf{H}^{\*}+\mathbf{G}^{\*})\circ(\mathbf{I}+a\mathbf{G}^{\*})^{-1}\widehat{u}+\mathbf{H}\_{\phi,\varrho}\widehat{u}+\mathbf{H}\_{\phi,\varrho}^{\*}\widehat{u}=\alpha, |  | (24) |

where ğ‡Ï•,Ï±\mathbf{H}\_{\phi,\varrho} is the integral operator associated to the kernel

|  |  |  |  |
| --- | --- | --- | --- |
|  | HÏ•,Ï±â€‹(t,s):=(Ï•â€‹(Tâˆ’t)+Ï±)â€‹ğŸ™{t>s},s,tâˆˆ[0,T].H\_{\phi,\varrho}(t,s):=\big(\phi(T-t)+\varrho\big)\mathbbm{1}\_{\{t>s\}},\quad s,t\in[0,T]. |  | (25) |

The proof is postponed to AppendixÂ [E](https://arxiv.org/html/2601.03215v1#A5 "Appendix E Proof of Theorem 3.3 â€£ Trading with market resistance and concave price impact").

### 3.3 The general case

We now aim to extend the results of SectionÂ [3.2](https://arxiv.org/html/2601.03215v1#S3.SS2 "3.2 The linear case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact") to the nonlinear case of ğ’°\mathcal{U}, relying only on AssumptionÂ [C](https://arxiv.org/html/2601.03215v1#ThmAssumption3 "Assumption C. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact"). To do this, we first show that ğ’¥\mathcal{J} is FrÃ©chet differentiable (in the sense of DefinitionÂ [B.7](https://arxiv.org/html/2601.03215v1#A2.Thmtheorem7 "Definition B.7. â€£ B.3 FrÃ©chet differentiability â€£ Appendix B Mathematical tools â€£ Trading with market resistance and concave price impact")) and we compute its derivative, which allows to identify a first-order condition to be satisfied by any critical point of ğ’¥\mathcal{J}. The main difficulty in this step lies in the nonlinearity of rur^{u}. We then study the coercivity of ğ’¥\mathcal{J}, which ensures that an extremum must exist.

###### Lemma 3.4.

Suppose that ğ’°\mathcal{U} is differentiable and Lipschitz continuous. Then the operator ğ‘\mathbf{R} is FrÃ©chet differentiable in â„’2\mathcal{L}^{2}. Moreover, for u,hu,h in â„’2\mathcal{L}^{2}, the directional derivative of ğ‘\mathbf{R} at uu in the direction hh is the â„’2\mathcal{L}^{2}-process y=Dâ€‹ğ‘â€‹(u)â€‹(h)y=D\mathbf{R}(u)(h) solution of the Volterra equation

|  |  |  |
| --- | --- | --- |
|  | yt=ğ’°â€²â€‹(ğ†â€‹(uâˆ’ru)t)â€‹ğ†â€‹(hâˆ’y)t,tâˆˆ[0,T].y\_{t}=\mathcal{U}^{\prime}\big(\mathbf{G}(u-r^{u})\_{t}\big)\mathbf{G}(h-y)\_{t},\quad t\in[0,T]. |  |

In other words, we have

|  |  |  |  |
| --- | --- | --- | --- |
|  | Dâ€‹ğ‘â€‹(u)\displaystyle D\mathbf{R}(u) | =(ğˆ+ğ’°â€²â€‹(ğ†â€‹(uâˆ’ğ‘â€‹(u)))â€‹ğ†)âˆ’1â€‹ğ’°â€²â€‹(ğ†â€‹(uâˆ’ğ‘â€‹(u)))â€‹ğ†\displaystyle=\bigg(\mathbf{I}+\mathcal{U}^{\prime}\Big(\mathbf{G}\big(u-\mathbf{R}(u)\big)\Big)\mathbf{G}\bigg)^{-1}\mathcal{U}^{\prime}\Big(\mathbf{G}\big(u-\mathbf{R}(u)\big)\Big)\mathbf{G} |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | =ğˆâˆ’(ğˆ+ğ’°â€²â€‹(ğ†â€‹(uâˆ’ğ‘â€‹(u)))â€‹ğ†)âˆ’1.\displaystyle=\mathbf{I}-\bigg(\mathbf{I}+\mathcal{U}^{\prime}\Big(\mathbf{G}\big(u-\mathbf{R}(u)\big)\Big)\mathbf{G}\bigg)^{-1}. |  |

###### Proof.

See AppendixÂ [D.2](https://arxiv.org/html/2601.03215v1#A4.SS2 "D.2 Proof of Lemma 3.4 â€£ Appendix D Properties of the market resistance ğ‘Ÿ^ğ‘¢ â€£ Trading with market resistance and concave price impact").
âˆ

Therefore LemmaÂ [3.4](https://arxiv.org/html/2601.03215v1#S3.Thmtheorem4 "Lemma 3.4. â€£ 3.3 The general case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact") ensures that ğ’¥\mathcal{J} is also FrÃ©chet differentiable on â„’2\mathcal{L}^{2}. Similar computations toÂ [[4](https://arxiv.org/html/2601.03215v1#bib.bib4), Lemma 4.2] ensure that the GÃ¢teaux derivative of ğ’¥\mathcal{J} is given by

|  |  |  |  |
| --- | --- | --- | --- |
|  | âˆ‡ğ’¥â€‹(u)=\displaystyle\nabla\mathcal{J}(u)= | Î±âˆ’X0(Ï•(Tâˆ’.)+Ï±)âˆ’Î³uâˆ’(ğ‡+ğ†)âˆ˜(ğˆâˆ’ğ‘)(u)\displaystyle\alpha-X\_{0}\big(\phi(T-.)+\varrho\big)-\gamma u-(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}-\mathbf{R})(u) |  |
|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  |  | âˆ’((ğ‡+ğ†)âˆ˜(ğˆâˆ’Dâ€‹ğ‘â€‹(u)))âˆ—â€‹uâˆ’ğ‡Ï•,Ï±â€‹uâˆ’ğ‡Ï•,Ï±âˆ—â€‹u,\displaystyle-\Big(\big(\mathbf{H}+\mathbf{G}\big)\circ\big(\mathbf{I}-D\mathbf{R}(u)\big)\Big)^{\*}u-\mathbf{H}\_{\phi,\varrho}u-\mathbf{H}^{\*}\_{\phi,\varrho}u, |  | (26) |

where ğ‡Ï•,Ï±âˆ—\mathbf{H}^{\*}\_{\phi,\varrho} is defined inÂ ([25](https://arxiv.org/html/2601.03215v1#S3.E25 "In Theorem 3.3. â€£ 3.2 The linear case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")). We then directly get the following result.

###### Theorem 3.5.

Any local extrema uu of ğ’¥\mathcal{J} must satisfy

|  |  |  |
| --- | --- | --- |
|  | Î±âˆ’X0(Ï•(Tâˆ’.)+Ï±)âˆ’Î³uâˆ’(ğ‡+ğ†)âˆ˜(ğˆâˆ’ğ‘)(u)âˆ’((ğ‡+ğ†)âˆ˜(ğˆâˆ’Dğ‘(u)))âˆ—uâˆ’(ğ‡Ï•,Ï±+ğ‡âˆ—Ï•,Ï±)u=0.\alpha-X\_{0}\big(\phi(T-.)+\varrho\big)-\gamma u-(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}-\mathbf{R})(u)-\Big(\big(\mathbf{H}+\mathbf{G}\big)\circ\big(\mathbf{I}-D\mathbf{R}(u)\big)\Big)^{\*}u-(\mathbf{H}\_{\phi,\varrho}+\mathbf{H^{\*}}\_{\phi,\varrho})u=0. |  |

In other words, if uu is a local extrema of ğ’¥\mathcal{J}, then it must satisfy the following nonlinear stochastic Fredholm system equation

|  |  |  |  |
| --- | --- | --- | --- |
|  | {Î³u+(ğ‡+ğ†)u+(ğ‡Ï•,Ï±+ğ‡Ï•,Ï±âˆ—)uâˆ’ğ€(u)=Î±âˆ’X0(Ï•(Tâˆ’.)+Ï±),ru=ğ‘â€‹(u),\begin{cases}\gamma u+(\mathbf{H}+\mathbf{G})u+(\mathbf{H}\_{\phi,\varrho}+\mathbf{H}\_{\phi,\varrho}^{\*})u-\mathbf{A}(u)=\alpha-X\_{0}\big(\phi(T-.)+\varrho\big),\\ r^{u}=\mathbf{R}(u),\end{cases} |  | (27) |

where we introduce the following nonlinear operator ğ€:â„’2â†’â„’2\mathbf{A}:\mathcal{L}^{2}\to\mathcal{L}^{2} such that

|  |  |  |  |
| --- | --- | --- | --- |
|  | ğ€â€‹(u):=(ğ‡+ğ†)âˆ˜ğ‘â€‹(u)âˆ’((ğˆ+(ğŒuâˆ˜ğ†)âˆ—)âˆ’1âˆ˜(ğ‡+ğ†)âˆ—)â€‹u,uâˆˆâ„’2,\mathbf{A}(u):=(\mathbf{H}+\mathbf{G})\circ\mathbf{R}(u)-\Big(\big(\mathbf{I}+(\mathbf{M}^{u}\circ\mathbf{G})^{\*}\big)^{-1}\circ\big(\mathbf{H}+\mathbf{G}\big)^{\*}\Big)u,\quad u\in\mathcal{L}^{2}, |  | (28) |

with ğŒu\mathbf{M}^{u} the multiplication operator defined by

|  |  |  |
| --- | --- | --- |
|  | ğŒuâ€‹vt:=ğ’°â€²â€‹(ğ†â€‹(uâˆ’ğ‘â€‹(u))t)â€‹vt,tâˆˆ[0,T],v,uâˆˆâ„’2.\mathbf{M}^{u}v\_{t}:=\mathcal{U}^{\prime}\Big(\mathbf{G}\big(u-\mathbf{R}(u)\big)\_{t}\Big)v\_{t},\quad t\in[0,T],\quad v,u\in\mathcal{L}^{2}. |  |

We now establish the existence of an optimal control.

###### Theorem 3.6.

Suppose that AssumptionsÂ [A](https://arxiv.org/html/2601.03215v1#ThmAssumption1 "Assumption A. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact"),Â [B](https://arxiv.org/html/2601.03215v1#ThmAssumption2 "Assumption B. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact") andÂ [C](https://arxiv.org/html/2601.03215v1#ThmAssumption3 "Assumption C. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact") hold and suppose in addition that Î©\Omega is countable or finite and that Îºâˆ+Î³>0\kappa\_{\infty}+\gamma>0, then there exists a global maximizer u^âˆˆâ„’2\widehat{u}\in\mathcal{L}^{2} of the functional ğ’¥\mathcal{J}.

## 4 Numerical scheme and application to optimal round-trips

In this section, we introduce an iterative numerical scheme for constructing
Mâˆˆâ„•âˆ—M\in\mathbb{N}^{\*} sample trajectories of a discrete-time approximation of the critical points u^,r^uâˆˆâ„’2\hat{u},\hat{r}^{u}\in\mathcal{L}^{2} satisfying the First-Order Condition (FOC)Â ([27](https://arxiv.org/html/2601.03215v1#S3.E27 "In Theorem 3.5. â€£ 3.3 The general case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")). We establish a theoretical convergence result for this scheme and illustrate its output through an example of optimal round-trip strategies in the presence of stochastic â€œbuyâ€ signals with various decay rates, as well as through a qualitative analysis of the influence of the resistance functionâ€™s convexity on optimal trading. We defer to AppendixÂ [A](https://arxiv.org/html/2601.03215v1#A1 "Appendix A Complement to numerical results â€£ Trading with market resistance and concave price impact") the proof of the convergence result, together with additional illustrations of the qualitative effects of impact decay and permanent impact intensity on the resulting strategies.

In what follows, we fix a uniform time-grid ğ•‹N:={iâ€‹TN,iâˆˆ{0,â€¦,N}}\mathbb{T}\_{N}:=\{\frac{iT}{N},\;i\in\{0,\ldots,N\}\}, with Nâˆˆâ„•âˆ—N\in\mathbb{N}^{\*}, and we use the notation ğ€â€‹(u)=ğ€â€‹(u,ru)\mathbf{A}(u)=\mathbf{A}(u,r^{u}) in order to explicitly refer to the dependence of ğ€\mathbf{A} fromÂ ([28](https://arxiv.org/html/2601.03215v1#S3.E28 "In Theorem 3.5. â€£ 3.3 The general case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")) on both uu and rur^{u}, which will be constructed separately in practice.

### 4.1 Approximation of operators

#### NystrÃ¶m approximation of Volterra integral operators.

Given a deterministic Volterra kernel G:â„â†’â„G:\mathbb{R}\to\mathbb{R}, the integral operator ğ†:â„’2â†’â„’2\mathbf{G}:\mathcal{L}^{2}\to\mathcal{L}^{2} and its dual operator ğ†âˆ—\mathbf{G}^{\*} are numerically approximated on ğ•‹N\mathbb{T}\_{N} by left-rectangles, while integrating the kernels in the same spirit asÂ [[32](https://arxiv.org/html/2601.03215v1#bib.bib32), [1](https://arxiv.org/html/2601.03215v1#bib.bib1), [3](https://arxiv.org/html/2601.03215v1#bib.bib3), [4](https://arxiv.org/html/2601.03215v1#bib.bib4)] such that

|  |  |  |
| --- | --- | --- |
|  | (ğ†â€‹u)tiâ‰ˆâˆ‘j=0iâˆ’1LGâ€‹(i,j)â€‹utj,(ğ†âˆ—â€‹u)tiâ‰ˆâˆ‘j=0iâˆ’1MGâ€‹(i,j)â€‹ğ”¼tiâ€‹utj,tiâˆˆğ•‹N,uâˆˆâ„’2,(\mathbf{G}u)\_{t\_{i}}\approx\sum\_{j=0}^{i-1}L\_{G}(i,j)u\_{t\_{j}},\quad(\mathbf{G}^{\*}u)\_{t\_{i}}\approx\sum\_{j=0}^{i-1}M\_{G}(i,j)\mathbb{E}\_{t\_{i}}u\_{t\_{j}},\quad t\_{i}\in\mathbb{T}\_{N},\quad u\in\mathcal{L}^{2}, |  |

where we define

|  |  |  |
| --- | --- | --- |
|  | LG:=(âˆ«tjtj+1Gâ€‹(ti,s)â€‹dsâ€‹ğŸ™{jâ‰¤i})i,jâˆˆ{0,â€¦,Nâˆ’1},MG:=(âˆ«tjtj+1Gâ€‹(s,ti)â€‹dsâ€‹ğŸ™{jâ‰¥i})i,jâˆˆ{0,â€¦,Nâˆ’1}.L\_{G}:=\bigg(\int\_{t\_{j}}^{t\_{j+1}}G(t\_{i},s)\differential s\mathds{1}\_{\{j\leq i\}}\bigg)\_{i,j\in\{0,\ldots,N-1\}},\quad M\_{G}:=\bigg(\int\_{t\_{j}}^{t\_{j+1}}G(s,t\_{i})\differential s\mathds{1}\_{\{j\geq i\}}\bigg)\_{i,j\in\{0,\ldots,N-1\}}. |  |

#### Numerical approximation of the nonlinear operator ğ€\mathbf{A} fromÂ ([28](https://arxiv.org/html/2601.03215v1#S3.E28 "In Theorem 3.5. â€£ 3.3 The general case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")).

Given uâˆˆâ„’2u\in\mathcal{L}^{2}, let ruâˆˆâ„’2r^{u}\in\mathcal{L}^{2} be the unique solution to the fixed-point equation inÂ ([27](https://arxiv.org/html/2601.03215v1#S3.E27 "In Theorem 3.5. â€£ 3.3 The general case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")). Then, the first term of ğ€â€‹(u)\mathbf{A}(u) inÂ ([28](https://arxiv.org/html/2601.03215v1#S3.E28 "In Theorem 3.5. â€£ 3.3 The general case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")), i.e.,

|  |  |  |
| --- | --- | --- |
|  | (ğ‡+ğ†)â€‹ru(\mathbf{H}+\mathbf{G})r^{u} |  |

is linear in rur^{u} and can be readily approximated via the NystrÃ¶m technique, while it remains to estimate the nonlinear term given by

|  |  |  |  |
| --- | --- | --- | --- |
|  | ((ğˆ+(ğŒuâˆ˜ğ†)âˆ—)âˆ’1âˆ˜(ğ‡+ğ†)âˆ—)â€‹(u).\Big(\big(\mathbf{I}+(\mathbf{M}^{u}\circ\mathbf{G})^{\*}\big)^{-1}\circ(\mathbf{H}+\mathbf{G})^{\*}\Big)(u). |  | (29) |

To achieve this, we set

|  |  |  |  |
| --- | --- | --- | --- |
|  |  | f:=(ğˆ+(ğŒuâˆ˜ğ†)âˆ—)âˆ’1âˆ˜(ğ‡+ğ†)âˆ—â€‹u\displaystyle f:=\big(\mathbf{I}+(\mathbf{M}^{u}\circ\mathbf{G})^{\*}\big)^{-1}\circ(\mathbf{H}+\mathbf{G})^{\*}u |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  | â‡”\displaystyle\iff | f+(ğŒuâˆ˜ğ†)âˆ—â€‹f=(ğ‡+ğ†)âˆ—â€‹u\displaystyle f+(\mathbf{M}^{u}\circ\mathbf{G})^{\*}f=(\mathbf{H}+\mathbf{G})^{\*}u |  |
|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  | â‡”\displaystyle\iff | ft+âˆ«tTGâ€‹(s,t)â€‹ğ”¼tâ€‹[ğ’°â€²â€‹((ğ†â€‹(uâˆ’ru))s)â€‹fs]â€‹ds=âˆ«tT(Hâ€‹(s,t)+Gâ€‹(s,t))â€‹ğ”¼tâ€‹usâ€‹ds,tâˆˆ[0,T]\displaystyle f\_{t}+\int\_{t}^{T}G(s,t)\mathbb{E}\_{t}\Big[\mathcal{U}^{\prime}\Big(\big(\mathbf{G}(u-r^{u})\big)\_{s}\Big)f\_{s}\Big]\differential s=\int\_{t}^{T}\big(H(s,t)+G(s,t)\big)\mathbb{E}\_{t}u\_{s}\differential s,\quad t\in[0,T] |  | (30) |

where the explicit expressions of the dual operators are obtained by stochastic Fubini and the tower property, and are well defined since ğŒuâˆ˜ğ†\mathbf{M}^{u}\circ\mathbf{G} and (ğ‡+ğ†)(\mathbf{H}+\mathbf{G}) are both linear and bounded (since ğ’°â€²\mathcal{U}^{\prime} is bounded), see [[19](https://arxiv.org/html/2601.03215v1#bib.bib19), Chapter 6, Section 2]. Given uâˆˆâ„’2u\in\mathcal{L}^{2} and observing that fT=0f\_{T}=0, we can solveÂ ([30](https://arxiv.org/html/2601.03215v1#S4.E30 "In Numerical approximation of the nonlinear operator ğ€ from (28). â€£ 4.1 Approximation of operators â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")) by a backward iterative scheme on the subdivision ğ•‹N\mathbb{T}\_{N} as follows:

* â€¢

  ftN=0f\_{t\_{N}}=0,
* â€¢

  for pâˆˆ{Nâˆ’1,â‹¯,0}p\in\{N-1,\cdots,0\}, since ftpf\_{t\_{p}} and utpu\_{t\_{p}} are â„±tp\mathcal{F}\_{t\_{p}}-measurable, then a left-rectangle approximation of the integrals inÂ ([30](https://arxiv.org/html/2601.03215v1#S4.E30 "In Numerical approximation of the nonlinear operator ğ€ from (28). â€£ 4.1 Approximation of operators â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")) yields

  |  |  |  |  |
  | --- | --- | --- | --- |
  |  | ftp=(1+MGâ€‹(p,p)â€‹wtpu)âˆ’1\displaystyle f\_{t\_{p}}=\big(1+M\_{G}(p,p)w\_{t\_{p}}^{u}\big)^{-1} | (MG+H(p,p)utp+âˆ‘k=p+1Nâˆ’1MG+H(p,k)ğ”¼tputk.\displaystyle\bigg(M\_{G+H}(p,p)u\_{t\_{p}}+\sum\_{k=p+1}^{N-1}M\_{G+H}(p,k)\mathbb{E}\_{t\_{p}}u\_{t\_{k}}. |  |
  |  |  |  |  |  |
  | --- | --- | --- | --- | --- |
  |  |  | .âˆ’âˆ‘k=p+1Nâˆ’1MG(p,k)ğ”¼tp[wtkuftk]),\displaystyle\quad.-\sum\_{k=p+1}^{N-1}M\_{G}(p,k)\mathbb{E}\_{t\_{p}}[w\_{t\_{k}}^{u}f\_{t\_{k}}]\bigg), |  | (31) |

  where we defined

  |  |  |  |
  | --- | --- | --- |
  |  | wu:=ğ’°â€²â€‹(ğ†â€‹(uâˆ’ru)),w^{u}:=\mathcal{U}^{\prime}\big(\mathbf{G}(u-r^{u})\big), |  |

  and the conditional expectations (ğ”¼tpâ€‹[wtkuâ€‹ftk])Nâˆ’1â‰¥k>pâ‰¥0,(ğ”¼tpâ€‹utk)Nâˆ’1â‰¥k>pâ‰¥0(\mathbb{E}\_{t\_{p}}[w\_{t\_{k}}^{u}f\_{t\_{k}}])\_{N-1\geq k>p\geq 0},\;(\mathbb{E}\_{t\_{p}}u\_{t\_{k}})\_{N-1\geq k>p\geq 0} can be estimated by least-squares Monte Carlo similarly as inÂ [[3](https://arxiv.org/html/2601.03215v1#bib.bib3), Section 3.3] orÂ [[4](https://arxiv.org/html/2601.03215v1#bib.bib4), Section 3.1].

###### Remark 3 (Sanity check of the approximation of ğ€\mathbf{A}).

The supremum L2L^{2} error Ebâ€‹fE^{bf} associated to the backward Fredholm equationÂ ([30](https://arxiv.org/html/2601.03215v1#S4.E30 "In Numerical approximation of the nonlinear operator ğ€ from (28). â€£ 4.1 Approximation of operators â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")) is given by

|  |  |  |
| --- | --- | --- |
|  | Ebâ€‹f(f):=supÏ‰âˆˆÎ©(âˆ«0T|ft+((ğŒuâˆ˜ğ†)âˆ—f)tâˆ’((ğ‡+ğ†)âˆ—u)t|2dt])(Ï‰),E^{bf}(f):=\sup\_{\omega\in\Omega}\bigg(\int\_{0}^{T}\big|f\_{t}+\big((\mathbf{M}^{u}\circ\mathbf{G})^{\*}f\big)\_{t}-\big((\mathbf{H}+\mathbf{G})^{\*}u\big)\_{t}\big|^{2}\differential t\bigg]\bigg)(\omega), |  |

can be estimated numerically on a uniform time grid with step Î”\Delta as

|  |  |  |  |
| --- | --- | --- | --- |
|  | EN,Mbâ€‹fâ€‹(f):=supmâˆˆ{1,â€¦,M}EN,Mbâ€‹fâ€‹(f)â€‹(Ï‰m)E\_{N,M}^{bf}(f):=\sup\_{m\in\{1,\ldots,M\}}E\_{N,M}^{bf}(f)(\omega\_{m}) |  | (32) |

where

|  |  |  |  |
| --- | --- | --- | --- |
|  | EN,Mbâ€‹fâ€‹(f)â€‹(Ï‰m)\displaystyle E\_{N,M}^{bf}(f)(\omega\_{m}) | :=Î”â€‹âˆ‘p=0Nâˆ’1|ftpâ€‹(Ï‰m)+MGâ€‹(p,p)â€‹wtpuâ€‹(Ï‰m)â€‹ftpâ€‹(Ï‰m)\displaystyle:=\Delta\sum\_{p=0}^{N-1}\bigg|f\_{t\_{p}}(\omega\_{m})+M\_{G}(p,p)w\_{t\_{p}}^{u}(\omega\_{m})f\_{t\_{p}}(\omega\_{m}) |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | +âˆ‘k=p+1Nâˆ’1MGâ€‹(p,k)â€‹ğ”¼tpâ€‹[wtkuâ€‹ftk]â€‹(Ï‰m)âˆ’MG+Hâ€‹(p,p)â€‹utpâ€‹(Ï‰m)\displaystyle+\sum\_{k=p+1}^{N-1}M\_{G}(p,k)\mathbb{E}\_{t\_{p}}[w\_{t\_{k}}^{u}f\_{t\_{k}}](\omega\_{m})-M\_{G+H}(p,p)u\_{t\_{p}}(\omega\_{m}) |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | âˆ’âˆ‘k=p+1Nâˆ’1MG+H(p,k)ğ”¼tputk(Ï‰m)|2.\displaystyle-\sum\_{k=p+1}^{N-1}M\_{G+H}(p,k)\mathbb{E}\_{t\_{p}}u\_{t\_{k}}(\omega\_{m})\bigg|^{2}. |  |

In practice EN,Mbâ€‹fâ€‹(f)E\_{N,M}^{bf}(f) fromÂ ([32](https://arxiv.org/html/2601.03215v1#S4.E32 "In Remark 3 (Sanity check of the approximation of ğ€). â€£ Numerical approximation of the nonlinear operator ğ€ from (28). â€£ 4.1 Approximation of operators â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")) is way below machine precision, see the right plot in FigureÂ [5](https://arxiv.org/html/2601.03215v1#S4.F5 "Figure 5 â€£ Optimal round-trips with the QMR model for various signal decays. â€£ 4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact").

### 4.2 Iterative numerical scheme

#### Criterion of convergence.

For any given u,ruâˆˆâ„’2u,r^{u}\in\mathcal{L}^{2}, we define the joint supremum L2L^{2} errors of the FOCÂ ([27](https://arxiv.org/html/2601.03215v1#S3.E27 "In Theorem 3.5. â€£ 3.3 The general case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")) by

|  |  |  |  |
| --- | --- | --- | --- |
|  | E1â€‹(u,ru)\displaystyle E^{1}(u,r^{u}) | :=supÏ‰âˆˆÎ©(âˆ«0T|Î³ut+((ğ‡+ğ†+ğ‡Ï•,Ï±+ğ‡Ï•,Ï±âˆ—)u)tâˆ’(ğ€(u,ru))t\displaystyle:=\sup\_{\omega\in\Omega}\bigg(\int\_{0}^{T}\Big|\gamma u\_{t}+\big((\mathbf{H}+\mathbf{G}+\mathbf{H}\_{\phi,\varrho}+\mathbf{H}\_{\phi,\varrho}^{\*})u\big)\_{t}-\big(\mathbf{A}(u,r^{u})\big)\_{t} |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | âˆ’(Î±tâˆ’X0(Ï•(Tâˆ’t)+Ï±))|2dt)(Ï‰),\displaystyle\qquad-\Big(\alpha\_{t}-X\_{0}\big(\phi(T-t)+\varrho\big)\Big)\Big|^{2}\differential t\bigg)(\omega), |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  | E2â€‹(u,ru)\displaystyle E^{2}(u,r^{u}) | :=supÏ‰âˆˆÎ©(âˆ«0T|rtuâˆ’ğ’°â€‹((ğ†â€‹(uâˆ’ru))t)|2â€‹dt)â€‹(Ï‰),\displaystyle:=\sup\_{\omega\in\Omega}\bigg(\int\_{0}^{T}\Big|r\_{t}^{u}-\mathcal{U}\Big(\big(\mathbf{G}(u-r^{u})\big)\_{t}\Big)\Big|^{2}\differential t\bigg)(\omega), |  |

which, over a NN-steps time grid and MM sample trajectories, are approximated numerically by

|  |  |  |  |
| --- | --- | --- | --- |
|  | EN,M1â€‹(uN,rN):=supmâˆˆ{1,â€¦,M}EN,M1â€‹(uN,rN)â€‹(Ï‰m),E\_{N,M}^{1}(u^{N},r^{N}):=\sup\_{m\in\{1,\ldots,M\}}E\_{N,M}^{1}(u^{N},r^{N})(\omega\_{m}), |  | (33) |

where

|  |  |  |  |
| --- | --- | --- | --- |
|  | EN,M1â€‹(uN,rN)â€‹(Ï‰m):=\displaystyle E\_{N,M}^{1}(u^{N},r^{N})(\omega\_{m}):= | Î”â€‹âˆ‘i=0Nâˆ’1|Î³â€‹utiNâ€‹(Ï‰m)+âˆ‘j=0iâˆ’1LG+H+HÏ•,Ï±â€‹(i,j)â€‹utjNâ€‹(Ï‰m)+MHÏ•,Ï±â€‹(i,i)â€‹utiN\displaystyle\Delta\sum\_{i=0}^{N-1}\bigg|\gamma u\_{t\_{i}}^{N}(\omega\_{m})+\sum\_{j=0}^{i-1}L\_{G+H+H\_{\phi,\varrho}}(i,j)u\_{t\_{j}}^{N}(\omega\_{m})+M\_{H\_{\phi,\varrho}}(i,i)u\_{t\_{i}}^{N} |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | +âˆ‘j=i+1Nâˆ’1MHÏ•,Ï±â€‹(i,j)â€‹ğ”¼tiâ€‹utjNâ€‹(Ï‰m)âˆ’âˆ‘j=0iâˆ’1LG+Hâ€‹(i,j)â€‹rtjNâ€‹(Ï‰m)+ftiNâ€‹(Ï‰m)\displaystyle\qquad\quad+\sum\_{j=i+1}^{N-1}M\_{H\_{\phi,\varrho}}(i,j)\mathbb{E}\_{t\_{i}}u\_{t\_{j}}^{N}(\omega\_{m})-\sum\_{j=0}^{i-1}L\_{G+H}(i,j)r\_{t\_{j}}^{N}(\omega\_{m})+f\_{t\_{i}}^{N}(\omega\_{m}) |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | âˆ’Î±ti(Ï‰m)+X0(Ï•(Tâˆ’ti)+Ï±)|2,\displaystyle\qquad\quad-\alpha\_{t\_{i}}(\omega\_{m})+X\_{0}(\phi(T-t\_{i})+\varrho)\bigg|^{2}, |  |

with ftiNf\_{t\_{i}}^{N} is given byÂ ([31](https://arxiv.org/html/2601.03215v1#S4.E31 "In 2nd item â€£ Numerical approximation of the nonlinear operator ğ€ from (28). â€£ 4.1 Approximation of operators â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")), and

|  |  |  |  |
| --- | --- | --- | --- |
|  | EN,M2â€‹(uN,rN):=supmâˆˆ{1,â€¦,M}EN,M2â€‹(uN,rN)â€‹(Ï‰m),E\_{N,M}^{2}(u^{N},r^{N}):=\sup\_{m\in\{1,\ldots,M\}}E\_{N,M}^{2}(u^{N},r^{N})(\omega\_{m}), |  | (34) |

where

|  |  |  |
| --- | --- | --- |
|  | EN,M2â€‹(uN,rN)â€‹(Ï‰m):=Î”â€‹âˆ‘i=0Nâˆ’1|rtiNâ€‹(Ï‰m)âˆ’ğ’°â€‹(âˆ‘j=0iâˆ’1LGâ€‹(i,j)â€‹(utjNâ€‹(Ï‰m)âˆ’rtjNâ€‹(Ï‰m)))|2.E\_{N,M}^{2}(u^{N},r^{N})(\omega\_{m}):=\Delta\sum\_{i=0}^{N-1}\bigg|r\_{t\_{i}}^{N}(\omega\_{m})-\mathcal{U}\bigg(\sum\_{j=0}^{i-1}L\_{G}(i,j)\big(u\_{t\_{j}}^{N}(\omega\_{m})-r\_{t\_{j}}^{N}(\omega\_{m})\big)\bigg)\bigg|^{2}. |  |

In what follows, we drop the upper-script NN from uN,rNu^{N},r^{N} for ease of reading. We then aim to construct a sequence of such discrete-time approximation of (u,ru)(u,r^{u}) which we denote by (u[n],r[n])nâ‰¥0=(u[n]â€‹(N,M),r[n]â€‹(N,M))nâ‰¥0(u^{[n]},\;r^{[n]})\_{n\geq 0}=(u^{[n]}(N,M),\;r^{[n]}(N,M))\_{n\geq 0} such that

|  |  |  |
| --- | --- | --- |
|  | EN,M1,2â€‹(u[n]â€‹(N,M),r[n]â€‹(N,M))â€‹âŸ¶nâ†’âˆâ€‹0.E\_{N,M}^{1,2}\big(u^{[n]}(N,M),\;r^{[n]}(N,M)\big)\underset{n\to\infty}{\longrightarrow}0. |  |

#### Scheme definition.

Fix Ïµ>0\epsilon>0.

* â€¢

  Initialize (u[0],r[0])â‰¡0(u^{[0]},r^{[0]})\equiv 0.
* â€¢

  While EN,M1â€‹(u[n],r[n])>ÏµE\_{N,M}^{1}(u^{[n]},r^{[n]})>\epsilon, do:

  + â€“

    Update u[n]u^{[n]} by solvingÂ ([27](https://arxiv.org/html/2601.03215v1#S3.E27 "In Theorem 3.5. â€£ 3.3 The general case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")) while computing the nonlinear operator ğ€\mathbf{A} using u[nâˆ’1],r[nâˆ’1]u^{[n-1]},\;r^{[n-1]}:

    |  |  |  |  |
    | --- | --- | --- | --- |
    |  | Î³â€‹u[n]+(ğ‡+ğ†+ğ‡Ï•,Ï±+ğ‡Ï•,Ï±âˆ—)â€‹u[n]=Î±âˆ’X0â€‹(Ï•â€‹(Tâˆ’ti)+Ï±)+ğ€â€‹(u[nâˆ’1],r[nâˆ’1]),\gamma u^{[n]}+(\mathbf{H}+\mathbf{G}+\mathbf{H\_{\phi,\varrho}}+\mathbf{H\_{\phi,\varrho}^{\*}})u^{[n]}=\alpha-X\_{0}\big(\phi(T-t\_{i})+\varrho\big)+\mathbf{A}(u^{[n-1]},r^{[n-1]}), |  | (35) |

    which can be numerically solved as detailed inÂ [[3](https://arxiv.org/html/2601.03215v1#bib.bib3), Section 3.2].
  + â€“

    Update the market resistance r[n]=r[n,âˆ]r^{[n]}=r^{[n,\infty]} as the limit of the sequence (r[n,p])pâ‰¥0(r^{[n,p]})\_{p\geq 0} solving the fixed-point equation fromÂ ([27](https://arxiv.org/html/2601.03215v1#S3.E27 "In Theorem 3.5. â€£ 3.3 The general case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")) via Picard iterations over pâ‰¥0p\geq 0 until EN,M2â€‹(u[n],r[n,p])E\_{N,M}^{2}(u^{[n]},r^{[n,p]}) is smaller than Ïµ\epsilon:

    |  |  |  |  |
    | --- | --- | --- | --- |
    |  | {r[n,p+1]=ğ’°â€‹(ğ†â€‹(u[n]âˆ’r[n,p])),r[n,0]:=r[nâˆ’1,0].\begin{cases}r^{[n,p+1]}=\mathcal{U}\big(\mathbf{G}(u^{[n]}-r^{[n,p]})\big),\\ r^{[n,0]}:=r^{[n-1,0]}.\end{cases} |  | (36) |
  + â€“

    Increment nn to n+1n+1.

#### Theoretical convergence of the iterative scheme.

In the following, we state a result on the theoretical rate of convergence of the iterative scheme if TT is sufficiently small or, equivalently, if Î³\gamma is sufficiently large, in the same spirit asÂ [[4](https://arxiv.org/html/2601.03215v1#bib.bib4), Proposition 2.14].

###### Theorem 4.1 (Exponential convergence of the iterative scheme).

Assume the resistance function ğ’°\mathcal{U} is Lipchitz-continuous with constant L>0L>0, with bounded derivative ğ’°â€²<C\mathcal{U}^{\prime}<C, for some positive constant CC. Fix two admissible kernels H,GH,G, as well as the trading horizon T>0T>0 and the slippage costs parameter Î³>0\gamma>0 such that

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  | 1\displaystyle 1 | >Tâ€‹CGâ€‹maxâ¡(L,C),\displaystyle>\sqrt{TC\_{G}}\max(L,C), |  | (37) |
|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  | Î³\displaystyle\gamma | >C~:=Tâ€‹CH+Gâ€‹(Lâ€‹Tâ€‹CG1âˆ’Lâ€‹Tâ€‹CG+11âˆ’Câ€‹Tâ€‹CG),\displaystyle>\tilde{C}:=\sqrt{TC\_{H+G}}\bigg(L\frac{\sqrt{TC\_{G}}}{1-L\sqrt{TC\_{G}}}+\frac{1}{1-C\sqrt{TC\_{G}}}\bigg), |  | (38) |

where CH+GC\_{H+G} and CGC\_{G} are respectively the constants associated to the kernels H+GH+G and GG defined byÂ ([15](https://arxiv.org/html/2601.03215v1#S3.E15 "In Definition 3.1. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")). Assume the existence of (u^,r^)(\hat{u},\hat{r}) satisfying the first-order-conditionÂ ([27](https://arxiv.org/html/2601.03215v1#S3.E27 "In Theorem 3.5. â€£ 3.3 The general case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")), and denote by (u[n],r[n])nâ‰¥0(u^{[n]},r^{[n]})\_{n\geq 0} the sequence of controls obtained by the iterative schemeÂ ([35](https://arxiv.org/html/2601.03215v1#S4.E35 "In 1st item â€£ 2nd item â€£ Scheme definition. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact"))â€“([36](https://arxiv.org/html/2601.03215v1#S4.E36 "In 2nd item â€£ 2nd item â€£ Scheme definition. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")), then

|  |  |  |
| --- | --- | --- |
|  | limnâ†’âˆu[n]=u^inÂ â„’2,\lim\_{n\to\infty}u^{[n]}=\hat{u}\quad\text{in $\mathcal{L}^{2}$,} |  |

and the convergence rate is bounded by

|  |  |  |  |
| --- | --- | --- | --- |
|  | â€–u[n]âˆ’u^â€–â‰¤(C~Î³)nâ€‹â€–u^â€–,nâˆˆâ„•.\norm{u^{[n]}-\hat{u}}\leq\bigg(\frac{\widetilde{C}}{\gamma}\bigg)^{n}\norm{\hat{u}},\quad n\in\mathbb{N}. |  | (39) |

As a consequence, (u^,r^)(\hat{u},\hat{r}) is the unique solution to the FOCÂ ([27](https://arxiv.org/html/2601.03215v1#S3.E27 "In Theorem 3.5. â€£ 3.3 The general case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")).

###### Proof.

See AppendixÂ [A.1](https://arxiv.org/html/2601.03215v1#A1.SS1 "A.1 Proof of Theorem 4.1 â€£ Appendix A Complement to numerical results â€£ Trading with market resistance and concave price impact").
âˆ

###### Remark 4 (Stochastic gradient descent).

Starting from u[0]=0u^{[0]}=0, consider a stochastic gradient iterative scheme of the form

|  |  |  |
| --- | --- | --- |
|  | u[n]=u[nâˆ’1]+Î·nâ€‹âˆ‡ğ’¥â€‹(u[nâˆ’1]),nâ‰¥1,u^{[n]}=u^{[n-1]}+\eta\_{n}\nabla\mathcal{J}(u^{[n-1]}),\quad n\geq 1, |  |

where (Î·n)\left(\eta\_{n}\right) is a sequence of learning steps and âˆ‡ğ’¥\nabla\mathcal{J} is given byÂ ([26](https://arxiv.org/html/2601.03215v1#S3.E26 "In 3.3 The general case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")). Although appearing to be a promising candidate to construct critical points satisfying the first order optimality conditionÂ ([27](https://arxiv.org/html/2601.03215v1#S3.E27 "In Theorem 3.5. â€£ 3.3 The general case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")) without having to invert any Fredholm equation, we observed in practice that such scheme converges slower than the iterative schemeÂ ([35](https://arxiv.org/html/2601.03215v1#S4.E35 "In 1st item â€£ 2nd item â€£ Scheme definition. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact"))â€“([36](https://arxiv.org/html/2601.03215v1#S4.E36 "In 2nd item â€£ 2nd item â€£ Scheme definition. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")) and does not converge at all in the regime Î³â†’0\gamma\to 0.

### 4.3 Optimal round-trips in presence of â€œbuyâ€ signals

#### Impact model specification.

Given fixed constants Î´>0\delta>0 and câ‰¥1c\geq 1, we introduce the resistance function ğ’°Î´,c:â„â†’â„\mathcal{U}\_{\delta,c}:\mathbb{R}\to\mathbb{R} as

|  |  |  |  |
| --- | --- | --- | --- |
|  | ğ’°Î´,câ€‹(x):=sâ€‹iâ€‹gâ€‹nâ€‹(x)â€‹|x|câ€‹ğŸ™{|x|â‰¤Î´}+(câ€‹Î´câˆ’1â€‹xâˆ’sâ€‹iâ€‹gâ€‹nâ€‹(x)â€‹Î´câ€‹(câˆ’1))â€‹ğŸ™{|x|>Î´},xâˆˆâ„,\mathcal{U}\_{\delta,c}(x):=sign(x)|x|^{c}\mathds{1}\_{\{|x|\leq\delta\}}+\big(c\delta^{c-1}x-sign(x)\delta^{c}(c-1)\big)\mathds{1}\_{\{|x|>\delta\}},\quad x\in\mathbb{R}, |  | (40) |

and its derivative is

|  |  |  |  |
| --- | --- | --- | --- |
|  | ğ’°Î´,câ€²â€‹(x):=câ€‹|x|câˆ’1â€‹ğŸ™{|x|â‰¤Î´}+câ€‹Î´câˆ’1â€‹ğŸ™{|x|>Î´},xâˆˆâ„.\mathcal{U}\_{\delta,c}^{\prime}(x):=c|x|^{c-1}\mathds{1}\_{\{|x|\leq\delta\}}+c\delta^{c-1}\mathds{1}\_{\{|x|>\delta\}},\quad x\in\mathbb{R}. |  | (41) |

The parameter câ‰¥1c\geq 1 governs the degree of convexity, encompassing in particular the linear (c=1c=1) and quadratic (c=2c=2) resistance functions. We also note that, for c=2c=2, the specificationÂ ([40](https://arxiv.org/html/2601.03215v1#S4.E40 "In Impact model specification. â€£ 4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")) coincides with a modified Huber lossÂ [[27](https://arxiv.org/html/2601.03215v1#bib.bib27)], in which the sign is flipped for negative arguments so that market impact indeed moves the unaffected price unfavorably when executing large sell orders. A finite value for Î´<âˆ\delta<\infty yields an asymptotic linear growth of the resistance function as in AssumptionÂ [C](https://arxiv.org/html/2601.03215v1#ThmAssumption3 "Assumption C. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact"), and guarantees LemmaÂ [3.4](https://arxiv.org/html/2601.03215v1#S3.Thmtheorem4 "Lemma 3.4. â€£ 3.3 The general case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact") and TheoremÂ [4.1](https://arxiv.org/html/2601.03215v1#S4.Thmtheorem1 "Theorem 4.1 (Exponential convergence of the iterative scheme). â€£ Theoretical convergence of the iterative scheme. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact") are applicable. Although Î´\delta might be a desirable tunable regularizing model parameter, we do not need to explicitly specify it in practice when considering a finite number of bounded sample signal trajectories (as in the following numerical examples), and therefore Î´\delta may remain implicit such that only the convex term sign(â‹…)|â‹…|cğŸ™{|â‹…|â‰¤Î´}sign(\cdot)|\cdot|^{c}\mathds{1}\_{\{|\cdot|\leq\delta\}} inÂ ([40](https://arxiv.org/html/2601.03215v1#S4.E40 "In Impact model specification. â€£ 4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")) is effective.

![Refer to caption](x4.png)


Figure 3: Resistance function specificationÂ ([40](https://arxiv.org/html/2601.03215v1#S4.E40 "In Impact model specification. â€£ 4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")) and its derivativeÂ ([41](https://arxiv.org/html/2601.03215v1#S4.E41 "In Impact model specification. â€£ 4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")) for various values of cc, while fixing Î´=1.2\delta=1.2.

Unless stated otherwise, the parameters of the resistance function are set as follows:

* â€¢

  c=2c=2 for the convexity of the resistance function; this corresponds to what we refer to as the Quadratic Market Resistance (QMR) model, asymptotically consistent with the square-root law in participation rate as shown inÂ [[20](https://arxiv.org/html/2601.03215v1#bib.bib20), Theorem 9];
* â€¢

  Î´<âˆ\delta<\infty is left implicit, since we consider bounded sample signal trajectories.

As motivated in SectionÂ [2](https://arxiv.org/html/2601.03215v1#S2 "2 Inception: a sophisticated trader as a market resistance â€£ Trading with market resistance and concave price impact"), we specify a power-law decay kernel GÎ»,Î½G\_{\lambda,\nu} to capture the transient nature of market impact. Therefore, unless stated otherwise, the parameters of the price impact model inÂ ([13](https://arxiv.org/html/2601.03215v1#S3.E13 "In 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")) are set as follows:

* â€¢

  Î³=0.2\gamma=0.2 for the intensity of slippage costs;
* â€¢

  Î»=0.467\lambda=0.467 and Î½=0.614\nu=0.614 for the transient impact decay (borrowed fromÂ [[4](https://arxiv.org/html/2601.03215v1#bib.bib4)], FigureÂ 7);
* â€¢

  Îºâˆ=1\kappa\_{\infty}=1 for the permanent impact intensity.

#### Soft constraints specification.

The trader has the possibility to penalize his running inventory as well as the final inventory level via the hyper-parameters Ï•\phi and Ï±\varrho respectively introduced inÂ ([19](https://arxiv.org/html/2601.03215v1#S3.E19 "In 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")). Unless stated otherwise, we set:

* â€¢

  Ï•=0\phi=0, i.e., no penalty on the running inventory, since it is obvious that an increasing value of Ï•\phi shrinks the optimal inventory toward 0;
* â€¢

  Ï±=5â€‹eâ€‹2â‰«1\varrho=5e2\gg 1 to enforce a zero final inventory.

#### Signals and least-squares Monte Carlo specification.

We specify an Ornstein-Uhlenbeck (OU) drift-like price signal Î¼\mu and set P:=âˆ«Î¼tâ€‹dtP:=\int\mu\_{t}\differential t where PP is given in the unaffected price processÂ ([9](https://arxiv.org/html/2601.03215v1#S3.E9 "In 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")). We have

|  |  |  |  |
| --- | --- | --- | --- |
|  | dÎ¼t=(Î·âˆ’Îºâ€‹Î¼t)â€‹dt+Ïƒâ€‹dWt,Î¼0âˆˆâ„.\differential\mu\_{t}=(\eta-\kappa\mu\_{t})\differential t+\sigma\differential W\_{t},\quad\mu\_{0}\in\mathbb{R}. |  | (42) |

The alpha-signal Î±\alpha fromÂ ([22](https://arxiv.org/html/2601.03215v1#S3.E22 "In 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")) is then explicitly given by

|  |  |  |  |
| --- | --- | --- | --- |
|  | Î±t:=ğ”¼tâ€‹[âˆ«tTÎ¼râ€‹dr]=(Î¼tâˆ’Î·Îº)â€‹1âˆ’eâˆ’Îºâ€‹(Tâˆ’t)Îº+Î·Îºâ€‹(Tâˆ’t),tâˆˆ[0,T].\alpha\_{t}:=\mathbb{E}\_{t}\bigg[\int\_{t}^{T}\mu\_{r}\differential r\bigg]=\bigg(\mu\_{t}-\frac{\eta}{\kappa}\bigg)\frac{1-e^{-\kappa(T-t)}}{\kappa}+\frac{\eta}{\kappa}(T-t),\quad t\in[0,T]. |  | (43) |

Unless stated otherwise, we set:

* â€¢

  Î·=10\eta=10, for the long-term mean;
* â€¢

  Îº=1\kappa=1 for the mean-reversion rate;
* â€¢

  Either Ïƒ=1\sigma=1 or Ïƒ=0\sigma=0 for the signal noise level, see RemarkÂ [5](https://arxiv.org/html/2601.03215v1#Thmrem5 "Remark 5. â€£ Signals and least-squares Monte Carlo specification. â€£ 4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact");
* â€¢

  Î¼0=1\mu\_{0}=1 for the initial state value of the OU drift-signal.

In the case of stochastic OU drift-signals, i.e., Ïƒ=1\sigma=1, we need to apply a least-squares Monte Carlo to approximate the nonlinear stochastic operatorÂ ([29](https://arxiv.org/html/2601.03215v1#S4.E29 "In Numerical approximation of the nonlinear operator ğ€ from (28). â€£ 4.1 Approximation of operators â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")) viaÂ ([31](https://arxiv.org/html/2601.03215v1#S4.E31 "In 2nd item â€£ Numerical approximation of the nonlinear operator ğ€ from (28). â€£ 4.1 Approximation of operators â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")) as explained in SectionÂ [4.1](https://arxiv.org/html/2601.03215v1#S4.SS1 "4.1 Approximation of operators â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact"). In what follows, we apply Ridge regressions on 20002000 signal sample trajectories with penalty 1â€‹eâˆ’51e-5 to a basis expansion of all Laguerre polynomials up to degree two of the following family of features

|  |  |  |
| --- | --- | --- |
|  | (Î±,âˆ«0â‹…Î±sâ€‹ds,âˆ«0â‹…eâˆ’Îºâ£(â‹…âˆ’s)â€‹Î±sâ€‹ds),\bigg(\alpha,\int\_{0}^{\cdot}\alpha\_{s}\differential s,\int\_{0}^{\cdot}e^{-\kappa(\cdot-s)}\alpha\_{s}\differential s\bigg), |  |

and refer the interested reader toÂ [[3](https://arxiv.org/html/2601.03215v1#bib.bib3), Section 3.3] andÂ [[4](https://arxiv.org/html/2601.03215v1#bib.bib4), Section 3.1 and Appendix A] for more details. Finally, the number of time steps is set to N=100N=100.

###### Remark 5.

Setting the signal volatility to zero yields a deterministic optimal trading problem, leading to the same qualitative conclusions as those obtained from the sample means of the optimal quantities, while improving visual clarity in practice and avoiding the error propagation inherent to the least-squares Monte Carlo estimation procedure.

#### Optimal round-trips with the QMR model for various signal decays.

We specify three stochastic nonnegative â€œbuyâ€ signals of the formÂ ([43](https://arxiv.org/html/2601.03215v1#S4.E43 "In Signals and least-squares Monte Carlo specification. â€£ 4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")) and vary the signalâ€™s mean-reversion Îºâˆˆ{0.1,1,10}\kappa\in\{0.1,1,10\} fromÂ ([42](https://arxiv.org/html/2601.03215v1#S4.E42 "In Signals and least-squares Monte Carlo specification. â€£ 4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")), as illustrated in the top-left plot in FigureÂ [4](https://arxiv.org/html/2601.03215v1#S4.F4 "Figure 4 â€£ Optimal round-trips with the QMR model for various signal decays. â€£ 4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact").

On the one hand, FigureÂ [4](https://arxiv.org/html/2601.03215v1#S4.F4 "Figure 4 â€£ Optimal round-trips with the QMR model for various signal decays. â€£ 4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact") displays the sample averages and the associated 95%95\% normal confidence intervals of the main optimal quantities of interest associated to the optimal round-trip strategies: optimal trading rates, inventories and resistance rates, as well as the resulting price distortions and running trading costs. We also display 55 sample trajectories out of the 20002000 ones used for the least-squares Monte Carlo. The slower the signal decay, the more aggressive the trading strategy becomes, and the greater the resulting market resistance, price distortion, and running trading costs. Also, note that the resulting trading strategies do not feature any model round-trip model arbitrage as all the sample running trading costs trajectories remain non-negative throughout the trading horizon.

On the other hand, FigureÂ [5](https://arxiv.org/html/2601.03215v1#S4.F5 "Figure 5 â€£ Optimal round-trips with the QMR model for various signal decays. â€£ 4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact") illustrates the exponential convergence of the iterative scheme through iterations: the faster the signal decays, the faster the scheme converges. Note that the convergence rate depends on all the impact modelâ€™s parameters as suggested by inequalityÂ ([38](https://arxiv.org/html/2601.03215v1#S4.E38 "In Theorem 4.1 (Exponential convergence of the iterative scheme). â€£ Theoretical convergence of the iterative scheme. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")) from TheoremÂ [4.1](https://arxiv.org/html/2601.03215v1#S4.Thmtheorem1 "Theorem 4.1 (Exponential convergence of the iterative scheme). â€£ Theoretical convergence of the iterative scheme. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact"). In particular, we observe that the smaller Î³\gamma, the slower the convergence â€“ until numerical instability appears â€“ which is consistent with the regularizing effect of slippage costs already described inÂ [[4](https://arxiv.org/html/2601.03215v1#bib.bib4), Section 3.5].

![Refer to caption](x5.png)


Figure 4: Optimal round-trips for three stochastic â€œbuyâ€ signals with different signal decays Îº\kappa fromÂ ([42](https://arxiv.org/html/2601.03215v1#S4.E42 "In Signals and least-squares Monte Carlo specification. â€£ 4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")). For each quantity, the shaded regions represent their normal 95%95\% confidence intervals estimated from the optimal 20002000 sample trajectories, the empty dot markers denote the corresponding sample means, and we also display 55 sample trajectories.

![Refer to caption](x6.png)


Figure 5: Convergence of the numerical schemeÂ ([35](https://arxiv.org/html/2601.03215v1#S4.E35 "In 1st item â€£ 2nd item â€£ Scheme definition. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact"))â€“([36](https://arxiv.org/html/2601.03215v1#S4.E36 "In 2nd item â€£ 2nd item â€£ Scheme definition. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")) for three stochastic â€œbuyâ€ signals with different signal decays Îº\kappa fromÂ ([42](https://arxiv.org/html/2601.03215v1#S4.E42 "In Signals and least-squares Monte Carlo specification. â€£ 4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")): the left-hand plot displays the error EN,M1E\_{N,M}^{1} of the FOC defined inÂ ([33](https://arxiv.org/html/2601.03215v1#S4.E33 "In Criterion of convergence. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")) while the right-hand plot shows the numerical error EN,Mbâ€‹fE\_{N,M}^{bf} of the backward schemeÂ ([31](https://arxiv.org/html/2601.03215v1#S4.E31 "In 2nd item â€£ Numerical approximation of the nonlinear operator ğ€ from (28). â€£ 4.1 Approximation of operators â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")) defined inÂ ([32](https://arxiv.org/html/2601.03215v1#S4.E32 "In Remark 3 (Sanity check of the approximation of ğ€). â€£ Numerical approximation of the nonlinear operator ğ€ from (28). â€£ 4.1 Approximation of operators â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")) as a function of the iteration step of the scheme. Note that the numerical error EN,M2E\_{N,M}^{2}, defined in fromÂ ([34](https://arxiv.org/html/2601.03215v1#S4.E34 "In Criterion of convergence. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")), and due to Picard iterations when computing the resistance function is set to be lower than 1â€‹eâˆ’161e-16 at each iteration.

#### Optimal round-trips for different convexity parameters.

For the remaining numerical results, including those reported in AppendixÂ [A.2](https://arxiv.org/html/2601.03215v1#A1.SS2 "A.2 Qualitative effects of impact decay and permanent impact â€£ Appendix A Complement to numerical results â€£ Trading with market resistance and concave price impact"), we set the signal noise level to zero, that is, Ïƒ=0\sigma=0 inÂ ([42](https://arxiv.org/html/2601.03215v1#S4.E42 "In Signals and least-squares Monte Carlo specification. â€£ 4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")), and run the iterative scheme on a single deterministic signal trajectory. All other parameters are kept fixed as in SectionÂ [4.3](https://arxiv.org/html/2601.03215v1#S4.SS3 "4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact"), unless stated otherwise; see RemarkÂ [5](https://arxiv.org/html/2601.03215v1#Thmrem5 "Remark 5. â€£ Signals and least-squares Monte Carlo specification. â€£ 4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact").

Furthermore, in all subsequent numerical experiments, the convergence errors EN,M1E\_{N,M}^{1} inÂ ([33](https://arxiv.org/html/2601.03215v1#S4.E33 "In Criterion of convergence. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")), EN,M2E\_{N,M}^{2} inÂ ([34](https://arxiv.org/html/2601.03215v1#S4.E34 "In Criterion of convergence. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")), and EN,MbfE\_{N,M}^{\mathrm{bf}} inÂ ([32](https://arxiv.org/html/2601.03215v1#S4.E32 "In Remark 3 (Sanity check of the approximation of ğ€). â€£ Numerical approximation of the nonlinear operator ğ€ from (28). â€£ 4.1 Approximation of operators â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")) are found to be below 10âˆ’1110^{-11}, 10âˆ’1610^{-16}, and 10âˆ’3110^{-31}, respectively, after 100100 iterations of the numerical schemeÂ ([35](https://arxiv.org/html/2601.03215v1#S4.E35 "In 1st item â€£ 2nd item â€£ Scheme definition. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact"))â€“([36](https://arxiv.org/html/2601.03215v1#S4.E36 "In 2nd item â€£ 2nd item â€£ Scheme definition. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")).

FigureÂ [6](https://arxiv.org/html/2601.03215v1#S4.F6 "Figure 6 â€£ Optimal round-trips for different convexity parameters. â€£ 4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact") illustrates the qualitative effect of the convexity parameter câ‰¥1c\geq 1 of the resistance function ğ’°M,c\mathcal{U}\_{M,c} fromÂ ([40](https://arxiv.org/html/2601.03215v1#S4.E40 "In Impact model specification. â€£ 4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")): in this case, the higher the value of cc, the more aggressive the optimal trading strategy, and the longer the optimal resistance rate lingers near zero when the trader changes his trading direction, which is consistent with the shapes of ğ’°Î´,c,câˆˆ{1,2,3,4}\mathcal{U}\_{\delta,c},\;c\in\{1,2,3,4\} depicted in FigureÂ [3](https://arxiv.org/html/2601.03215v1#S4.F3 "Figure 3 â€£ Impact model specification. â€£ 4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact"). Therefore, the convexity captures how easily the market resistance reacts to the traderâ€™s strategy, and can be interpreted as a proxy of the ability of a sophisticated trader to detect the executed volume. Compared to the linear propagator model shown in red (i.e., the case ğ’°â‰¡0\mathcal{U}\equiv 0), introducing a market resistance leads to less aggressive trading, which is consistent with the interpretation of market resistance as a proxy for sophisticated traders who benefit from the traderâ€™s metaorderâ€™s impact and thereby erode part of the traderâ€™s alpha.

![Refer to caption](x7.png)


Figure 6: Optimal round-trips in absence of resistance (ğ’°â‰¡0)(\mathcal{U}\equiv 0) and with different convexity parameters câˆˆ{1,2,3,4}c\in\{1,2,3,4\} used in ğ’°Î´,c\mathcal{U}\_{\delta,c} fromÂ ([40](https://arxiv.org/html/2601.03215v1#S4.E40 "In Impact model specification. â€£ 4.3 Optimal round-trips in presence of â€œbuyâ€ signals â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")).

## References

* AbiÂ Jaber and Neuman [2022]

  Eduardo AbiÂ Jaber and Eyal Neuman.
  Optimal liquidation with signals: the general propagator case.
  *Available at SSRN 4264823*, 2022.
* AbiÂ Jaber etÂ al. [2023]

  Eduardo AbiÂ Jaber, Eyal Neuman, and Moritz VoÃŸ.
  Equilibrium in functional stochastic games with mean-field
  interaction.
  *arXiv preprint arXiv:2306.05433*, 2023.
* AbiÂ Jaber etÂ al. [2024]

  Eduardo AbiÂ Jaber, Nathan DeÂ Carvalho, and HuyÃªn Pham.
  Trading with propagators and constraints: applications to optimal
  execution and battery storage.
  *arXiv preprint arXiv:2409.12098*, 2024.
* AbiÂ Jaber etÂ al. [2025]

  Eduardo AbiÂ Jaber, Alessandro Bondi, Nathan DeÂ Carvalho, Eyal Neuman, and
  Sturmius Tuschmann.
  Fredholm approach to nonlinear propagator models.
  *Available at SSRN 5167824*, 2025.
* Alfonsi etÂ al. [2010]

  AurÃ©lien Alfonsi, Antje Fruth, and Alexander Schied.
  Optimal execution strategies in limit order books with general shape
  functions.
  *Quantitative finance*, 10(2):143â€“157,
  2010.
* Almgren etÂ al. [2005]

  Robert Almgren, Chee Thum, Emmanuel Hauptmann, and Hong Li.
  Direct estimation of equity market impact.
  *Risk*, 18(7):58â€“62, 2005.
* Bacry etÂ al. [2015]

  Emmanuel Bacry, Adrian Iuga, Matthieu Lasnier, and Charles-Albert Lehalle.
  Market impacts and the life cycle of investors orders.
  *Market Microstructure and Liquidity*, 1(02):1550009, 2015.
* Bauschke and Combettes [2017]

  HeinzÂ H. Bauschke and PatrickÂ L. Combettes.
  *Convex analysis and monotone operator theory in Hilbert
  spaces*.
  Springer, 2017.
* Benzaquen and Bouchaud [2018]

  Michael Benzaquen and Jean-Philippe Bouchaud.
  Market impact with multi-timescale liquidity.
  *Quantitative Finance*, 18(11):1781â€“1790,
  2018.
* Bernstein [1929]

  Serge Bernstein.
  Sur les fonctions absolument monotones.
  *Acta Mathematica*, 52:1â€“66, 1929.
  doi: 10.1007/BF02592629.
* Bershova and Rakhlin [2013]

  Nataliya Bershova and Dmitry Rakhlin.
  The non-linear market impact of large trades: Evidence from
  buy-side order flow.
  *Quantitative finance*, 13(11):1759â€“1778,
  2013.
* Bouchaud etÂ al. [2003]

  Jean-Philippe Bouchaud, Yuval Gefen, Marc Potters, and Matthieu Wyart.
  Fluctuations and response in financial markets: the subtle nature of
  random price changes.
  *Quantitative finance*, 4(2):176, 2003.
* Bouchaud etÂ al. [2008]

  Jean-Philippe Bouchaud, J.Â Doyne Farmer, and Fabrizio Lillo.
  How markets slowly digest changes in supply and demand, 2008.
  URL <https://arxiv.org/abs/0809.0822>.
* Bouchaud etÂ al. [2018]

  Jean-Philippe Bouchaud, Julius Bonart, Jonathan Donier, and Martin Gould.
  *Trades, quotes and prices: financial markets under the
  microscope*.
  Cambridge University Press, 2018.
* Bucci etÂ al. [2019]

  FrÃ©dÃ©ric Bucci, Michael Benzaquen, Fabrizio Lillo, and Jean-Philippe
  Bouchaud.
  Crossover from linear to square-root market impact.
  *Physical review letters*, 122(10):108302,
  2019.
* Chahdi etÂ al. [2024]

  YoussefÂ O. Chahdi, Mathieu Rosenbaum, and GrÃ©goire Szymanski.
  A theory of passive market impact.
  *arXiv preprint arXiv:2412.07461*, 2024.
* DeÂ Carvalho [2025]

  Nathan DeÂ Carvalho.
  *Lifting Energy Markets: From Volatility Modeling to Optimal
  Trading*.
  Phd thesis, Ã‰cole doctorale de Sciences MathÃ©matiques de Paris
  Centre (ED 386), Paris, May 2025.
  Laboratoire de ProbabilitÃ©s, Statistique et ModÃ©lisation (LPSM).
  Supervisors: Eduardo Abi Jaber and HuyÃªn Pham.
* Donier etÂ al. [2015]

  Jonathan Donier, Julius Bonart, Iacopo Mastromatteo, and Jean-Philippe
  Bouchaud.
  A fully consistent, minimal model for non-linear market impact.
  *Quantitative finance*, 15(7):1109â€“1121,
  2015.
* Dunford and Schwartz [1988]

  Nelson Dunford and JacobÂ T. Schwartz.
  *Linear operators, part 1: general theory*, volumeÂ 10.
  John Wiley & Sons, 1988.
* Durin etÂ al. [2023]

  Bruno Durin, Mathieu Rosenbaum, and GrÃ©goire Szymanski.
  The two square root laws of market impact and the role of
  sophisticated market participants.
  *arXiv preprint arXiv:2311.18283*, 2023.
* Freyre-Sanders etÂ al. [2004]

  Andrew Freyre-Sanders, Renate Guobuzaite, and Kevin Byrne.
  A review of trading cost models: Reducing transaction costs.
  *The Journal of Investing*, 13(3):93â€“115,
  2004.
* Gabaix etÂ al. [2006]

  Xavier Gabaix, Parameswaran Gopikrishnan, Vasiliki Plerou, and HÂ Eugene
  Stanley.
  Institutional investors and stock market volatility.
  *The Quarterly Journal of Economics*, 121(2):461â€“504, 2006.
* Gatheral [2010]

  Jim Gatheral.
  No-dynamic-arbitrage and market impact.
  *Quantitative finance*, 10(7):749â€“759,
  2010.
* Hey etÂ al. [2023]

  Natascha Hey, Jean-Philippe Bouchaud, Iacopo Mastromatteo, Johannes
  Muhle-Karbe, and Kevin Webster.
  The Cost of Misspecifying Price Impact.
  *arXiv preprint arXiv:2306.00599*, 2023.
* Hey etÂ al. [2025]

  Natascha Hey, Iacopo Mastromatteo, Johannes Muhle-Karbe, and Kevin Webster.
  Trading with concave price impact and impact decayâ€”theory and
  evidence.
  *Operations Research*, 73(3):1230â€“1247,
  2025.
* Hopman [2003]

  Carl Hopman.
  *Essays on the relation between stock price movements and
  orders*.
  PhD thesis, Massachusetts Institute of Technology, 2003.
* Huber [1992]

  PeterÂ J Huber.
  Robust estimation of a location parameter.
  In *Breakthroughs in statistics: Methodology and distribution*,
  pages 492â€“518. Springer, 1992.
* Kyle and Obizhaeva [2023]

  AlbertÂ S Kyle and AnnaÂ A Obizhaeva.
  Large bets and stock market crashes.
  *Review of Finance*, 2023.
* Lax [2014]

  PeterÂ D. Lax.
  *Functional analysis*.
  John Wiley & Sons, 2014.
* Lillo etÂ al. [2003]

  Fabrizio Lillo, JÂ Doyne Farmer, and RosarioÂ N Mantegna.
  Master curve for price-impact function.
  *Nature*, 421(6919):129â€“130, 2003.
* Moro, Esteban and Vicente, Javier and Moyano, Luis G and Gerig,
  Austin and Farmer, J Doyne and Vaglica, Gabriella and Lillo, Fabrizio and
  Mantegna, Rosario N [2009]

  Moro, Esteban and Vicente, Javier and Moyano, Luis G and Gerig, Austin and
  Farmer, J Doyne and Vaglica, Gabriella and Lillo, Fabrizio and Mantegna,
  Rosario N.
  Market impact and trading profile of hidden orders in stock
  markets.
  *Physical Review E*, 80(6):066102, 2009.
* NystrÃ¶m [1930]

  EJÂ NystrÃ¶m.
  Ãœber die Praktische AuflÃ¶sung von Integralgleichungen
  mit Anwendungen auf Randwertaufgaben.
  *Acta Mathematica*, 54:185â€“204, 1930.
* Obizhaeva and Wang [2013]

  AnnaÂ A Obizhaeva and Jiang Wang.
  Optimal trading strategy and supply/demand dynamics.
  *Journal of Financial markets*, 16(1):1â€“32,
  2013.
* Robert etÂ al. [2012]

  Engle Robert, Ferstenberg Robert, and Russell Jeffrey.
  Measuring and modeling execution cost and risk.
  *The Journal of Portfolio Management*, 38(2):14â€“28, 2012.
* Sato and Kanazawa [2024]

  Yuki Sato and Kiyoshi Kanazawa.
  Does the square-root price impact law belong to the strict universal
  scalings?: quantitative support by a complete survey of the Tokyo stock
  exchange market.
  *arXiv preprint arXiv:2411.13965*, 2024.
* Struwe [2000]

  Michael Struwe.
  *Variational Methods: Applications to Nonlinear Partial
  Differential Equations and Hamiltonian Systems*, volume 991.
  Springer, 2000.
* TÃ³th etÂ al. [2010]

  Bence TÃ³th, Fabrizio Lillo, and JÂ Doyne Farmer.
  Segmentation algorithm for non-stationary compound poisson processes:
  With an application to inventory time series of market members in a financial
  market.
  *The European Physical Journal B*, 78:235â€“243, 2010.
* TÃ³th etÂ al. [2011]

  Bence TÃ³th, Yves Lemperiere, Cyril Deremble, Joachim DeÂ Lataillade, Julien
  Kockelkoren, and Jean-Philippe Bouchaud.
  Anomalous price impact and the critical nature of liquidity in
  financial markets.
  *Physical Review X*, 1(2):021006, 2011.
* Vaglica etÂ al. [2008]

  Gabriella Vaglica, Fabrizio Lillo, Esteban Moro, and RosarioÂ N Mantegna.
  Scaling laws of strategic behavior and size heterogeneity in agent
  dynamics.
  *Physical Review E*, 77(3):036110, 2008.

## Appendix A Complement to numerical results

### A.1 Proof of TheoremÂ [4.1](https://arxiv.org/html/2601.03215v1#S4.Thmtheorem1 "Theorem 4.1 (Exponential convergence of the iterative scheme). â€£ Theoretical convergence of the iterative scheme. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")

Fix nâˆˆâ„•âˆ—n\in\mathbb{N}^{\*}. Subtracting the FOCÂ ([27](https://arxiv.org/html/2601.03215v1#S3.E27 "In Theorem 3.5. â€£ 3.3 The general case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")) satisfied by (u^,r^)(\hat{u},\hat{r}) to the scheme equationsÂ ([35](https://arxiv.org/html/2601.03215v1#S4.E35 "In 1st item â€£ 2nd item â€£ Scheme definition. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact"))â€“([36](https://arxiv.org/html/2601.03215v1#S4.E36 "In 2nd item â€£ 2nd item â€£ Scheme definition. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")) defining (u[n],r[n])(u^{[n]},r^{[n]}) yields

|  |  |  |  |
| --- | --- | --- | --- |
|  | {Î³â€‹(u^âˆ’u[n])+(ğ‡+ğ†+ğ‡Ï•,Ï±+ğ‡Ï•,Ï±âˆ—)â€‹(u^âˆ’u[n])=ğ€â€‹(u^,r^)âˆ’ğ€â€‹(u[nâˆ’1],r[nâˆ’1]),r^âˆ’r[nâˆ’1]=ğ’°â€‹(ğ†â€‹(u^âˆ’r^))âˆ’ğ’°â€‹(ğ†â€‹(u[nâˆ’1]âˆ’r[nâˆ’1])).\begin{cases}\gamma(\hat{u}-u^{[n]})+(\mathbf{H}+\mathbf{G}+\mathbf{H}\_{\phi,\varrho}+\mathbf{H}\_{\phi,\varrho}^{\*})(\hat{u}-u^{[n]})=\mathbf{A}(\hat{u},\hat{r})-\mathbf{A}(u^{[n-1]},r^{[n-1]}),\\ \hat{r}-r^{[n-1]}=\mathcal{U}\big(\mathbf{G}(\hat{u}-\hat{r})\big)-\mathcal{U}\big(\mathbf{G}(u^{[n-1]}-r^{[n-1]})\big).\end{cases} |  | (44) |

On the one hand, take the inner product of the second equation fromÂ ([44](https://arxiv.org/html/2601.03215v1#A1.E44 "In A.1 Proof of Theorem 4.1 â€£ Appendix A Complement to numerical results â€£ Trading with market resistance and concave price impact")) against the process r^âˆ’r[nâˆ’1]\hat{r}-r^{[n-1]} such that

|  |  |  |  |
| --- | --- | --- | --- |
|  | â€–r^âˆ’r[nâˆ’1]â€–2\displaystyle\norm{\hat{r}-r^{[n-1]}}^{2} | =âŸ¨ğ’°â€‹(ğ†â€‹(u^âˆ’r^))âˆ’ğ’°â€‹(ğ†â€‹(u[nâˆ’1]âˆ’r[nâˆ’1])),r^âˆ’r[nâˆ’1]âŸ©\displaystyle=\langle\mathcal{U}\big(\mathbf{G}(\hat{u}-\hat{r})\big)-\mathcal{U}\big(\mathbf{G}(u^{[n-1]}-r^{[n-1]})\big),\hat{r}-r^{[n-1]}\rangle |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | â‰¤â€–ğ’°â€‹(ğ†â€‹(u^âˆ’r^))âˆ’ğ’°â€‹(ğ†â€‹(u[nâˆ’1]âˆ’r[nâˆ’1]))â€–â€‹â€–r^âˆ’r[nâˆ’1]â€–\displaystyle\leq\norm{\mathcal{U}\big(\mathbf{G}(\hat{u}-\hat{r})\big)-\mathcal{U}\big(\mathbf{G}(u^{[n-1]}-r^{[n-1]})\big)}\norm{\hat{r}-r^{[n-1]}} |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | â‰¤Lâ€‹â€–ğ†â€‹(u^âˆ’u[nâˆ’1])+ğ†â€‹(r[nâˆ’1]âˆ’r^)â€–â€‹â€–r^âˆ’r[nâˆ’1]â€–\displaystyle\leq L\norm{\mathbf{G}(\hat{u}-u^{[n-1]})+\mathbf{G}(r^{[n-1]}-\hat{r})}\norm{\hat{r}-r^{[n-1]}} |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | â‰¤Lâ€‹Tâ€‹CGâ€‹â€–u^âˆ’u[nâˆ’1]â€–â€‹â€–r^âˆ’r[nâˆ’1]â€–+Lâ€‹Tâ€‹CGâ€‹â€–r^âˆ’r[nâˆ’1]â€–2\displaystyle\leq L\sqrt{TC\_{G}}\norm{\hat{u}-u^{[n-1]}}\norm{\hat{r}-r^{[n-1]}}+L\sqrt{TC\_{G}}\norm{\hat{r}-r^{[n-1]}}^{2} |  |

where the respective inequalities are derived by applying Cauchy-Schwartz, and by using the Lipchitz-continuity of ğ’°\mathcal{U}, the triangular inequality, and the upper boundÂ ([16](https://arxiv.org/html/2601.03215v1#S3.E16 "In Definition 3.1. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")). Therefore, usingÂ ([37](https://arxiv.org/html/2601.03215v1#S4.E37 "In Theorem 4.1 (Exponential convergence of the iterative scheme). â€£ Theoretical convergence of the iterative scheme. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")), we deduce

|  |  |  |  |
| --- | --- | --- | --- |
|  | â€–r^âˆ’r[nâˆ’1]â€–â‰¤Lâ€‹Tâ€‹CG1âˆ’Lâ€‹Tâ€‹CGâ€‹â€–u^âˆ’u[nâˆ’1]â€–.\norm{\hat{r}-r^{[n-1]}}\leq\frac{L\sqrt{TC\_{G}}}{1-L\sqrt{TC\_{G}}}\norm{\hat{u}-u^{[n-1]}}. |  | (45) |

On the other hand, take the inner product of the first equation fromÂ ([44](https://arxiv.org/html/2601.03215v1#A1.E44 "In A.1 Proof of Theorem 4.1 â€£ Appendix A Complement to numerical results â€£ Trading with market resistance and concave price impact")) with the process (u^âˆ’u[n])\hat{u}-u^{[n]}) such that

|  |  |  |  |
| --- | --- | --- | --- |
|  | Î³â€‹â€–u^âˆ’u[n]â€–2\displaystyle\gamma\norm{\hat{u}-u^{[n]}}^{2} | =âˆ’âŸ¨(ğ‡+ğ†+ğ‡Ï•,Ï±+ğ‡Ï•,Ï±âˆ—)â€‹(u^âˆ’u[n]),u^âˆ’u[n]âŸ©\displaystyle=-\langle(\mathbf{H}+\mathbf{G}+\mathbf{H}\_{\phi,\varrho}+\mathbf{H}\_{\phi,\varrho}^{\*})(\hat{u}-u^{[n]}),\hat{u}-u^{[n]}\rangle |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | +âŸ¨ğ€â€‹(u^,r^)âˆ’ğ€â€‹(u[nâˆ’1],r[nâˆ’1]),u^âˆ’u[n]âŸ©\displaystyle\quad+\langle\mathbf{A}(\hat{u},\hat{r})-\mathbf{A}(u^{[n-1]},r^{[n-1]}),\hat{u}-u^{[n]}\rangle |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | â‰¤â€–ğ€â€‹(u^,r^)âˆ’ğ€â€‹(u[nâˆ’1],r[nâˆ’1])â€–â€‹â€–u^âˆ’u[n]â€–,\displaystyle\leq\norm{\mathbf{A}(\hat{u},\hat{r})-\mathbf{A}(u^{[n-1]},r^{[n-1]})}\norm{\hat{u}-u^{[n]}}, |  |

where we used the positive semi-definite property of (ğ‡+ğ†+ğ‡Ï•,Ï±+ğ‡Ï•,Ï±âˆ—)(\mathbf{H}+\mathbf{G}+\mathbf{H}\_{\phi,\varrho}+\mathbf{H}\_{\phi,\varrho}^{\*}), as well as the Cauchy-Schwartz inequality. Therefore, we have

|  |  |  |  |
| --- | --- | --- | --- |
|  | Î³â€‹â€–u^âˆ’u[n]â€–\displaystyle\gamma\norm{\hat{u}-u^{[n]}} | â‰¤â€–ğ€â€‹(u^,r^)âˆ’ğ€â€‹(u[nâˆ’1],r[nâˆ’1])â€–\displaystyle\leq\norm{\mathbf{A}(\hat{u},\hat{r})-\mathbf{A}(u^{[n-1]},r^{[n-1]})} |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | =||(ğ‡+ğ†)(r^âˆ’r[nâˆ’1])+(ğˆğ+(ğŒu[nâˆ’1]âˆ˜ğ†)âˆ—)âˆ’1((ğ‡+ğ†)âˆ—u[nâˆ’1])\displaystyle=\Big|\Big|(\mathbf{H}+\mathbf{G})(\hat{r}-r^{[n-1]})+\big(\mathbf{Id}+(\mathbf{M}^{u^{[n-1]}}\circ\mathbf{G})^{\*}\big)^{-1}\big((\mathbf{H}+\mathbf{G})^{\*}u^{[n-1]}\big) |  |
|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  |  | âˆ’(ğˆğ+(ğŒu^âˆ˜ğ†)âˆ—)âˆ’1((ğ‡+ğ†)âˆ—u^)||\displaystyle\quad-\big(\mathbf{Id}+(\mathbf{M}^{\hat{u}}\circ\mathbf{G})^{\*}\big)^{-1}\big((\mathbf{H}+\mathbf{G})^{\*}\hat{u}\big)\Big|\Big| |  | (46) |
|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  |  | â‰¤Tâ€‹CH+Gâ€‹â€–r^âˆ’r[nâˆ’1]â€–+â€–f[nâˆ’1]âˆ’f^â€–,\displaystyle\leq\sqrt{TC\_{H+G}}\norm{\hat{r}-r^{[n-1]}}+\norm{f^{[n-1]}-\hat{f}}, |  | (47) |

where we set

|  |  |  |  |
| --- | --- | --- | --- |
|  | f[nâˆ’1]\displaystyle f^{[n-1]} | :=(ğˆğ+(ğŒu[nâˆ’1]âˆ˜ğ†)âˆ—)âˆ’1â€‹((ğ‡+ğ†)âˆ—â€‹u[nâˆ’1]),\displaystyle:=\big(\mathbf{Id}+(\mathbf{M}^{u^{[n-1]}}\circ\mathbf{G})^{\*}\big)^{-1}\big((\mathbf{H}+\mathbf{G})^{\*}u^{[n-1]}\big), |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  | f^\displaystyle\hat{f} | :=(ğˆğ+(ğŒu^âˆ˜ğ†)âˆ—)âˆ’1â€‹((ğ‡+ğ†)âˆ—â€‹u^).\displaystyle:=\big(\mathbf{Id}+(\mathbf{M}^{\hat{u}}\circ\mathbf{G})^{\*}\big)^{-1}\big((\mathbf{H}+\mathbf{G})^{\*}\hat{u}\big). |  |

Note that we have equivalently

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  | f[nâˆ’1]+(ğŒu[nâˆ’1]âˆ˜ğ†)âˆ—â€‹f[nâˆ’1]\displaystyle f^{[n-1]}+(\mathbf{M}^{u^{[n-1]}}\circ\mathbf{G})^{\*}f^{[n-1]} | :=(ğ‡+ğ†)âˆ—â€‹u[nâˆ’1],\displaystyle:=(\mathbf{H}+\mathbf{G})^{\*}u^{[n-1]}, |  | (48) |
|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  | f^+(ğŒu^âˆ˜ğ†)âˆ—â€‹f^\displaystyle\hat{f}+(\mathbf{M}^{\hat{u}}\circ\mathbf{G})^{\*}\hat{f} | :=(ğ‡+ğ†)âˆ—â€‹u^.\displaystyle:=(\mathbf{H}+\mathbf{G})^{\*}\hat{u}. |  | (49) |

Therefore, subtractingÂ ([49](https://arxiv.org/html/2601.03215v1#A1.E49 "In A.1 Proof of Theorem 4.1 â€£ Appendix A Complement to numerical results â€£ Trading with market resistance and concave price impact")) toÂ ([48](https://arxiv.org/html/2601.03215v1#A1.E48 "In A.1 Proof of Theorem 4.1 â€£ Appendix A Complement to numerical results â€£ Trading with market resistance and concave price impact")), and taking the inner product with f[nâˆ’1]âˆ’f^f^{[n-1]}-\hat{f} yields

|  |  |  |  |
| --- | --- | --- | --- |
|  | â€–f[nâˆ’1]âˆ’f^â€–2\displaystyle\norm{f^{[n-1]}-\hat{f}}^{2} | =âŸ¨(ğ‡+ğ†)âˆ—â€‹(u[nâˆ’1]âˆ’u^),f[nâˆ’1]âˆ’f^âŸ©âˆ’âŸ¨(ğŒu[nâˆ’1]âˆ˜ğ†)âˆ—â€‹f[nâˆ’1]âˆ’(ğŒu^âˆ˜ğ†)âˆ—â€‹f^,f[nâˆ’1]âˆ’f^âŸ©\displaystyle=\langle(\mathbf{H}+\mathbf{G})^{\*}(u^{[n-1]}-\hat{u}),f^{[n-1]}-\hat{f}\rangle-\langle(\mathbf{M}^{u^{[n-1]}}\circ\mathbf{G})^{\*}f^{[n-1]}-(\mathbf{M}^{\hat{u}}\circ\mathbf{G})^{\*}\hat{f},f^{[n-1]}-\hat{f}\rangle |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | â‰¤â€–(ğ‡+ğ†)âˆ—â€‹(u[nâˆ’1]âˆ’u^)â€–â€‹â€–f[nâˆ’1]âˆ’f^â€–+Câ€‹â€–ğ†â€‹(f^âˆ’f[nâˆ’1])â€–â€‹â€–f[nâˆ’1]âˆ’f^â€–\displaystyle\leq\norm{(\mathbf{H}+\mathbf{G})^{\*}(u^{[n-1]}-\hat{u})}\norm{f^{[n-1]}-\hat{f}}+C\norm{\mathbf{G}(\hat{f}-f^{[n-1]})}\norm{f^{[n-1]}-\hat{f}} |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | â‰¤Tâ€‹CH+Gâ€‹â€–u[nâˆ’1]âˆ’u^â€–+Câ€‹Tâ€‹CGâ€‹â€–f^âˆ’f[nâˆ’1]â€–,\displaystyle\leq\sqrt{TC\_{H+G}}\norm{u^{[n-1]}-\hat{u}}+C\sqrt{TC\_{G}}\norm{\hat{f}-f^{[n-1]}}, |  |

where the inequalities are respectively obtained by applying Cauchy-Schwartz, and using the boundedness of ğ’°â€²\mathcal{U}^{\prime} and the boundsÂ ([16](https://arxiv.org/html/2601.03215v1#S3.E16 "In Definition 3.1. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact"))â€“([17](https://arxiv.org/html/2601.03215v1#S3.E17 "In Definition 3.1. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")). Thus, usingÂ ([37](https://arxiv.org/html/2601.03215v1#S4.E37 "In Theorem 4.1 (Exponential convergence of the iterative scheme). â€£ Theoretical convergence of the iterative scheme. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")), we obtain

|  |  |  |  |
| --- | --- | --- | --- |
|  | â€–f[nâˆ’1]âˆ’f^â€–â‰¤Tâ€‹CH+G1âˆ’Câ€‹Tâ€‹CGâ€‹â€–u[nâˆ’1]âˆ’u^â€–.\norm{f^{[n-1]}-\hat{f}}\leq\frac{\sqrt{TC\_{H+G}}}{1-C\sqrt{TC\_{G}}}\norm{u^{[n-1]}-\hat{u}}. |  | (50) |

Finally, injectingÂ ([50](https://arxiv.org/html/2601.03215v1#A1.E50 "In A.1 Proof of Theorem 4.1 â€£ Appendix A Complement to numerical results â€£ Trading with market resistance and concave price impact")) andÂ ([45](https://arxiv.org/html/2601.03215v1#A1.E45 "In A.1 Proof of Theorem 4.1 â€£ Appendix A Complement to numerical results â€£ Trading with market resistance and concave price impact")) intoÂ ([47](https://arxiv.org/html/2601.03215v1#A1.E47 "In A.1 Proof of Theorem 4.1 â€£ Appendix A Complement to numerical results â€£ Trading with market resistance and concave price impact")) readily leads to

|  |  |  |
| --- | --- | --- |
|  | â€–u^âˆ’u[n]â€–â‰¤C~Î³â€‹â€–u[nâˆ’1]âˆ’u^â€–,\norm{\hat{u}-u^{[n]}}\leq\frac{\tilde{C}}{\gamma}\norm{u^{[n-1]}-\hat{u}}, |  |

where C~\tilde{C} is given byÂ ([38](https://arxiv.org/html/2601.03215v1#S4.E38 "In Theorem 4.1 (Exponential convergence of the iterative scheme). â€£ Theoretical convergence of the iterative scheme. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")) such that (â€–u^âˆ’u[n]â€–)n(\norm{\hat{u}-u^{[n]}})\_{n} is sub-geometric with common ratio C~Î³\frac{\tilde{C}}{\gamma} and therefore converges to zero at exponential rate given byÂ ([39](https://arxiv.org/html/2601.03215v1#S4.E39 "In Theorem 4.1 (Exponential convergence of the iterative scheme). â€£ Theoretical convergence of the iterative scheme. â€£ 4.2 Iterative numerical scheme â€£ 4 Numerical scheme and application to optimal round-trips â€£ Trading with market resistance and concave price impact")).

### A.2 Qualitative effects of impact decay and permanent impact

FigureÂ [7](https://arxiv.org/html/2601.03215v1#A1.F7 "Figure 7 â€£ A.2 Qualitative effects of impact decay and permanent impact â€£ Appendix A Complement to numerical results â€£ Trading with market resistance and concave price impact") illustrates the qualitative effect of the impact decay parameter Î½âˆˆ(12,1)\nu\in(\frac{1}{2},1) of the power-law kernel GÎ»,Î½G\_{\lambda,\nu} fromÂ ([5](https://arxiv.org/html/2601.03215v1#S2.E5 "In 2.2 A general market resistance model â€£ 2 Inception: a sophisticated trader as a market resistance â€£ Trading with market resistance and concave price impact")): the larger Î½\nu is, the faster the decay becomes, and consequently the more aggressive the resulting optimal trades are.

Finally, FigureÂ [8](https://arxiv.org/html/2601.03215v1#A1.F8 "Figure 8 â€£ A.2 Qualitative effects of impact decay and permanent impact â€£ Appendix A Complement to numerical results â€£ Trading with market resistance and concave price impact") illustrates the qualitative effect of the Îºâˆâˆˆ{0.5,1,1.5}\kappa\_{\infty}\in\{0.5,1,1.5\} from the permanent impact kernel HH fromÂ ([18](https://arxiv.org/html/2601.03215v1#S3.E18 "In Assumption B. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")): the smaller Îºâˆ\kappa\_{\infty} is, the smaller the permanent impact becomes, and consequently the more aggressive the resulting optimal trades are.

![Refer to caption](x8.png)


Figure 7: Optimal round-trips with different impact decay parameters Î½âˆˆ{0.5,0.614,0.7,0.8,0.9}\nu\in\{0.5,0.614,0.7,0.8,0.9\} used in the power-law kernel GÎ»,Î½G\_{\lambda,\nu} fromÂ ([5](https://arxiv.org/html/2601.03215v1#S2.E5 "In 2.2 A general market resistance model â€£ 2 Inception: a sophisticated trader as a market resistance â€£ Trading with market resistance and concave price impact")).

![Refer to caption](x9.png)


Figure 8: Optimal round-trips with different permanent impact parameters Îºâˆâˆˆ{0.5,1,1.5}\kappa\_{\infty}\in\{0.5,1,1.5\} used in the permanent impact kernel HH fromÂ ([18](https://arxiv.org/html/2601.03215v1#S3.E18 "In Assumption B. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")).

## Appendix B Mathematical tools

### B.1 Completely monotone functions

###### Definition B.1 (Completely monotone function).

A function G:(0,âˆ)â†’â„G:(0,\infty)\to\mathbb{R} is said to be completely monotone if GâˆˆCâˆâ€‹(0,âˆ)G\in C^{\infty}(0,\infty) and

|  |  |  |
| --- | --- | --- |
|  | (âˆ’1)nâ€‹G(n)â€‹(t)â‰¥0,âˆ€t>0,âˆ€nâ‰¥0.(-1)^{n}G^{(n)}(t)\geq 0,\qquad\forall\,t>0,\ \forall\,n\geq 0. |  |

If, in addition, GG admits a (finite) right limit at 0, we extend it to [0,âˆ)[0,\infty) by setting
Gâ€‹(0):=limtâ†’0+Gâ€‹(t)G(0):=\lim\_{t\to 0^{+}}G(t).

Completely monotone functions are, in particular, nonnegative, nonincreasing, and convex on (0,âˆ)(0,\infty).
We refer to Bernstein [[10](https://arxiv.org/html/2601.03215v1#bib.bib10)] for further properties and historical background.

###### Example B.2.

On [0,âˆ)[0,\infty), the following functions are completely monotone:

* â€¢

  Exponentials: for any Î»â‰¥0\lambda\geq 0, tâ†¦eâˆ’Î»â€‹tt\mapsto e^{-\lambda t}.
* â€¢

  Finite or countable sums (or mixtures) of exponentials with nonnegative weights:

  |  |  |  |
  | --- | --- | --- |
  |  | Gâ€‹(t)=âˆ‘kâ‰¥1akâ€‹eâˆ’Î»kâ€‹t,akâ‰¥0,Î»kâ‰¥0,G(t)=\sum\_{k\geq 1}a\_{k}e^{-\lambda\_{k}t},\qquad a\_{k}\geq 0,\ \lambda\_{k}\geq 0, |  |

  whenever the series converges (e.g. pointwise for all tâ‰¥0t\geq 0).
* â€¢

  Power laws: for any Î±>0\alpha>0 and any bâ‰¥0b\geq 0, tâ†¦(b+t)âˆ’Î±t\mapsto(b+t)^{-\alpha}.

The key structural result is that completely monotone functions are exactly Laplace transforms of positive measures.

###### Theorem B.3 (Bernstein-Widder representation).

Let G:(0,âˆ)â†’[0,âˆ)G:(0,\infty)\to[0,\infty) be completely monotone.
Then there exists a (unique) Ïƒ\sigma-finite Borel measure Î¼\mu on [0,âˆ)[0,\infty) such that

|  |  |  |  |
| --- | --- | --- | --- |
|  | Gâ€‹(t)=âˆ«[0,âˆ)eâˆ’Î»â€‹tâ€‹Î¼â€‹(dÎ»),t>0.G(t)=\int\_{[0,\infty)}e^{-\lambda t}\,\mu(\differential\lambda),\qquad t>0. |  | (51) |

If moreover Gâ€‹(0+)<âˆG(0+)<\infty, then Î¼\mu is a finite measure and Î¼â€‹([0,âˆ))=Gâ€‹(0+)\mu([0,\infty))=G(0+), so that
([51](https://arxiv.org/html/2601.03215v1#A2.E51 "In Theorem B.3 (Bernstein-Widder representation). â€£ B.1 Completely monotone functions â€£ Appendix B Mathematical tools â€£ Trading with market resistance and concave price impact")) holds for all tâ‰¥0t\geq 0 by defining Gâ€‹(0):=Gâ€‹(0+)G(0):=G(0+).

###### Proof.

See TheoremÂ 3 in [[29](https://arxiv.org/html/2601.03215v1#bib.bib29)].
âˆ

### B.2 Operators in â„’2\mathcal{L}^{2} and in L2L^{2}

###### Definition B.4.

We say that an operator ğ€\mathbf{A} on L2L^{2} is non-anticipative if for all 0â‰¤tâ‰¤T0\leq t\leq T and all u,vu,v in L2L^{2}, we have

|  |  |  |
| --- | --- | --- |
|  | uâ€‹ğŸ™[0,t]=vâ€‹ğŸ™[0,t]â‡’ğ€â€‹uâ€‹(t)=ğ€â€‹vâ€‹(t).u\mathbbm{1}\_{[0,t]}=v\mathbbm{1}\_{[0,t]}\Rightarrow\mathbf{A}u(t)=\mathbf{A}v(t). |  |

Non-anticipative operators on L2L^{2} play a special role because they naturally induce operators on â„’2\mathcal{L}^{2}.

###### Lemma B.5.

Suppose that ğ€\mathbf{A} is a non-anticipative operator on L2L^{2} such that there exists C>0C>0 such that

|  |  |  |
| --- | --- | --- |
|  | â€–ğ€â€‹uâ€–L2â‰¤Câ€‹â€–uâ€–L2.\norm{\mathbf{A}u}\_{L^{2}}\leq C\norm{u}\_{L^{2}}. |  |

For each uâˆˆâ„’2u\in\mathcal{L}^{2}, we define

|  |  |  |
| --- | --- | --- |
|  | ğâ€‹(u)â€‹(Ï‰,t)=ğ€â€‹(uâ€‹(Ï‰,â‹…))â€‹(t).\mathbf{B}(u)(\omega,t)=\mathbf{A}(u(\omega,\cdot))(t). |  |

Then ğ\mathbf{B} defines an operator on â„’2\mathcal{L}^{2} such that

|  |  |  |
| --- | --- | --- |
|  | â€–ğâ€‹uâ€–â„’2â‰¤Câ€‹â€–uâ€–â„’2.\norm{\mathbf{B}u}\_{\mathcal{L}^{2}}\leq C\norm{u}\_{\mathcal{L}^{2}}. |  |

In that case, we write ğ=ğ€^\mathbf{B}=\widehat{\mathbf{A}}.

###### Lemma B.6.

Suppose that ğ\mathbf{B} is an operator on â„’2\mathcal{L}^{2} for which there exists C>0C>0 such that

|  |  |  |
| --- | --- | --- |
|  | â€–ğâ€‹uâ€–â„’2â‰¤Câ€‹â€–uâ€–â„’2\norm{\mathbf{B}u}\_{\mathcal{L}^{2}}\leq C\norm{u}\_{\mathcal{L}^{2}} |  |

and suppose that if uu is a deterministic process, then ğâ€‹u\mathbf{B}u is also deterministic. Then for each uâˆˆL2u\in L^{2}, we define

|  |  |  |
| --- | --- | --- |
|  | ğ€â€‹uâ€‹(t)=ğâ€‹uâ€‹(t).\mathbf{A}u(t)=\mathbf{B}u(t). |  |

Then ğ€\mathbf{A} defines an non-anticipative operator on L2L^{2} such that

|  |  |  |
| --- | --- | --- |
|  | â€–ğ€â€‹uâ€–L2â‰¤Câ€‹â€–uâ€–L2.\norm{\mathbf{A}u}\_{L^{2}}\leq C\norm{u}\_{L^{2}}. |  |

In that case, we write ğ€=ğË‡\mathbf{A}=\widecheck{\mathbf{B}}.
Moreover, we have ğË‡^=ğ.\widehat{\widecheck{\mathbf{B}}}=\mathbf{B}.

### B.3 FrÃ©chet differentiability

###### Definition B.7.

Let EE and FF be two Banach spaces and VV be an open subset of EE. An application f:Vâ†’Ff:V\to F is said to be FrÃ©chet differentiable at uâˆˆVu\in V if there exists a linear application Dâ€‹fâ€‹(u):Eâ†’FDf(u):E\to F such that the following limit holds

|  |  |  |
| --- | --- | --- |
|  | limâ€–hâ€–Eâ†’0â€–fâ€‹(u+h)âˆ’fâ€‹(u)âˆ’Dâ€‹fâ€‹(u)â€‹(h)â€–Fâ€–hâ€–E=0.\lim\limits\_{\norm{h}\_{E}\to 0}\frac{\norm{f(u+h)-f(u)-Df(u)(h)}\_{F}}{\norm{h}\_{E}}=0. |  |

###### Theorem B.8 (Implicit function theorem).

Let X,Y,ZX,Y,Z be Banach spaces. Let the mapping f:XÃ—Yâ†’Zf:X\times Y\to Z be continuously FrÃ©chet differentiable in the sense of DefinitionÂ [B.7](https://arxiv.org/html/2601.03215v1#A2.Thmtheorem7 "Definition B.7. â€£ B.3 FrÃ©chet differentiability â€£ Appendix B Mathematical tools â€£ Trading with market resistance and concave price impact").
Then if (x0,y0)âˆˆXÃ—Y(x\_{0},y\_{0})\in X\times Y satisfies fâ€‹(x0,y0)=0f(x\_{0},y\_{0})=0 and if yâ†¦Dâ€‹fâ€‹(x0,y0)â€‹(0,y)y\mapsto Df(x\_{0},y\_{0})(0,y) is a Banach space isomorphism from YY onto ZZ, then there exist neighborhoods UU of x0x\_{0} and VV of y0y\_{0} and a FrÃ©chet differentiable function g:Uâ†’Vg:U\to V such that fâ€‹(x,gâ€‹(x))=0f(x,g(x))=0 and fâ€‹(x,y)=0f(x,y)=0 if and only if y=gâ€‹(x)y=g(x), for all (x,y)âˆˆUÃ—V(x,y)\in U\times V.

## Appendix C Study of a nonlinear Volterra equation

### C.1 Definition and main results.

In this section, we are interested in the following nonlinear Volterra equation.

###### Definition C.1.

Let k:[0,âˆ)â†’[0,âˆ)k:[0,\infty)\to[0,\infty) be a locally integrable function such that for any t0>0t\_{0}>0, we have

|  |  |  |
| --- | --- | --- |
|  | limtâ†’t0âˆ«0âˆ|kâ€‹(t0âˆ’s)âˆ’kâ€‹(tâˆ’s)|â€‹dsâ†’0.\lim\limits\_{t\to t\_{0}}\int\_{0}^{\infty}|k(t\_{0}-s)-k(t-s)|\,\differential s\to 0. |  |

For T>0T>0, we consider f:[0,T]â†’â„f:[0,T]\to\mathbb{R} and g:â„â†’â„g:\mathbb{R}\to\mathbb{R}. We write (Ek,f,g)(E\_{k,f,g}) the Volterra integral Equation given by

|  |  |  |
| --- | --- | --- |
|  | xâ€‹(t)+âˆ«0tkâ€‹(tâˆ’s)â€‹gâ€‹(xâ€‹(s))â€‹ds=fâ€‹(t)x(t)+\int\_{0}^{t}k(t-s)g\big(x(s)\big)\,\differential s=f(t) |  |

where x:[0,T]â†’â„x:[0,T]\to\mathbb{R}.

We first state the following existence and uniqueness result.

###### Theorem C.2.

Suppose that gg is Lipschitz continuous and let T>0T>0. Then, for every locally bounded function ff on [0,T][0,T], there exists a unique solution to (Ek,f,g)(E\_{k,f,g}). Moreover, there exists a constant CT>0C\_{T}>0, depending only on the Lipschitz constant of gg, on TT, and on the kernel kk, such that for any two bounded functions f1f\_{1} and f2f\_{2} on [0,T][0,T], if x1x\_{1} and x2x\_{2} denote the corresponding solutions to (Ek,f1,g)(E\_{k,f\_{1},g}) and (Ek,f2,g)(E\_{k,f\_{2},g}), respectively, then we have

|  |  |  |  |
| --- | --- | --- | --- |
|  | â€–x1âˆ’x2â€–âˆâ‰¤CTâ€‹â€–f1âˆ’f2â€–âˆ.\norm{x\_{1}-x\_{2}}\_{\infty}\leq C\_{T}\norm{f\_{1}-f\_{2}}\_{\infty}. |  | (52) |

For a given Lipschitz continuous function gg, TheoremÂ [C.2](https://arxiv.org/html/2601.03215v1#A3.Thmtheorem2 "Theorem C.2. â€£ C.1 Definition and main results. â€£ Appendix C Study of a nonlinear Volterra equation â€£ Trading with market resistance and concave price impact") implies that there exists an operator ğ’T:Lâˆâ€‹([0,T])â†’Lâˆâ€‹([0,T])\mathbf{S}\_{T}:L^{\infty}([0,T])\to L^{\infty}([0,T]) such that for every locally bounded function ff on [0,T][0,T], x=ğ’Tâ€‹fx=\mathbf{S}\_{T}f is the unique solution of (Ek,f,g)(E\_{k,f,g}). By TheoremÂ [C.2](https://arxiv.org/html/2601.03215v1#A3.Thmtheorem2 "Theorem C.2. â€£ C.1 Definition and main results. â€£ Appendix C Study of a nonlinear Volterra equation â€£ Trading with market resistance and concave price impact"), we already know that this functional is Lipschitz continuous in Lâˆâ€‹([0,T])L^{\infty}([0,T]). This means that there exists cT>0c\_{T}>0 such that

|  |  |  |
| --- | --- | --- |
|  | cTâ€‹â€–x1âˆ’x2â€–Lâˆâ‰¤â€–ğ’Tâˆ’1â€‹x1âˆ’ğ’Tâˆ’2â€‹x2â€–Lâˆ.c\_{T}\norm{x\_{1}-x\_{2}}\_{L^{\infty}}\leq\norm{\mathbf{S}\_{T}^{-1}x\_{1}-\mathbf{S}\_{T}^{-2}x\_{2}}\_{L^{\infty}}. |  |

### C.2 Proof of TheoremÂ [C.2](https://arxiv.org/html/2601.03215v1#A3.Thmtheorem2 "Theorem C.2. â€£ C.1 Definition and main results. â€£ Appendix C Study of a nonlinear Volterra equation â€£ Trading with market resistance and concave price impact")

Let gg be a Lipschitz continuous function, LL its Lipschitz constant and let Îµ>0\varepsilon>0 be small enough so that

|  |  |  |
| --- | --- | --- |
|  | âˆ«0Îµkâ€‹(s)â€‹dsâ‰¤12â€‹L.\int\_{0}^{\varepsilon}k(s)\,\differential s\leq\frac{1}{2L}. |  |

The proof is split in two parts. First, we prove TheoremÂ [C.2](https://arxiv.org/html/2601.03215v1#A3.Thmtheorem2 "Theorem C.2. â€£ C.1 Definition and main results. â€£ Appendix C Study of a nonlinear Volterra equation â€£ Trading with market resistance and concave price impact") on [0,Îµ][0,\varepsilon]. Then, we show that if TheoremÂ [C.2](https://arxiv.org/html/2601.03215v1#A3.Thmtheorem2 "Theorem C.2. â€£ C.1 Definition and main results. â€£ Appendix C Study of a nonlinear Volterra equation â€£ Trading with market resistance and concave price impact") is true on [0,T][0,T], then it also holds on [0,T+Îµ][0,T+\varepsilon]. Since â„\mathbb{R} is Archimedian, we can then conclude by induction.

Step 1.
We define

|  |  |  |
| --- | --- | --- |
|  | ğ’¯0â€‹xâ€‹(t)=âˆ«0tkâ€‹(tâˆ’s)â€‹gâ€‹(xâ€‹(s))â€‹ds\mathcal{T}\_{0}x(t)=\int\_{0}^{t}k(t-s)g\big(x(s)\big)\,\differential s |  |

for any function xx in Lâˆâ€‹([0,Îµ])L^{\infty}([0,\varepsilon]) and all 0â‰¤tâ‰¤Îµ0\leq t\leq\varepsilon. This defines an operator ğ’¯0\mathcal{T}\_{0} on Lâˆâ€‹([0,Îµ])L^{\infty}([0,\varepsilon]). Moreover, for all bounded functions x0x\_{0} and x1x\_{1} on [0,Îµ][0,\varepsilon], we have

|  |  |  |  |
| --- | --- | --- | --- |
|  | |ğ’¯0â€‹x1â€‹(t)âˆ’ğ’¯0â€‹x2â€‹(t)|\displaystyle|\mathcal{T}\_{0}x\_{1}(t)-\mathcal{T}\_{0}x\_{2}(t)| | â‰¤âˆ«0tkâ€‹(tâˆ’s)â€‹|gâ€‹(x1â€‹(s))âˆ’gâ€‹(x2â€‹(s))|â€‹ds\displaystyle\leq\int\_{0}^{t}k(t-s)|g\big(x\_{1}(s)\big)-g\big(x\_{2}(s)\big)|\,\differential s |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | â‰¤Lâ€‹âˆ«0tkâ€‹(tâˆ’s)â€‹|x1â€‹(s)âˆ’x2â€‹(s)|â€‹ds\displaystyle\leq L\int\_{0}^{t}k(t-s)|x\_{1}(s)-x\_{2}(s)|\,\differential s |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | â‰¤Lâ€‹âˆ«0Îµkâ€‹(s)â€‹dsâ€‹â€–x1âˆ’x2â€–âˆ\displaystyle\leq L\int\_{0}^{\varepsilon}k(s)\,\differential s\norm{x\_{1}-x\_{2}}\_{\infty} |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | â‰¤12â€‹â€–x1âˆ’x2â€–âˆ.\displaystyle\leq\frac{1}{2}\norm{x\_{1}-x\_{2}}\_{\infty}. |  |

Thus, if ff is a bounded function on [0,Îµ][0,\varepsilon], the operator ğ’¯~0\widetilde{\mathcal{T}}\_{0} defined on Lâˆâ€‹([0,Îµ])L^{\infty}([0,\varepsilon]) by

|  |  |  |
| --- | --- | --- |
|  | ğ’¯~0â€‹xâ€‹(t):=fâ€‹(t)âˆ’ğ’¯0â€‹xâ€‹(t)\widetilde{\mathcal{T}}\_{0}x(t):=f(t)-{\mathcal{T}}\_{0}x(t) |  |

is a contraction of Lâˆâ€‹([0,Îµ])L^{\infty}([0,\varepsilon]) and therefore admits a unique fixed point xâˆˆLâˆâ€‹([0,Îµ])x\in L^{\infty}([0,\varepsilon]), which is also a solution of (Ek,f,g)(E\_{k,f,g}) on [0,Îµ][0,\varepsilon]. This ensures that I+ğ’¯0I+\mathcal{T}\_{0} is invertible, where II stands here for the identity operator on Lâˆâ€‹([0,Îµ])L^{\infty}([0,\varepsilon]), and therefore that x=(I+ğ’¯0)âˆ’1â€‹fx=(I+\mathcal{T}\_{0})^{-1}f.

We now prove that (I+ğ’¯0)âˆ’1(I+\mathcal{T}\_{0})^{-1} is 22-Lipschitz continuous, which impliesÂ ([52](https://arxiv.org/html/2601.03215v1#A3.E52 "In Theorem C.2. â€£ C.1 Definition and main results. â€£ Appendix C Study of a nonlinear Volterra equation â€£ Trading with market resistance and concave price impact")) with T=ÎµT=\varepsilon. We consider f1,f2f\_{1},f\_{2} two bounded functions on [0,Îµ][0,\varepsilon] and we write x1=(I+ğ’¯0)âˆ’1â€‹f1x\_{1}=(I+\mathcal{T}\_{0})^{-1}f\_{1} and x2=(I+ğ’¯0)âˆ’1â€‹f2x\_{2}=(I+\mathcal{T}\_{0})^{-1}f\_{2}. We then have

|  |  |  |  |
| --- | --- | --- | --- |
|  | â€–f1âˆ’f2â€–âˆ\displaystyle\norm{f\_{1}-f\_{2}}\_{\infty} | =â€–(I+ğ’¯0)â€‹x1âˆ’(I+ğ’¯0)â€‹x2â€–âˆ\displaystyle=\norm{(I+\mathcal{T}\_{0})x\_{1}-(I+\mathcal{T}\_{0})x\_{2}}\_{\infty} |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | â‰¥â€–x1âˆ’x2â€–âˆâˆ’â€–ğ’¯0â€‹x1âˆ’ğ’¯0â€‹x2â€–âˆ.\displaystyle\geq\norm{x\_{1}-x\_{2}}\_{\infty}-\norm{\mathcal{T}\_{0}x\_{1}-\mathcal{T}\_{0}x\_{2}}\_{\infty}. |  |

We then obtain

|  |  |  |  |
| --- | --- | --- | --- |
|  | â€–x1âˆ’x2â€–âˆ\displaystyle\norm{x\_{1}-x\_{2}}\_{\infty} | â‰¤â€–f1âˆ’f2â€–âˆ+â€–ğ’¯0â€‹x1âˆ’ğ’¯0â€‹x2â€–âˆ\displaystyle\leq\norm{f\_{1}-f\_{2}}\_{\infty}+\norm{\mathcal{T}\_{0}x\_{1}-\mathcal{T}\_{0}x\_{2}}\_{\infty} |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | â‰¤â€–f1âˆ’f2â€–âˆ+12â€‹â€–x1âˆ’x2â€–âˆ,\displaystyle\leq\norm{f\_{1}-f\_{2}}\_{\infty}+\frac{1}{2}\norm{x\_{1}-x\_{2}}\_{\infty}, |  |

and thus

|  |  |  |
| --- | --- | --- |
|  | â€–x1âˆ’x2â€–âˆâ‰¤2â€‹â€–f1âˆ’f2â€–âˆ\norm{x\_{1}-x\_{2}}\_{\infty}\leq 2\norm{f\_{1}-f\_{2}}\_{\infty} |  |

which concludes the proof of the first step.

Step 2.
We now assume the result holds on [0,T][0,T] and want to extend it on [0,T+Îµ][0,T+\varepsilon]. To this end, we introduce the operator ğ’¯\mathcal{T} acting on Lâˆâ€‹([T,T+Îµ])L^{\infty}([T,T+\varepsilon]) functions as follows

|  |  |  |
| --- | --- | --- |
|  | ğ’¯â€‹xâ€‹(t)=âˆ«Ttkâ€‹(tâˆ’s)â€‹gâ€‹(xâ€‹(s))â€‹ds,Tâ‰¤tâ‰¤T+Îµ.\mathcal{T}x(t)=\int\_{T}^{t}k(t-s)g\big(x(s)\big)\,\differential s,\quad T\leq t\leq T+\varepsilon. |  |

Proceeding as previously, this operator in 12\frac{1}{2}-Lipschitz and (I+ğ’¯)âˆ’1(I+\mathcal{T})^{-1} is invertible, where II stands here for the identity operator on Lâˆâ€‹([T,T+Îµ])L^{\infty}([T,T+\varepsilon]). Moreover, we can also prove that (I+ğ’¯)âˆ’1(I+\mathcal{T})^{-1} is 22-Lipschitz continuous on Lâˆâ€‹([T,T+Îµ])L^{\infty}([T,T+\varepsilon]).

Now, let ff be a bounded function on [0,T+Îµ][0,T+\varepsilon]. By assumption, we know that (Ek,f,g)(E\_{k,f,g}) admits a solution xTx\_{T} on [0,T][0,T]. Consider f~âˆˆLâˆâ€‹([T,T+Îµ])\widetilde{f}\in L^{\infty}([T,T+\varepsilon]) defined by

|  |  |  |
| --- | --- | --- |
|  | f~â€‹(t)=fâ€‹(t)âˆ’âˆ«0Tkâ€‹(tâˆ’s)â€‹gâ€‹(xTâ€‹(s))â€‹ds,Tâ‰¤tâ‰¤T+Îµ.\widetilde{f}(t)=f(t)-\int\_{0}^{T}k(t-s)g\big(x\_{T}(s)\big)\,\differential s,\quad T\leq t\leq T+\varepsilon. |  |

Setting x~=(I+ğ’¯)âˆ’1â€‹f~\widetilde{x}=(I+\mathcal{T})^{-1}\widetilde{f}, we have for all Tâ‰¤tâ‰¤T+ÎµT\leq t\leq T+\varepsilon

|  |  |  |
| --- | --- | --- |
|  | x~â€‹(t)+âˆ«Ttkâ€‹(tâˆ’s)â€‹gâ€‹(xâ€‹(s))â€‹ds=fâ€‹(t)âˆ’âˆ«0Tkâ€‹(tâˆ’s)â€‹gâ€‹(xTâ€‹(s))â€‹ds.\widetilde{x}(t)+\int\_{T}^{t}k(t-s)g\big(x(s)\big)\,\differential s=f(t)-\int\_{0}^{T}k(t-s)g\big(x\_{T}(s)\big)\,\differential s. |  |

Since xTx\_{T} is a solution of (Ek,f,g)(E\_{k,f,g}) on [0,T][0,T], we have that
fâ€‹(T)âˆ’âˆ«0Tkâ€‹(Tâˆ’s)â€‹gâ€‹(xTâ€‹(s))â€‹ds=xTâ€‹(T).f(T)-\int\_{0}^{T}k(T-s)g(x\_{T}(s))\,\differential s=x\_{T}(T).
We can then define without ambiguity

|  |  |  |
| --- | --- | --- |
|  | xâ€‹(t)={xTâ€‹(t)Â ifÂ â€‹tâ‰¤T,x~â€‹(t)Â ifÂ â€‹tâ‰¥Tx(t)=\begin{cases}x\_{T}(t)&\text{ if }t\leq T,\\ \widetilde{x}(t)&\text{ if }t\geq T\end{cases} |  |

which is a continuous function and is, by construction, a solution of (Ek,f,g)(E\_{k,f,g}) on [0,T+Îµ][0,T+\varepsilon].

It remains to proveÂ ([52](https://arxiv.org/html/2601.03215v1#A3.E52 "In Theorem C.2. â€£ C.1 Definition and main results. â€£ Appendix C Study of a nonlinear Volterra equation â€£ Trading with market resistance and concave price impact")). Consider f1,f2f\_{1},f\_{2} two bounded functions on [0,T+Îµ][0,T+\varepsilon] and let x1x\_{1} and x2x\_{2} be the solutions of (Ek,f1,g)(E\_{k,f\_{1},g}) and (Ek,f2,g)(E\_{k,f\_{2},g}) respectively. Therefore, restricting the solutions on [0,T][0,T], we know from the initial assumption that there exists a positive constant CTC\_{T} such that

|  |  |  |
| --- | --- | --- |
|  | suptâ‰¤T|x1â€‹(t)âˆ’x2â€‹(t)|â‰¤CTâ€‹suptâ‰¤T|f1â€‹(t)âˆ’f2â€‹(t)|.\sup\_{t\leq T}|x\_{1}(t)-x\_{2}(t)|\leq C\_{T}\sup\_{t\leq T}|f\_{1}(t)-f\_{2}(t)|. |  |

Now, we define f~1\widetilde{f}\_{1} and f~2\widetilde{f}\_{2} for tâˆˆ[T,T+Îµ]t\in[T,T+\varepsilon] by

|  |  |  |  |
| --- | --- | --- | --- |
|  | f~1â€‹(t)\displaystyle\widetilde{f}\_{1}(t) | =f1â€‹(t)âˆ’âˆ«0Tkâ€‹(tâˆ’s)â€‹gâ€‹(x1â€‹(s))â€‹ds,\displaystyle=f\_{1}(t)-\int\_{0}^{T}k(t-s)g\big(x\_{1}(s)\big)\,\differential s, |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  | f~2â€‹(t)\displaystyle\widetilde{f}\_{2}(t) | =f2â€‹(t)âˆ’âˆ«0Tkâ€‹(tâˆ’s)â€‹gâ€‹(x2â€‹(s))â€‹ds\displaystyle=f\_{2}(t)-\int\_{0}^{T}k(t-s)g\big(x\_{2}(s)\big)\,\differential s |  |

so that

|  |  |  |
| --- | --- | --- |
|  | (x1â€‹(t))Tâ‰¤tâ‰¤T+Îµ=(I+ğ’¯)âˆ’1â€‹f~1,(x2â€‹(t))Tâ‰¤tâ‰¤T+Îµ=(I+ğ’¯)âˆ’1â€‹f~2.\begin{split}(x\_{1}(t))\_{T\leq t\leq T+\varepsilon}&=(I+\mathcal{T})^{-1}\widetilde{f}\_{1},\\ (x\_{2}(t))\_{T\leq t\leq T+\varepsilon}&=(I+\mathcal{T})^{-1}\widetilde{f}\_{2}.\end{split} |  |

We then conclude using that (I+ğ’¯)âˆ’1(I+\mathcal{T})^{-1} is 22-Lipschitz and that

|  |  |  |  |
| --- | --- | --- | --- |
|  | |f~1â€‹(t)âˆ’f~2â€‹(t)|\displaystyle|\widetilde{f}\_{1}(t)-\widetilde{f}\_{2}(t)| | â‰¤|f1â€‹(t)âˆ’f2â€‹(t)|+|âˆ«0Tkâ€‹(tâˆ’s)â€‹gâ€‹(x1â€‹(s))â€‹dsâˆ’âˆ«0Tkâ€‹(tâˆ’s)â€‹gâ€‹(x2â€‹(s))â€‹ds|\displaystyle\leq|f\_{1}(t)-f\_{2}(t)|+\bigg|\int\_{0}^{T}k(t-s)g\big(x\_{1}(s)\big)\differential s-\int\_{0}^{T}k(t-s)g\big(x\_{2}(s)\big)\differential s\bigg| |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | â‰¤|f1â€‹(t)âˆ’f2â€‹(t)|+|âˆ«0Tkâ€‹(tâˆ’s)â€‹gâ€‹(x1â€‹(s))â€‹dsâˆ’âˆ«0Tkâ€‹(tâˆ’s)â€‹gâ€‹(x2â€‹(s))â€‹ds|\displaystyle\leq|f\_{1}(t)-f\_{2}(t)|+\bigg|\int\_{0}^{T}k(t-s)g\big(x\_{1}(s)\big)\,\differential s-\int\_{0}^{T}k(t-s)g\big(x\_{2}(s)\big)\differential s\bigg| |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | â‰¤â€–f1âˆ’f2â€–âˆ+Lâ€‹â€–x1âˆ’x2â€–âˆâ€‹|âˆ«0Tkâ€‹(tâˆ’s)â€‹ds|\displaystyle\leq\norm{f\_{1}-f\_{2}}\_{\infty}+L\norm{x\_{1}-x\_{2}}\_{\infty}\bigg|\int\_{0}^{T}k(t-s)\differential s\bigg| |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | â‰¤â€–f1âˆ’f2â€–âˆâ€‹(1+Lâ€‹âˆ«0Tkâ€‹(tâˆ’s)â€‹ds).\displaystyle\leq\norm{f\_{1}-f\_{2}}\_{\infty}\bigg(1+L\int\_{0}^{T}k(t-s)\differential s\bigg). |  |

## Appendix D Properties of the market resistance rur^{u}

### D.1 Proof of LemmaÂ [3.2](https://arxiv.org/html/2601.03215v1#S3.Thmtheorem2 "Lemma 3.2. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")

We first state the following lemma which follows directly from TheoremÂ [C.2](https://arxiv.org/html/2601.03215v1#A3.Thmtheorem2 "Theorem C.2. â€£ C.1 Definition and main results. â€£ Appendix C Study of a nonlinear Volterra equation â€£ Trading with market resistance and concave price impact").

###### Lemma D.1.

Suppose that ğ’°\mathcal{U} is Lipschitz continuous with linear growth. For each Tâ‰¥0T\geq 0, there exists an operator ğ‘T:ğ’â€‹([0,T])â†’ğ’â€‹([0,T])\mathbf{R}\_{T}:\mathcal{C}([0,T])\to\mathcal{C}([0,T]) such that for each f:[0,T]â†’â„f:[0,T]\to\mathbb{R}, the function râ€‹(s)=(ğ‘Tâ€‹f)â€‹(s)r(s)=(\mathbf{R}\_{T}f)(s) is the unique solution of

|  |  |  |  |
| --- | --- | --- | --- |
|  | râ€‹(t)=ğ’°â€‹(fâ€‹(t)âˆ’âˆ«0tGâ€‹(tâˆ’s)â€‹râ€‹(s)â€‹ds).r(t)=\mathcal{U}\bigg(f(t)-\int\_{0}^{t}G(t-s)r(s)\differential s\bigg). |  | (53) |

Moreover, ğ‘T\mathbf{R}\_{T} is Lipschitz continuous on ğ’â€‹([0,t])\mathcal{C}([0,t]) and its Lipschitz constant depends only on GG, TT and on the Lipschitz constant of ğ’°\mathcal{U}.

###### Proof.

First note that if rr is a solution ofÂ ([53](https://arxiv.org/html/2601.03215v1#A4.E53 "In Lemma D.1. â€£ D.1 Proof of Lemma 3.2 â€£ Appendix D Properties of the market resistance ğ‘Ÿ^ğ‘¢ â€£ Trading with market resistance and concave price impact")), then xâ€‹(t)=fâ€‹(t)âˆ’âˆ«0tGâ€‹(tâˆ’s)â€‹râ€‹(s)â€‹dsx(t)=f(t)-\int\_{0}^{t}G(t-s)r(s)\differential s is solution of (Ek,f,ğ’°)(E\_{k,f,\mathcal{U}}). Therefore TheoremÂ [C.2](https://arxiv.org/html/2601.03215v1#A3.Thmtheorem2 "Theorem C.2. â€£ C.1 Definition and main results. â€£ Appendix C Study of a nonlinear Volterra equation â€£ Trading with market resistance and concave price impact") ensures that the solution ofÂ ([53](https://arxiv.org/html/2601.03215v1#A4.E53 "In Lemma D.1. â€£ D.1 Proof of Lemma 3.2 â€£ Appendix D Properties of the market resistance ğ‘Ÿ^ğ‘¢ â€£ Trading with market resistance and concave price impact")) is unique. Moreover, if xx is a solution of (Ek,f,ğ’°)(E\_{k,f,\mathcal{U}}), then râ€‹(t)=ğ’°â€‹(xâ€‹(t))r(t)=\mathcal{U}(x(t)) is clearly a solution ofÂ ([53](https://arxiv.org/html/2601.03215v1#A4.E53 "In Lemma D.1. â€£ D.1 Proof of Lemma 3.2 â€£ Appendix D Properties of the market resistance ğ‘Ÿ^ğ‘¢ â€£ Trading with market resistance and concave price impact")). This ensures that we can define an operator ğ‘T:ğ’â€‹([0,T])â†’ğ’â€‹([0,T])\mathbf{R}\_{T}:\mathcal{C}([0,T])\to\mathcal{C}([0,T]) as prescribed in LemmaÂ [D.1](https://arxiv.org/html/2601.03215v1#A4.Thmtheorem1 "Lemma D.1. â€£ D.1 Proof of Lemma 3.2 â€£ Appendix D Properties of the market resistance ğ‘Ÿ^ğ‘¢ â€£ Trading with market resistance and concave price impact"). The Lipschitz property of ğ‘T\mathbf{R}\_{T} follows directly fromÂ ([52](https://arxiv.org/html/2601.03215v1#A3.E52 "In Theorem C.2. â€£ C.1 Definition and main results. â€£ Appendix C Study of a nonlinear Volterra equation â€£ Trading with market resistance and concave price impact")).
âˆ

To use this result, note that since uâˆˆâ„’2u\in\mathcal{L}^{2}, the function u.â€‹(Ï‰)u\_{.}(\omega) is in L2L^{2} for almost all Ï‰âˆˆÎ©\omega\in\Omega. Fix now Ï‰âˆˆÎ©\omega\in\Omega such that it is the case. Then we know that fâ€‹(Ï‰)=ğ†â€‹uâ€‹(Ï‰)f(\omega)=\mathbf{G}u(\omega) is a continuous function and thus using LemmaÂ [D.1](https://arxiv.org/html/2601.03215v1#A4.Thmtheorem1 "Lemma D.1. â€£ D.1 Proof of Lemma 3.2 â€£ Appendix D Properties of the market resistance ğ‘Ÿ^ğ‘¢ â€£ Trading with market resistance and concave price impact"), we can define ruâ€‹(Ï‰)=ğ‘Tâ€‹fâ€‹(Ï‰)r^{u}(\omega)=\mathbf{R}\_{T}f(\omega) which is solution of

|  |  |  |
| --- | --- | --- |
|  | rtuâ€‹(Ï‰)=ğ’°â€‹(ğ†â€‹(uâ€‹(Ï‰)âˆ’ruâ€‹(Ï‰))t).r^{u}\_{t}(\omega)=\mathcal{U}\Big(\mathbf{G}\big(u(\omega)-r^{u}(\omega)\big)\_{t}\Big). |  |

Since this is done for almost all Ï‰\omega, this allows us to build a stochastic process rur^{u}. Note that by construction, this process is almost surely continuous. Moreover, it is also adapted, seeing that for each tâˆˆ[0,T]t\in[0,T], we have

|  |  |  |
| --- | --- | --- |
|  | (rsuâ€‹(Ï‰))0â‰¤sâ‰¤t=ğ‘tâ€‹fâ€‹(Ï‰)=ğ‘tâ€‹ğ†â€‹uâ€‹(Ï‰)\big(r^{u}\_{s}(\omega)\big)\_{0\leq s\leq t}=\mathbf{R}\_{t}f(\omega)=\mathbf{R}\_{t}\mathbf{G}u(\omega) |  |

and ğ‘tâ€‹ğ†â€‹uâ€‹(Ï‰)\mathbf{R}\_{t}\mathbf{G}u(\omega) is â„±t\mathcal{F}\_{t}-measurable because (us)sâ‰¤t(u\_{s})\_{s\leq t} is â„±t\mathcal{F}\_{t}-measurable and ğ†\mathbf{G} is non-anticipative. Thus rur^{u} is adapted and continuous, and therefore it is progressively measurable.

It remains to prove that this process belongs to â„’2\mathcal{L}^{2}. First, note that ğ‘Tâ€‹0=0\mathbf{R}\_{T}0=0 because ğ’°â€‹(0)=0\mathcal{U}(0)=0. Then, the Lipschitz property of ğ‘T\mathbf{R}\_{T} ensures that

|  |  |  |
| --- | --- | --- |
|  | suptâ‰¤T|rtu|â‰¤Câ€‹suptâ‰¤T|ğ†â€‹ut|\sup\_{t\leq T}|r^{u}\_{t}|\leq C\sup\_{t\leq T}|\mathbf{G}u\_{t}| |  |

for some constant CC depending only on the Lipschitz constant of ğ’°\mathcal{U}, TT and on GG. Using Youngâ€™s convolution inequality, we obtain

|  |  |  |
| --- | --- | --- |
|  | suptâ‰¤T|ğ†â€‹ut|â‰¤â€–Gâ€–L2â€‹([0,T])â€‹â€–uâ€–L2â€‹([0,T]).\sup\_{t\leq T}|\mathbf{G}u\_{t}|\leq\norm{G}\_{L^{2}([0,T])}\norm{u}\_{L^{2}([0,T])}. |  |

and therefore

|  |  |  |
| --- | --- | --- |
|  | ğ”¼â€‹[â€–ruâ€–L22]â‰¤C2â€‹Tâ€‹â€–Gâ€–L2â€‹([0,T])2â€‹ğ”¼â€‹[â€–uâ€–L22]\mathbb{E}\Big[\norm{r^{u}}\_{L^{2}}^{2}\Big]\leq C^{2}T\norm{G}\_{L^{2}([0,T])}^{2}\mathbb{E}[\norm{u}\_{L^{2}}^{2}] |  |

which is finite because GâˆˆL2â€‹([0,T])G\in L^{2}([0,T]) and ğ”¼â€‹[â€–uâ€–L22]<âˆ\mathbb{E}[\norm{u}\_{L^{2}}^{2}]<\infty as uâˆˆâ„’2u\in\mathcal{L}^{2}.

### D.2 Proof of LemmaÂ [3.4](https://arxiv.org/html/2601.03215v1#S3.Thmtheorem4 "Lemma 3.4. â€£ 3.3 The general case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")

The proof of LemmaÂ [3.4](https://arxiv.org/html/2601.03215v1#S3.Thmtheorem4 "Lemma 3.4. â€£ 3.3 The general case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact") is based on the implicit function theorem recalled in TheoremÂ [B.8](https://arxiv.org/html/2601.03215v1#A2.Thmtheorem8 "Theorem B.8 (Implicit function theorem). â€£ B.3 FrÃ©chet differentiability â€£ Appendix B Mathematical tools â€£ Trading with market resistance and concave price impact"). We apply this to study the FrÃ©chet differentiability of uâ†¦ruu\mapsto r^{u}. For each uâˆˆâ„’2u\in\mathcal{L}^{2}, recall LemmaÂ [3.2](https://arxiv.org/html/2601.03215v1#S3.Thmtheorem2 "Lemma 3.2. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact") yields the existence and uniqueness of ruâˆˆâ„’2r^{u}\in\mathcal{L}^{2} such that

|  |  |  |
| --- | --- | --- |
|  | rtu=ğ’°â€‹((ğ†2â€‹(uâˆ’ru))t),r\_{t}^{u}=\mathcal{U}\Big(\big(\mathbf{G}\_{2}(u-r^{u})\big)\_{t}\Big), |  |

defining unambiguously the operator ğ‘\mathbf{R} such that ru=ğ‘â€‹(u)r^{u}=\mathbf{R}(u). Let us introduce the operator ğ“:â„’2Ã—â„’2â†’â„’2\mathbf{T}:\mathcal{L}^{2}\times\mathcal{L}^{2}\to\mathcal{L}^{2} by

|  |  |  |
| --- | --- | --- |
|  | ğ“â€‹(u,r):=râˆ’ğ’°â€‹(ğ†â€‹(uâˆ’r)),u,râˆˆâ„’2,\mathbf{T}(u,r):=r-\mathcal{U}\big(\mathbf{G}(u-r)\big),\quad u,r\in\mathcal{L}^{2}, |  |

so that we always have

|  |  |  |  |
| --- | --- | --- | --- |
|  | ğ“â€‹(u,ğ‘â€‹(u))=0,uâˆˆâ„’2.\mathbf{T}\big(u,\mathbf{R}(u)\big)=0,\quad u\in\mathcal{L}^{2}. |  | (54) |

We want to apply the implicit function theorem to the operator ğ“\mathbf{T} to get the FrÃ©chet differentiability of ğ‘\mathbf{R}. First we need to check that ğ“\mathbf{T} is FrÃ©chet differentiable, which is the case, since ğ’°\mathcal{U} is differentiable, by composition of FrÃ©chet differentiable functions. Moreover, explicit computations show that

|  |  |  |
| --- | --- | --- |
|  | Dâ€‹ğ“â€‹(u,r)â€‹(s,v)=vâˆ’ğ’°â€²â€‹(ğ†â€‹(uâˆ’r))â€‹ğ†â€‹(sâˆ’v),s,vâˆˆâ„’2.D\mathbf{T}(u,r)(s,v)=v-\mathcal{U}^{\prime}(\mathbf{G}(u-r))\mathbf{G}(s-v),\quad s,v\in\mathcal{L}^{2}. |  |

Finally, when uu is fixed in â„’2\mathcal{L}^{2}, then

|  |  |  |
| --- | --- | --- |
|  | vâ†¦Dâ€‹ğ“â€‹(u,ğ‘â€‹(u))â€‹(0,v)=v+ğ’°â€²â€‹(ğ†â€‹(uâˆ’ğ‘â€‹(u)))â€‹ğ†â€‹vv\mapsto D\mathbf{T}\big(u,\mathbf{R}(u)\big)(0,v)=v+\mathcal{U}^{\prime}\Big(\mathbf{G}\big(u-\mathbf{R}(u)\big)\Big)\mathbf{G}v |  |

which is a Banach space isomorphism from â„’2\mathcal{L}^{2} onto â„’2\mathcal{L}^{2}. Concretely, we check that for each process wâˆˆâ„’2w\in\mathcal{L}^{2}, there exists a process yâˆˆâ„’2y\in\mathcal{L}^{2} such that

|  |  |  |  |
| --- | --- | --- | --- |
|  | y+ğ’°â€²â€‹(ğ†â€‹(uâˆ’ru))â€‹ğ†â€‹y=w.y+\mathcal{U}^{\prime}(\mathbf{G}(u-r^{u}))\mathbf{G}y=w. |  | (55) |

The existence and uniqueness of a stochastic process vv satisfyingÂ ([55](https://arxiv.org/html/2601.03215v1#A4.E55 "In D.2 Proof of Lemma 3.4 â€£ Appendix D Properties of the market resistance ğ‘Ÿ^ğ‘¢ â€£ Trading with market resistance and concave price impact")) is guaranteed by the following lemma.

###### Lemma D.2.

For each Tâ‰¥0T\geq 0, there exists a continuous operator ğ˜T:ğ’â€‹([0,T])Ã—L2â€‹([0,T])â†’L2â€‹([0,T])\mathbf{Y}\_{T}:\mathcal{C}([0,T])\times L^{2}([0,T])\to L^{2}([0,T]) such that for each continuous function ff on [0,T][0,T] and each gg in L2â€‹([0,T])L^{2}([0,T]), yâ€‹(t)=ğ˜Tâ€‹(f,g)â€‹(t)y(t)=\mathbf{Y}\_{T}(f,g)(t) is solution of

|  |  |  |  |
| --- | --- | --- | --- |
|  | yâ€‹(t)+fâ€‹(t)â€‹ğ†â€‹yâ€‹(t)=gâ€‹(t).y(t)+f(t)\mathbf{G}y(t)=g(t). |  | (56) |

Moreover, the solution yy ofÂ ([56](https://arxiv.org/html/2601.03215v1#A4.E56 "In Lemma D.2. â€£ D.2 Proof of Lemma 3.4 â€£ Appendix D Properties of the market resistance ğ‘Ÿ^ğ‘¢ â€£ Trading with market resistance and concave price impact")) is unique and there exists a deterministic function Ïˆ:[0,âˆ)â†’[0,âˆ)\psi:[0,\infty)\to[0,\infty) such that we have

|  |  |  |  |
| --- | --- | --- | --- |
|  | â€–yâ€–L2â€‹([0,T])â‰¤Ïˆâ€‹(â€–fâ€–Lâˆ)â€‹â€–gâ€–L2â€‹([0,T]).\norm{y}\_{L^{2}([0,T])}\leq\psi(\norm{f}\_{L^{\infty}})\norm{g}\_{L^{2}([0,T])}. |  | (57) |

Note that â„™\mathbb{P}-almost all Ï‰\omega, the function fâ€‹(t)=ğ’°â€²â€‹(ğ†â€‹(uâˆ’ru)â€‹(Ï‰,t))f(t)=\mathcal{U}^{\prime}(\mathbf{G}(u-r^{u})(\omega,t)) is continuous on [0,T][0,T], bounded by â€–ğ’°â€–Lâˆ\|\mathcal{U}\|\_{L^{\infty}}, and g=w(Ï‰,.)g=w(\omega,.) is well in L2â€‹([0,T])L^{2}([0,T]). Therefore, the stochastic process vv defined on [0,T][0,T] by

|  |  |  |
| --- | --- | --- |
|  | vâ€‹(Ï‰,t)=ğ˜Tâ€‹(ğ’°â€²â€‹(ğ†â€‹(uâ€‹(Ï‰,â‹…)âˆ’ğ‘â€‹(u)â€‹(Ï‰,â‹…))),wâ€‹(Ï‰,â‹…))â€‹(t)v(\omega,t)=\mathbf{Y}\_{T}\bigg(\mathcal{U}^{\prime}\Big(\mathbf{G}\big(u(\omega,\cdot)-\mathbf{R}(u)(\omega,\cdot)\big)\Big),w(\omega,\cdot)\bigg)(t) |  |

is the unique solution ofÂ ([57](https://arxiv.org/html/2601.03215v1#A4.E57 "In Lemma D.2. â€£ D.2 Proof of Lemma 3.4 â€£ Appendix D Properties of the market resistance ğ‘Ÿ^ğ‘¢ â€£ Trading with market resistance and concave price impact")) for the specified function ff and gg. Furthermore, for each tt, vâ€‹(â‹…,t)v(\cdot,t) is measurable as the composition of measurable mappings. Using the same arguments as in SectionÂ [D.1](https://arxiv.org/html/2601.03215v1#A4.SS1 "D.1 Proof of Lemma 3.2 â€£ Appendix D Properties of the market resistance ğ‘Ÿ^ğ‘¢ â€£ Trading with market resistance and concave price impact"), we see that the stochastic process vâ€‹(Ï‰,â‹…)v(\omega,\cdot) is adapted. In fact, for each 0â‰¤tâ‰¤T0\leq t\leq T, we have

|  |  |  |
| --- | --- | --- |
|  | (vâ€‹(Ï‰,s))0â‰¤sâ‰¤t=ğ˜tâ€‹((ğ’°â€²â€‹(ğ†â€‹uâ€‹(Ï‰,s)âˆ’ğ†ğ‘â€‹(u)â€‹(Ï‰,s)))0â‰¤sâ‰¤t,(wâ€‹(Ï‰,s))0â‰¤sâ‰¤t)\big(v(\omega,s)\big)\_{0\leq s\leq t}=\mathbf{Y}\_{t}\bigg(\Big(\mathcal{U}^{\prime}\big(\mathbf{G}u(\omega,s)-\mathbf{G}\mathbf{R}(u)(\omega,s)\big)\Big)\_{0\leq s\leq t},\big(w(\omega,s)\big)\_{0\leq s\leq t}\bigg) |  |

by uniqueness of the solution ofÂ ([56](https://arxiv.org/html/2601.03215v1#A4.E56 "In Lemma D.2. â€£ D.2 Proof of Lemma 3.4 â€£ Appendix D Properties of the market resistance ğ‘Ÿ^ğ‘¢ â€£ Trading with market resistance and concave price impact")).
The right-hand side of this identity is â„±t\mathcal{F}\_{t}-measurable because ğ†â€‹u\mathbf{G}u, ğ†ğ‘â€‹(u)\mathbf{G}\mathbf{R}(u) and ww are adapted, and because ğ˜t\mathbf{Y}\_{t} is a continuous application. This means that the left hand side is also â„±t\mathcal{F}\_{t}-measurable, and in particular vâ€‹(Ï‰,t)v(\omega,t) is â„±t\mathcal{F}\_{t}-measurable, implicating that vv is adapted, Moreover, since it is continuous almost surely by construction, it is also progressively measurable. UsingÂ ([57](https://arxiv.org/html/2601.03215v1#A4.E57 "In Lemma D.2. â€£ D.2 Proof of Lemma 3.4 â€£ Appendix D Properties of the market resistance ğ‘Ÿ^ğ‘¢ â€£ Trading with market resistance and concave price impact")), we know that

|  |  |  |
| --- | --- | --- |
|  | â€–vâ€–L2â‰¤Ïˆâ€‹(â€–ğ’°â€²â€–Lâˆ)â€‹â€–wâ€–L2\norm{v}\_{L^{2}}\leq\psi(\norm{\mathcal{U}^{\prime}}\_{L^{\infty}})\norm{w}\_{L^{2}} |  |

almost surely, and since ğ’°â€²\mathcal{U}^{\prime} is deterministic and bounded we get

|  |  |  |
| --- | --- | --- |
|  | â€–vâ€–â„’2â‰¤Ïˆâ€‹(â€–ğ’°â€²â€–Lâˆ)â€‹â€–wâ€–â„’2\norm{v}\_{\mathcal{L}^{2}}\leq\psi(\norm{\mathcal{U}^{\prime}}\_{L^{\infty}})\norm{w}\_{\mathcal{L}^{2}} |  |

which ensures that vâˆˆâ„’2v\in\mathcal{L}^{2}. Finally, the implicit function theorem from TheoremÂ [B.8](https://arxiv.org/html/2601.03215v1#A2.Thmtheorem8 "Theorem B.8 (Implicit function theorem). â€£ B.3 FrÃ©chet differentiability â€£ Appendix B Mathematical tools â€£ Trading with market resistance and concave price impact") applies, which shows that ğ‘\mathbf{R} is FrÃ©chet differentiable. It remains to explicitly compute Dâ€‹ğ‘D\mathbf{R} to conclude the proof of LemmaÂ [3.4](https://arxiv.org/html/2601.03215v1#S3.Thmtheorem4 "Lemma 3.4. â€£ 3.3 The general case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact"). DifferentiatingÂ ([54](https://arxiv.org/html/2601.03215v1#A4.E54 "In D.2 Proof of Lemma 3.4 â€£ Appendix D Properties of the market resistance ğ‘Ÿ^ğ‘¢ â€£ Trading with market resistance and concave price impact")), we see that Dâ€‹ğ‘D\mathbf{R} must satisfy

|  |  |  |
| --- | --- | --- |
|  | Dâ€‹ğ’¯â€‹(u,ğ‘â€‹(u))â€‹(v,Dâ€‹ğ‘â€‹(v))=0,D\mathcal{T}\big(u,\mathbf{R}(u)\big)\big(v,D\mathbf{R}(v)\big)=0, |  |

and therefore

|  |  |  |
| --- | --- | --- |
|  | Dâ€‹ğ‘â€‹(u)â€‹(v)=ğ’°â€²â€‹(ğ†â€‹(uâˆ’ğ‘â€‹(u)))â€‹ğ†â€‹(vâˆ’Dâ€‹ğ‘â€‹(u)â€‹(v)).D\mathbf{R}(u)(v)=\mathcal{U}^{\prime}\Big(\mathbf{G}\big(u-\mathbf{R}(u)\big)\Big)\mathbf{G}\big(v-D\mathbf{R}(u)(v)\big). |  |

Finally, we have

|  |  |  |  |
| --- | --- | --- | --- |
|  | Dâ€‹ğ‘â€‹(u)\displaystyle D\mathbf{R}(u) | =(ğˆ+ğ’°â€²â€‹(ğ†â€‹(uâˆ’ğ‘â€‹(u)))â€‹ğ†)âˆ’1â€‹ğ’°â€²â€‹(ğ†â€‹(uâˆ’ğ‘â€‹(u)))â€‹ğ†\displaystyle=\bigg(\mathbf{I}+\mathcal{U}^{\prime}\Big(\mathbf{G}\big(u-\mathbf{R}(u)\big)\Big)\mathbf{G}\bigg)^{-1}\mathcal{U}^{\prime}\Big(\mathbf{G}\big(u-\mathbf{R}(u)\big)\Big)\mathbf{G} |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | =ğˆâˆ’(ğˆ+ğ’°â€²â€‹(ğ†â€‹(uâˆ’ğ‘â€‹(u)))â€‹ğ†)âˆ’1.\displaystyle=\mathbf{I}-\bigg(\mathbf{I}+\mathcal{U}^{\prime}\Big(\mathbf{G}\big(u-\mathbf{R}(u)\big)\Big)\mathbf{G}\bigg)^{-1}. |  |

### D.3 Poof of LemmaÂ [D.2](https://arxiv.org/html/2601.03215v1#A4.Thmtheorem2 "Lemma D.2. â€£ D.2 Proof of Lemma 3.4 â€£ Appendix D Properties of the market resistance ğ‘Ÿ^ğ‘¢ â€£ Trading with market resistance and concave price impact")

The proof of LemmaÂ [D.2](https://arxiv.org/html/2601.03215v1#A4.Thmtheorem2 "Lemma D.2. â€£ D.2 Proof of Lemma 3.4 â€£ Appendix D Properties of the market resistance ğ‘Ÿ^ğ‘¢ â€£ Trading with market resistance and concave price impact") is split into two parts. In the first part, we fix a continuous function ff on [0,T][0,T] and prove thatÂ ([56](https://arxiv.org/html/2601.03215v1#A4.E56 "In Lemma D.2. â€£ D.2 Proof of Lemma 3.4 â€£ Appendix D Properties of the market resistance ğ‘Ÿ^ğ‘¢ â€£ Trading with market resistance and concave price impact")) admits a solution yy for each continuous function gg on [0,T][0,T] and that the mapping gâ†¦yg\mapsto y is Lispchitz continuous with a Lipschitz constant that only depends on â€–fâ€–Lâˆ\norm{f}\_{L^{\infty}}. In the second part of the proof, we show this can be used to conclude that the mapping ğ˜T\mathbf{Y}\_{T} is continuous.

Step 1. Suppose that ff is a continuous function on [0,T][0,T]. We introduce Îµ>0\varepsilon>0 small enough so that

|  |  |  |
| --- | --- | --- |
|  | â€–fâ€–L2â€‹âˆ«0ÎµGâ€‹(s)â€‹dsâ‰¤12.\norm{f}\_{L^{2}}\int\_{0}^{\varepsilon}G(s)\,\differential s\leq\frac{1}{2}. |  |

Similarly to the proof of TheoremÂ [C.2](https://arxiv.org/html/2601.03215v1#A3.Thmtheorem2 "Theorem C.2. â€£ C.1 Definition and main results. â€£ Appendix C Study of a nonlinear Volterra equation â€£ Trading with market resistance and concave price impact"), we can prove that the equationÂ ([56](https://arxiv.org/html/2601.03215v1#A4.E56 "In Lemma D.2. â€£ D.2 Proof of Lemma 3.4 â€£ Appendix D Properties of the market resistance ğ‘Ÿ^ğ‘¢ â€£ Trading with market resistance and concave price impact")) can be solved uniquely on [0,Îµ][0,\varepsilon]. Moreover, the mapping ğ•Îµf\mathbf{V}\_{\varepsilon}^{f} defined such that for each continuous function gg, y=ğ•Îµfâ€‹gy=\mathbf{V}\_{\varepsilon}^{f}g is the unique solution ofÂ [C.2](https://arxiv.org/html/2601.03215v1#A3.Thmtheorem2 "Theorem C.2. â€£ C.1 Definition and main results. â€£ Appendix C Study of a nonlinear Volterra equation â€£ Trading with market resistance and concave price impact"), is 22-Lipschitz continuous on L2â€‹([0,Îµ])L^{2}([0,\varepsilon]). Following again the proof of TheoremÂ [C.2](https://arxiv.org/html/2601.03215v1#A3.Thmtheorem2 "Theorem C.2. â€£ C.1 Definition and main results. â€£ Appendix C Study of a nonlinear Volterra equation â€£ Trading with market resistance and concave price impact"), we see that we can then extend this solution to a solution on [0,T][0,T]. Furthermore, if we define ğ•tf\mathbf{V}\_{t}^{f} as ğ•Îµf\mathbf{V}\_{\varepsilon}^{f} on L2â€‹([0,t])L^{2}([0,t]) instead of L2â€‹([0,Îµ])L^{2}([0,\varepsilon]), we see that ğ•tf\mathbf{V}\_{t}^{f} is LtL\_{t}-Lipschitz continuous on L2â€‹([0,t])L^{2}([0,t]) for some Lt>0L\_{t}>0. Repeating the computations of the proof of TheoremÂ [C.2](https://arxiv.org/html/2601.03215v1#A3.Thmtheorem2 "Theorem C.2. â€£ C.1 Definition and main results. â€£ Appendix C Study of a nonlinear Volterra equation â€£ Trading with market resistance and concave price impact"), we can check that for each 0â‰¤tâ‰¤Tâˆ’Îµ0\leq t\leq T-\varepsilon, we have

|  |  |  |
| --- | --- | --- |
|  | Lt+Îµâ‰¤2â€‹(1+â€–fâ€–âˆâ€‹âˆ«0TGâ€‹(s)â€‹dsâ€‹Lt).L\_{t+\varepsilon}\leq 2\bigg(1+\norm{f}\_{\infty}\int\_{0}^{T}G(s)\differential sL\_{t}\bigg). |  |

By induction, we deduce that

|  |  |  |
| --- | --- | --- |
|  | LTâ‰¤2â€‹âˆ‘k=0nbkL\_{T}\leq 2\sum\_{k=0}^{n}b^{k} |  |

where b=2â€‹â€–fâ€–âˆâ€‹âˆ«0TGâ€‹(s)â€‹dsb=2\norm{f}\_{\infty}\int\_{0}^{T}G(s)\differential s and n=âŒŠT/ÎµâŒ‹n=\lfloor T/\varepsilon\rfloor. Therefore, we deduce that there exists an increasing function Ïˆ\psi such that ğ•Tf\mathbf{V}\_{T}^{f} is Ïˆâ€‹(â€–fâ€–âˆ)\psi(\norm{f}\_{\infty})-Lipschitz continuous. In particular, we obtain that for each continuous function gg, we have

|  |  |  |
| --- | --- | --- |
|  | â€–ğ•Tfâ€‹gâ€–L2â€‹([0,T])â‰¤Ïˆâ€‹(â€–fâ€–Lâˆâ€‹([0,T]))â€‹â€–gâ€–L2â€‹([0,T])\norm{\mathbf{V}\_{T}^{f}g}\_{L^{2}([0,T])}\leq\psi(\norm{f}\_{L^{\infty}([0,T])})\norm{g}\_{L^{2}([0,T])} |  |

because ğ•Tfâ€‹(0)=0\mathbf{V}\_{T}^{f}(0)=0, which provesÂ ([57](https://arxiv.org/html/2601.03215v1#A4.E57 "In Lemma D.2. â€£ D.2 Proof of Lemma 3.4 â€£ Appendix D Properties of the market resistance ğ‘Ÿ^ğ‘¢ â€£ Trading with market resistance and concave price impact")).

Step 2. Using the results of the first step, we see that we can always take

|  |  |  |
| --- | --- | --- |
|  | ğ˜Tâ€‹(f,g)=ğ•Tfâ€‹g.\mathbf{Y}\_{T}(f,g)=\mathbf{V}\_{T}^{f}g. |  |

It remains to prove that this application is continuous. To do this, we prove that for M>0M>0, ğ˜T\mathbf{Y}\_{T} is Lipschitz-continuous on â„¬ğ’â€‹([0,T])â€‹(0,M)Ã—â„¬L2â€‹([0,T])â€‹(0,M)\mathcal{B}\_{\mathcal{C}([0,T])}(0,M)\times\mathcal{B}\_{L^{2}([0,T])}(0,M) where â„¬Eâ€‹(x,Ïµ)\mathcal{B}\_{E}(x,\epsilon) denotes the ball in EE centered in xx with radius Ïµ\epsilon. From the first step, we know that if fâˆˆâ„¬ğ’â€‹([0,T])â€‹(0,M)f\in\mathcal{B}\_{\mathcal{C}([0,T])}(0,M), the application gâ†¦ğ˜Tâ€‹(f,g)g\mapsto\mathbf{Y}\_{T}(f,g) is Ïˆâ€‹(M)\psi(M)-Lipschitz continuous. Now let f1f\_{1} and f2f\_{2} be two continuous functions bounded by MM and let gâˆˆL2â€‹([0,T])g\in L^{2}([0,T]) with â€–gâ€–L2â€‹([0,T])â‰¤M\norm{g}\_{L^{2}([0,T])}\leq M. We write yi=ğ˜Tâ€‹(fi,g)y\_{i}=\mathbf{Y}\_{T}(f\_{i},g). By definition, we have for all 0â‰¤tâ‰¤T0\leq t\leq T

|  |  |  |
| --- | --- | --- |
|  | y2â€‹(t)+f2â€‹(t)â€‹ğ†â€‹y2â€‹(t)=gâ€‹(t)y\_{2}(t)+f\_{2}(t)\mathbf{G}y\_{2}(t)=g(t) |  |

which is equivalent to

|  |  |  |
| --- | --- | --- |
|  | y2â€‹(t)+f1â€‹(t)â€‹ğ†â€‹y2â€‹(t)=gâ€‹(t)âˆ’(f2â€‹(t)âˆ’f1â€‹(t))â€‹ğ†â€‹y2â€‹(t).y\_{2}(t)+f\_{1}(t)\mathbf{G}y\_{2}(t)=g(t)-(f\_{2}(t)-f\_{1}(t))\mathbf{G}y\_{2}(t). |  |

Therefore, we have

|  |  |  |
| --- | --- | --- |
|  | y2=ğ˜Tâ€‹(f1,gâˆ’(f2âˆ’f1)â€‹ğ†â€‹y2).y\_{2}=\mathbf{Y}\_{T}(f\_{1},g-(f\_{2}-f\_{1})\mathbf{G}y\_{2}). |  |

This implies in particular that

|  |  |  |  |
| --- | --- | --- | --- |
|  | â€–y2âˆ’y1â€–L2â€‹([0,T])\displaystyle\norm{y\_{2}-y\_{1}}\_{L^{2}([0,T])} | â‰¤â€–ğ˜Tâ€‹(f1,gâˆ’(f2âˆ’f1)â€‹ğ†â€‹y2)âˆ’ğ˜Tâ€‹(f1,g)â€–L2â€‹([0,T])\displaystyle\leq\norm{\mathbf{Y}\_{T}(f\_{1},g-(f\_{2}-f\_{1})\mathbf{G}y\_{2})-\mathbf{Y}\_{T}(f\_{1},g)}\_{L^{2}([0,T])} |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | â‰¤Ïˆâ€‹(M)â€‹â€–(f2âˆ’f1)ğ†y2)â€–L2â€‹([0,T])\displaystyle\leq\psi(M)\norm{(f\_{2}-f\_{1})\mathbf{G}y\_{2})}\_{L^{2}([0,T])} |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | â‰¤Ïˆâ€‹(M)â€‹â€–f2âˆ’f1â€–Lâˆâ€‹([0,T])â€‹â€–ğ†â€–L2â€‹([0,T])â€‹â€–y2â€–L2â€‹([0,T]).\displaystyle\leq\psi(M)\norm{f\_{2}-f\_{1}}\_{L^{\infty}([0,T])}\norm{\mathbf{G}}\_{L^{2}([0,T])}\norm{y\_{2}}\_{L^{2}([0,T])}. |  |

Therefore, we have that

|  |  |  |
| --- | --- | --- |
|  | â€–ğ˜Tâ€‹(f2,g)âˆ’ğ˜Tâ€‹(f1,g)â€–L2â€‹([0,T])â‰¤Câ€‹â€–f2âˆ’f1â€–Lâˆâ€‹([0,T])\norm{\mathbf{Y}\_{T}(f\_{2},g)-\mathbf{Y}\_{T}(f\_{1},g)}\_{L^{2}([0,T])}\leq C\norm{f\_{2}-f\_{1}}\_{L^{\infty}([0,T])} |  |

with C=Mâ€‹Ïˆâ€‹(M)â€‹â€–ğ†â€–L2â€‹([0,T])C=M\psi(M)\norm{\mathbf{G}}\_{L^{2}([0,T])} and thus fâ†¦ğ˜Tâ€‹(f,g)f\mapsto\mathbf{Y}\_{T}(f,g) is also Lipschitz continuous on â„¬ğ’â€‹([0,T])â€‹(0,M)\mathcal{B}\_{\mathcal{C}([0,T])}(0,M). Since both coordinates are Lipschitz on bounded sets, we deduce that ğ˜T\mathbf{Y}\_{T} is jointly continuous on ğ’â€‹([0,T])Ã—L2â€‹([0,T])\mathcal{C}([0,T])\times L^{2}([0,T]), which completes the proof.

## Appendix E Proof of TheoremÂ [3.3](https://arxiv.org/html/2601.03215v1#S3.Thmtheorem3 "Theorem 3.3. â€£ 3.2 The linear case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")

First, using the linearity of ğ’°\mathcal{U}, EquationÂ ([14](https://arxiv.org/html/2601.03215v1#S3.E14 "In 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")) rewrites

|  |  |  |
| --- | --- | --- |
|  | ru+aâ€‹ğ†â€‹ru=aâ€‹ğ†â€‹ur^{u}+a\mathbf{G}r^{u}=a\mathbf{G}u |  |

and therefore

|  |  |  |
| --- | --- | --- |
|  | ru=ğ‘â€‹(u)=aâ€‹(ğˆ+aâ€‹ğ†)âˆ’1â€‹ğ†â€‹u.r^{u}=\mathbf{R}(u)=a(\mathbf{I}+a\mathbf{G})^{-1}\mathbf{G}u. |  |

Note that the invertibility of ğˆ+aâ€‹ğ†\mathbf{I}+a\mathbf{G} is guaranteed by the existence and uniqueness of rur^{u} from LemmaÂ [3.2](https://arxiv.org/html/2601.03215v1#S3.Thmtheorem2 "Lemma 3.2. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact"), or alternatively by a direct application of TheoremÂ [C.2](https://arxiv.org/html/2601.03215v1#A3.Thmtheorem2 "Theorem C.2. â€£ C.1 Definition and main results. â€£ Appendix C Study of a nonlinear Volterra equation â€£ Trading with market resistance and concave price impact").
Now, algebraic computations ensure that

|  |  |  |
| --- | --- | --- |
|  | ğˆâˆ’ğ‘=ğˆâˆ’aâ€‹(ğˆ+aâ€‹ğ†)âˆ’1â€‹ğ†=(ğˆ+aâ€‹ğ†)âˆ’1,\mathbf{I}-\mathbf{R}=\mathbf{I}-a(\mathbf{I}+a\mathbf{G})^{-1}\mathbf{G}=(\mathbf{I}+a\mathbf{G})^{-1}, |  |

so that the gain functionalÂ ([23](https://arxiv.org/html/2601.03215v1#S3.E23 "In Reformulation with operators on â„’Â². â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")) rewrites

|  |  |  |
| --- | --- | --- |
|  | ğ’¥â€‹(u)=âŸ¨u,Î±âŸ©âˆ’Î³2â€‹â€–uâ€–2âˆ’âŸ¨u,(ğ‡+ğ†)âˆ˜(ğˆ+aâ€‹ğ†)âˆ’1â€‹uâŸ©âˆ’Ï•2â€‹â€–ğ—â€‹uâ€–2âˆ’Ï±2â€‹ğ”¼â€‹[(ğ—â€‹u)T2]+X0â€‹ğ”¼â€‹[ST].\mathcal{J}(u)=\langle u,\alpha\rangle-\frac{\gamma}{2}\|u\|^{2}-\langle u,(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}+a\mathbf{G})^{-1}u\rangle-\frac{\phi}{2}\norm{{\mathbf{X}}u}^{2}-\frac{\varrho}{2}\mathbb{E}[({\mathbf{X}}u)\_{T}^{2}]+X\_{0}\mathbb{E}[S\_{T}]. |  |

Coercivity of the gain functional readily follows from the positive semi-definiteness of the operator (ğ‡+ğ†)âˆ˜(ğˆ+aâ€‹ğ†)âˆ’1(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}+a\mathbf{G})^{-1}, which is guaranteed hereafter by LemmaÂ [E.1](https://arxiv.org/html/2601.03215v1#A5.Thmtheorem1 "Lemma E.1. â€£ Appendix E Proof of Theorem 3.3 â€£ Trading with market resistance and concave price impact"). Moreover, to prove the Î³âˆ’\gamma-strong convexity of âˆ’ğ’¥-\mathcal{J}, we prove equivalently the convexity of the functional

|  |  |  |
| --- | --- | --- |
|  | ğ’¥~â€‹(u):=âˆ’ğ’¥â€‹(u)âˆ’Î³2â€‹â€–uâ€–2,uâˆˆâ„’2,\widetilde{\mathcal{J}}(u):=-\mathcal{J}(u)-\frac{\gamma}{2}\norm{u}^{2},\quad u\in\mathcal{L}^{2}, |  |

see Bauschke and Combettes [[8](https://arxiv.org/html/2601.03215v1#bib.bib8), Proposition 10.8]. By straightforward calculus, ğ’¥\mathcal{J} is GÃ¢teaux differentiable at any uâˆˆâ„’2u\in\mathcal{L}^{2}, with GÃ¢teaux gradient

|  |  |  |
| --- | --- | --- |
|  | âˆ‡ğ’¥â€‹(u)=Î±âˆ’Î³â€‹uâˆ’((ğ‡+ğ†)âˆ˜(ğˆ+aâ€‹ğ†)âˆ’1+(ğ‡âˆ—+ğ†âˆ—)âˆ˜(ğˆ+aâ€‹ğ†âˆ—)âˆ’1)â€‹uâˆ’(ğ‡Ï•,Ï±+ğ‡Ï•,Ï±âˆ—)â€‹u.\nabla\mathcal{J}(u)=\alpha-\gamma u-\big((\mathbf{H}+\mathbf{G})\circ(\mathbf{I}+a\mathbf{G})^{-1}+(\mathbf{H}^{\*}+\mathbf{G}^{\*})\circ(\mathbf{I}+a\mathbf{G}^{\*})^{-1}\big)u-(\mathbf{H}\_{\phi,\varrho}+\mathbf{H}\_{\phi,\varrho}^{\*})u. |  |

Therefore

|  |  |  |
| --- | --- | --- |
|  | âˆ‡ğ’¥~â€‹(u)=âˆ’Î±+((ğ‡+ğ†)âˆ˜(ğˆ+aâ€‹ğ†)âˆ’1+(ğ‡âˆ—+ğ†âˆ—)âˆ˜(ğˆ+aâ€‹ğ†âˆ—)âˆ’1)â€‹u+(ğ‡Ï•,Ï±+ğ‡Ï•,Ï±âˆ—)â€‹u,uâˆˆâ„’2.\nabla\widetilde{\mathcal{J}}(u)=-\alpha+\big((\mathbf{H}+\mathbf{G})\circ(\mathbf{I}+a\mathbf{G})^{-1}+(\mathbf{H}^{\*}+\mathbf{G}^{\*})\circ(\mathbf{I}+a\mathbf{G}^{\*})^{-1}\big)u+(\mathbf{H}\_{\phi,\varrho}+\mathbf{H}\_{\phi,\varrho}^{\*})u,\quad u\in\mathcal{L}^{2}. |  |

By Bauschke and Combettes [[8](https://arxiv.org/html/2601.03215v1#bib.bib8), Proposition 17.10], it is sufficient to show the monotonicity of âˆ‡ğ’¥~\nabla\widetilde{\mathcal{J}} to prove the convexity of ğ’¥~\widetilde{\mathcal{J}}, i.e.,

|  |  |  |  |
| --- | --- | --- | --- |
|  | âŸ¨uâˆ’v,âˆ‡ğ’¥~â€‹(u)âˆ’âˆ‡ğ’¥~â€‹(v)âŸ©â‰¥0,u,vâˆˆâ„’2.\langle u-v,\nabla\widetilde{\mathcal{J}}(u)-\nabla\widetilde{\mathcal{J}}(v)\rangle\geq 0,\quad u,\,v\in\mathcal{L}^{2}. |  | (58) |

By linearity, propertyÂ ([58](https://arxiv.org/html/2601.03215v1#A5.E58 "In Appendix E Proof of Theorem 3.3 â€£ Trading with market resistance and concave price impact")) is equivalent to the positive semi-definiteness of the operators ğ‡Ï•,Ï±\mathbf{H}\_{\phi,\varrho} and (ğ‡+ğ†)âˆ˜(ğˆ+aâ€‹ğ†)âˆ’1(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}+a\mathbf{G})^{-1} which are proven in AbiÂ Jaber etÂ al. [[4](https://arxiv.org/html/2601.03215v1#bib.bib4), Lemma 4.3] and LemmaÂ [E.1](https://arxiv.org/html/2601.03215v1#A5.Thmtheorem1 "Lemma E.1. â€£ Appendix E Proof of Theorem 3.3 â€£ Trading with market resistance and concave price impact") respectively. Consequently, AbiÂ Jaber etÂ al. [[4](https://arxiv.org/html/2601.03215v1#bib.bib4), Theorem 4.1 (ii)] yields the existence and uniqueness of the optimal trading strategy u^\hat{u} satisfyingÂ ([20](https://arxiv.org/html/2601.03215v1#S3.E20 "In 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")) and the first-order condition âˆ‡ğ’¥â€‹(u^)=0\nabla\mathcal{J}(\hat{u})=0 stated inÂ ([24](https://arxiv.org/html/2601.03215v1#S3.E24 "In Theorem 3.3. â€£ 3.2 The linear case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")). Finally, to complete the argument, we prove the following lemma.

###### Lemma E.1.

The operator (ğ‡+ğ†)âˆ˜(ğˆâˆ’ğ‘)(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}-\mathbf{R}) is positive semi-definite, i.e.,

|  |  |  |
| --- | --- | --- |
|  | âŸ¨u,(ğ‡+ğ†)âˆ˜(ğˆâˆ’ğ‘)â€‹uâŸ©â‰¥0,uâˆˆâ„’2.\langle u,\,(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}-\mathbf{R})u\rangle\geq 0,\quad u\in\mathcal{L}^{2}. |  |

###### Proof.

Fix uâˆˆâ„’2u\in\mathcal{L}^{2}. Since ğˆâˆ’ğ‘=(ğˆ+aâ€‹ğ†)âˆ’1\mathbf{I}-\mathbf{R}=(\mathbf{I}+a\mathbf{G})^{-1}, we denote v=(ğˆ+aâ€‹ğ†)âˆ’1â€‹uv=(\mathbf{I}+a\mathbf{G})^{-1}u and we prove that

|  |  |  |
| --- | --- | --- |
|  | âŸ¨(ğˆ+aâ€‹ğ†)â€‹v,(ğ‡+ğ†)â€‹vâŸ©â‰¥0.\langle(\mathbf{I}+a\mathbf{G})v,\,(\mathbf{H}+\mathbf{G})v\rangle\geq 0. |  |

Expanding the inner product gives

|  |  |  |
| --- | --- | --- |
|  | âŸ¨(ğˆ+aâ€‹ğ†)â€‹v,(ğ‡+ğ†)â€‹vâŸ©=âŸ¨v,ğ‘¯â€‹vâŸ©+âŸ¨v,ğ‘®â€‹vâŸ©+aâ€‹â€–ğ‘®â€‹vâ€–L2â€‹([0,T])2+aâ€‹âŸ¨ğ‘®â€‹v,ğ‘¯â€‹vâŸ©.\langle(\mathbf{I}+a\mathbf{G})v,\,(\mathbf{H}+\mathbf{G})v\rangle=\langle v,\boldsymbol{H}v\rangle+\langle v,\boldsymbol{G}v\rangle+a\norm{\boldsymbol{G}v}\_{L^{2}([0,T])}^{2}+a\langle\boldsymbol{G}v,\boldsymbol{H}v\rangle. |  |

By the positive semi-definite property of ğ‘¯\boldsymbol{H} and ğ‘®\boldsymbol{G}, the first three terms are nonnegative. It remains then to show that

|  |  |  |  |
| --- | --- | --- | --- |
|  | âŸ¨ğ‘¯â€‹v,ğ‘®â€‹vâŸ©=âŸ¨ğ‘½â€‹v,vâŸ©â‰¥0\langle\boldsymbol{H}v,\boldsymbol{G}v\rangle=\langle\boldsymbol{V}v,v\rangle\geq 0 |  | (59) |

where

|  |  |  |
| --- | --- | --- |
|  | ğ‘½:=ğ‘®âˆ—âˆ˜ğ‘¯.\boldsymbol{V}:=\boldsymbol{G}^{\*}\circ\boldsymbol{H}. |  |

We first proveÂ ([59](https://arxiv.org/html/2601.03215v1#A5.E59 "In Proof. â€£ Appendix E Proof of Theorem 3.3 â€£ Trading with market resistance and concave price impact")) holds for when GG is an exponential kernel, and extend the result to all admissible kernels as specified in AssumptionÂ [A](https://arxiv.org/html/2601.03215v1#ThmAssumption1 "Assumption A. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact").

#### Exponential kernel case.

Let Î»>0\lambda>0 and assume that G=GÎ»G=G\_{\lambda} given by

|  |  |  |  |
| --- | --- | --- | --- |
|  | GÎ»â€‹(t):=eâˆ’Î»â€‹t,tâ‰¥0.G\_{\lambda}(t):=e^{-\lambda t},\quad t\geq 0. |  | (60) |

Applying Fubini, we obtain for any uâˆˆL2â€‹([0,T])u\in L^{2}([0,T])

|  |  |  |  |
| --- | --- | --- | --- |
|  | ğ‘½â€‹uâ€‹(t)\displaystyle\boldsymbol{V}u(t) | =(ğ‘®âˆ—âˆ˜ğ‘¯â€‹u)â€‹(t)=âˆ«0tÎºâˆÎ»â€‹uâ€‹(r)â€‹dr+âˆ«tTÎºâˆÎ»â€‹eâˆ’Î»â€‹(râˆ’t)â€‹uâ€‹(r)â€‹drâˆ’âˆ«0TÎºâˆÎ»â€‹eâˆ’Î»â€‹(Tâˆ’t)â€‹uâ€‹(r)â€‹dr\displaystyle=(\boldsymbol{G}^{\*}\circ\boldsymbol{H}u)(t)=\int\_{0}^{t}\frac{\kappa\_{\infty}}{\lambda}u(r)\differential r+\int\_{t}^{T}\frac{\kappa\_{\infty}}{\lambda}e^{-\lambda(r-t)}u(r)\differential r-\int\_{0}^{T}\frac{\kappa\_{\infty}}{\lambda}e^{-\lambda(T-t)}u(r)\differential r |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | =ÎºâˆÎ»â€‹(ğŸâ€‹uâ€‹(t)+ğ‘®âˆ—â€‹uâ€‹(t)âˆ’eâˆ’Î»â€‹(Tâˆ’t)â€‹ğŸâ€‹uâ€‹(T))\displaystyle=\frac{\kappa\_{\infty}}{\lambda}\big(\mathbf{1}u(t)+\boldsymbol{G}^{\*}u(t)-e^{-\lambda(T-t)}\mathbf{1}u(T)\big) |  |

where ğŸ\mathbf{1} is the operator given by ğŸâ€‹uâ€‹(t)=âˆ«0tuâ€‹(s)â€‹ds\mathbf{1}u(t)=\int\_{0}^{t}u(s)\differential s for every uâˆˆL2â€‹([0,T])u\in L^{2}([0,T]) and 0â‰¤tâ‰¤T0\leq t\leq T. We then have

|  |  |  |  |
| --- | --- | --- | --- |
|  | âŸ¨ğ‘½â€‹v,vâŸ©\displaystyle\langle\boldsymbol{V}v,v\rangle | =ÎºâˆÎ»â€‹(âŸ¨ğŸâ€‹v,vâŸ©+âŸ¨ğ‘®âˆ—â€‹v,vâŸ©âˆ’eâˆ’Î»â€‹Tâ€‹âˆ«0Tuâ€‹(t)â€‹dtâ€‹âˆ«0TeÎ»â€‹tâ€‹uâ€‹(t)â€‹dt)\displaystyle=\frac{\kappa\_{\infty}}{\lambda}\bigg(\langle\mathbf{1}v,v\rangle+\langle\boldsymbol{G}^{\*}v,v\rangle-e^{-\lambda T}\int\_{0}^{T}u(t)\differential t\int\_{0}^{T}e^{\lambda t}u(t)\differential t\bigg) |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | =ÎºâˆÎ»â€‹(âŸ¨ğŸâ€‹v,vâŸ©+âŸ¨ğ‘®â€‹v,vâŸ©âˆ’eâˆ’Î»â€‹Tâ€‹âˆ«0Tuâ€‹(t)â€‹dtâ€‹âˆ«0TeÎ»â€‹tâ€‹uâ€‹(t)â€‹dt).\displaystyle=\frac{\kappa\_{\infty}}{\lambda}\bigg(\langle\mathbf{1}v,v\rangle+\langle\boldsymbol{G}v,v\rangle-e^{-\lambda T}\int\_{0}^{T}u(t)\differential t\int\_{0}^{T}e^{\lambda t}u(t)\differential t\bigg). |  |

We define

|  |  |  |
| --- | --- | --- |
|  | yâ€‹(t):=ğ‘®â€‹vâ€‹(t)=âˆ«0teâˆ’Î»â€‹(tâˆ’s)â€‹vâ€‹(s)â€‹dsandzâ€‹(t):=ğŸâ€‹vâ€‹(t)=âˆ«0tvâ€‹(s)â€‹ds,y(t):=\boldsymbol{G}v(t)=\int\_{0}^{t}e^{-\lambda(t-s)}v(s)\differential s\quad\text{and}\quad z(t):=\mathbf{1}v(t)=\int\_{0}^{t}v(s)\differential s, |  |

so that y+â€²Î»y=vy{{}^{\prime}}+\lambda y=v and zâ€²=vz^{\prime}=v. We then write

|  |  |  |
| --- | --- | --- |
|  | âŸ¨ğ‘½â€‹v,vâŸ©=ÎºâˆÎ»â€‹(âˆ«0Tzâ€‹(t)â€‹vâ€‹(t)â€‹dt+âˆ«0Tyâ€‹(t)â€‹vâ€‹(t)â€‹dtâˆ’zâ€‹(T)â€‹yâ€‹(T)).\langle\boldsymbol{V}v,v\rangle=\frac{\kappa\_{\infty}}{\lambda}\bigg(\int\_{0}^{T}z(t)v(t)\differential t+\int\_{0}^{T}y(t)v(t)\differential t-z(T)y(T)\bigg). |  |

Furthermore, we have

|  |  |  |  |
| --- | --- | --- | --- |
|  | âˆ«0Tzâ€‹(t)â€‹vâ€‹(t)â€‹dt\displaystyle\int\_{0}^{T}z(t)v(t)\differential t | =âˆ«0Tzâ€‹(t)â€‹zâ€²â€‹(t)â€‹dt=12â€‹zâ€‹(T)2,\displaystyle=\int\_{0}^{T}z(t)z^{\prime}(t)\differential t=\frac{1}{2}z(T)^{2}, |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  | âˆ«0Tyâ€‹(t)â€‹vâ€‹(t)â€‹dt\displaystyle\int\_{0}^{T}y(t)v(t)\differential t | =âˆ«0Tyâ€²â€‹(t)â€‹yâ€‹(t)â€‹dt+Î»â€‹âˆ«0Tyâ€‹(t)2â€‹dt=12â€‹yâ€‹(T)2+Î»â€‹âˆ«0Tyâ€‹(t)2â€‹dt.\displaystyle=\int\_{0}^{T}y^{\prime}(t)y(t)\differential t+\lambda\int\_{0}^{T}y(t)^{2}\differential t=\frac{1}{2}y(T)^{2}+\lambda\int\_{0}^{T}y(t)^{2}\differential t. |  |

Combining these identities, we get

|  |  |  |  |
| --- | --- | --- | --- |
|  | âŸ¨ğ‘½â€‹v,vâŸ©\displaystyle\langle\boldsymbol{V}v,v\rangle | =ÎºâˆÎ»â€‹(12â€‹zâ€‹(T)2+12â€‹yâ€‹(T)2+Î»â€‹âˆ«0Tyâ€‹(t)2â€‹dtâˆ’zâ€‹(T)â€‹yâ€‹(T))\displaystyle=\frac{\kappa\_{\infty}}{\lambda}\bigg(\frac{1}{2}z(T)^{2}+\frac{1}{2}y(T)^{2}+\lambda\int\_{0}^{T}y(t)^{2}\differential t-z(T)y(T)\bigg) |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | =Îºâˆ2â€‹Î»â€‹((zâ€‹(T)âˆ’yâ€‹(T))2+2â€‹Î»â€‹âˆ«0Tyâ€‹(t)2â€‹dt)â‰¥0\displaystyle=\frac{\kappa\_{\infty}}{2\lambda}\bigg(\big(z(T)-y(T)\big)^{2}+2\lambda\int\_{0}^{T}y(t)^{2}\differential t\bigg)\geq 0 |  |

which provesÂ ([59](https://arxiv.org/html/2601.03215v1#A5.E59 "In Proof. â€£ Appendix E Proof of Theorem 3.3 â€£ Trading with market resistance and concave price impact")) when G=GÎ»G=G\_{\lambda}.

#### Proof in the general case.

First recall that since GG is a completely monotone kernel in L2L^{2}, there exists a Ïƒ\sigma-finite measure Î¼\mu such that

|  |  |  |
| --- | --- | --- |
|  | Gâ€‹(t)=âˆ«0âˆeâˆ’Î»â€‹tâ€‹Î¼â€‹(dÎ»),tâ‰¥0,G(t)=\int\_{0}^{\infty}e^{-\lambda t}\mu(\differential\lambda),\quad t\geq 0, |  |

see Theorem [B.3](https://arxiv.org/html/2601.03215v1#A2.Thmtheorem3 "Theorem B.3 (Bernstein-Widder representation). â€£ B.1 Completely monotone functions â€£ Appendix B Mathematical tools â€£ Trading with market resistance and concave price impact"). When Î¼\mu is finite, we can apply Fubiniâ€™s theorem which ensures that

|  |  |  |
| --- | --- | --- |
|  | (ğ‘®â€‹v)â€‹(t)=âˆ«0t(âˆ«0âˆeâˆ’Î»â€‹sâ€‹Î¼â€‹(dÎ»))â€‹vâ€‹(tâˆ’s)â€‹ds=âˆ«0âˆ(ğ‘®Î»â€‹v)â€‹(t)â€‹Î¼â€‹(dÎ»),(\boldsymbol{G}v)(t)=\int\_{0}^{t}\bigg(\int\_{0}^{\infty}e^{-\lambda s}\mu(\differential\lambda)\bigg)v(t-s)\differential s=\int\_{0}^{\infty}(\boldsymbol{G}\_{\lambda}v)(t)\,\mu(\differential\lambda), |  |

where ğ‘®Î»\boldsymbol{G}\_{\lambda} is the operator whose kernel is given byÂ ([60](https://arxiv.org/html/2601.03215v1#A5.E60 "In Exponential kernel case. â€£ Appendix E Proof of Theorem 3.3 â€£ Trading with market resistance and concave price impact")).
Applying Fubiniâ€™s theorem again gives

|  |  |  |
| --- | --- | --- |
|  | âŸ¨ğ‘¯â€‹v,ğ‘®â€‹vâŸ©=âˆ«0âˆâŸ¨ğ‘¯â€‹v,ğ‘®Î»â€‹vâŸ©â€‹Î¼â€‹(dÎ»).\langle\boldsymbol{H}v,\boldsymbol{G}v\rangle=\int\_{0}^{\infty}\langle\boldsymbol{H}v,\boldsymbol{G}\_{\lambda}v\rangle\,\mu(\differential\lambda). |  |

Weâ€™ve already proved that âŸ¨ğ‘¯â€‹v,ğ‘®Î»â€‹vâŸ©â‰¥0\langle\boldsymbol{H}v,\boldsymbol{G}\_{\lambda}v\rangle\geq 0 for all Î»>0\lambda>0 and thereforeÂ ([59](https://arxiv.org/html/2601.03215v1#A5.E59 "In Proof. â€£ Appendix E Proof of Theorem 3.3 â€£ Trading with market resistance and concave price impact")) holds.

When Î¼\mu is infinite, we first consider (An)n(A\_{n})\_{n} an increasing sequence of subsets on [0,âˆ)[0,\infty) such that Anâ†’[0,âˆ)A\_{n}\to[0,\infty) and Î¼â€‹(An)<âˆ\mu(A\_{n})<\infty. We then set Î¼n=Î¼â€‹ğŸ™An\mu\_{n}=\mu\mathbbm{1}\_{A\_{n}} and

|  |  |  |
| --- | --- | --- |
|  | G(n)â€‹(t)=âˆ«0âˆeâˆ’tâ€‹Î»â€‹Î¼nâ€‹(dÎ»).G^{(n)}(t)=\int\_{0}^{\infty}e^{-t\lambda}\,\mu\_{n}(\differential\lambda). |  |

This kernel is an approximation of GG. In fact, we have

|  |  |  |
| --- | --- | --- |
|  | 0â‰¤G(n)â€‹(t)â‰¤Gâ€‹(t)Â andÂ limnâ†’âˆG(n)â€‹(t)=Gâ€‹(t)0\leq G^{(n)}(t)\leq G(t)\qquad\text{ and }\qquad\lim\limits\_{n\to\infty}G^{(n)}(t)=G(t) |  |

for all tâ‰¥0t\geq 0.
Since GG is in L2L^{2}, the dominated convergence theorem applies and we have

|  |  |  |  |
| --- | --- | --- | --- |
|  | âˆ«0T(G(n)â€‹(s)âˆ’Gâ€‹(s))2â€‹dsâ†’0.\int\_{0}^{T}\big(G^{(n)}(s)-G(s)\big)^{2}\differential s\to 0. |  | (61) |

Moreover, G(n)G^{(n)} is a completely monotone kernel and in L2L^{2} because it is bounded by GG. Thus, as we have already proved, we know that âŸ¨ğ‘¯â€‹v,ğ‘®(n)â€‹vâŸ©â‰¥0\langle\boldsymbol{H}v,\boldsymbol{G}^{(n)}v\rangle\geq 0 where ğ‘®(n)\boldsymbol{G}^{(n)} is the convolution operator associated with G(n)G^{(n)}. To conclude, it remains to show that ğ‘®(ğ’)â€‹vâ†’ğ‘®â€‹v\boldsymbol{G^{(n)}}v\to\boldsymbol{G}v in L2â€‹([0,T])L^{2}([0,T]). In fact, we have

|  |  |  |  |
| --- | --- | --- | --- |
|  | â€–ğ‘®(ğ’)â€‹vâˆ’ğ‘®â€‹vâ€–2\displaystyle\norm{\boldsymbol{G^{(n)}}v-\boldsymbol{G}v}^{2} | =âˆ«0T|(ğ‘®(ğ’)â€‹vâˆ’ğ‘®â€‹v)â€‹(t)|2â€‹dt\displaystyle=\int\_{0}^{T}|(\boldsymbol{G^{(n)}}v-\boldsymbol{G}v)(t)|^{2}\differential t |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | =âˆ«0T|âˆ«0tvâ€‹(tâˆ’s)â€‹(G(n)â€‹(s)âˆ’Gâ€‹(s))â€‹ds|2â€‹dt\displaystyle=\int\_{0}^{T}\bigg|\int\_{0}^{t}v(t-s)\big(G^{(n)}(s)-G(s)\big)\differential s\bigg|^{2}\differential t |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | â‰¤Tâ€‹â€–uâ€–2â€‹âˆ«0T(G(n)â€‹(s)âˆ’Gâ€‹(s))2â€‹ds\displaystyle\leq T\norm{u}^{2}\int\_{0}^{T}\big(G^{(n)}(s)-G(s)\big)^{2}\differential s |  |

which converges to 0 byÂ ([61](https://arxiv.org/html/2601.03215v1#A5.E61 "In Proof in the general case. â€£ Appendix E Proof of Theorem 3.3 â€£ Trading with market resistance and concave price impact")).

âˆ

## Appendix F Proof of TheoremÂ [3.6](https://arxiv.org/html/2601.03215v1#S3.Thmtheorem6 "Theorem 3.6. â€£ 3.3 The general case â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")

### F.1 Outline of the proof

Since â„’2\mathcal{L}^{2} is a Hilbert space, an application of Struwe [[36](https://arxiv.org/html/2601.03215v1#bib.bib36), Theorem 1.2, Chapter 1] ensures the existence of a maximizer of ğ’¥\mathcal{J} provided âˆ’ğ’¥-\mathcal{J} is coercive and weakly lower semi-continuous. Therefore, we can conclude using the following two lemmas.

###### Lemma F.1.

Suppose that Î©\Omega is countable or finite and that AssumptionsÂ [B](https://arxiv.org/html/2601.03215v1#ThmAssumption2 "Assumption B. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact"),Â [A](https://arxiv.org/html/2601.03215v1#ThmAssumption1 "Assumption A. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact") andÂ [C](https://arxiv.org/html/2601.03215v1#ThmAssumption3 "Assumption C. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact") hold. Then ğ’¥\mathcal{J} is weakly continuous in L2L^{2}.

###### Lemma F.2.

Suppose that Îºâˆ+Î³>0\kappa\_{\infty}+\gamma>0 and that AssumptionsÂ [B](https://arxiv.org/html/2601.03215v1#ThmAssumption2 "Assumption B. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact"),Â [A](https://arxiv.org/html/2601.03215v1#ThmAssumption1 "Assumption A. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact") andÂ [C](https://arxiv.org/html/2601.03215v1#ThmAssumption3 "Assumption C. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact") hold. Then âˆ’ğ’¥-\mathcal{J} is coercive in L2L^{2}.

The proof of these two lemmas is deferred to SectionsÂ [F.4](https://arxiv.org/html/2601.03215v1#A6.SS4 "F.4 Proof of Lemma F.2 â€£ Appendix F Proof of Theorem 3.6 â€£ Trading with market resistance and concave price impact") andÂ [F.3](https://arxiv.org/html/2601.03215v1#A6.SS3 "F.3 Proof of Lemma F.1 â€£ Appendix F Proof of Theorem 3.6 â€£ Trading with market resistance and concave price impact"). They rely on the properties of the operator ğ\mathbf{B} defined on â„’2\mathcal{L}^{2} by

|  |  |  |
| --- | --- | --- |
|  | ğâ€‹uâ€‹(t)=ğ’°â€‹(ğ†â€‹uâ€‹(t)),tâ‰¥0.\mathbf{B}u(t)=\mathcal{U}\big(\mathbf{G}u(t)\big),\quad t\geq 0. |  |

The properties of this operator are studied in SectionÂ [F.2](https://arxiv.org/html/2601.03215v1#A6.SS2 "F.2 Properties of the operator ğ â€£ Appendix F Proof of Theorem 3.6 â€£ Trading with market resistance and concave price impact").

### F.2 Properties of the operator ğ\mathbf{B}

###### Lemma F.3.

We have ğˆâˆ’ğ‘=(ğˆ+ğ)âˆ’1\mathbf{I}-\mathbf{R}=(\mathbf{I}+\mathbf{B})^{-1}. Moreover, there exists c>0c>0 such that

|  |  |  |  |
| --- | --- | --- | --- |
|  | câˆ’1â€‹â€–uâ€–â‰¤â€–(ğˆ+ğ)âˆ’1â€–â‰¤câ€‹â€–uâ€–.c^{-1}\norm{u}\leq\norm{(\mathbf{I}+\mathbf{B})^{-1}}\leq c\norm{u}. |  | (62) |

###### Proof.

Note that for all uâˆˆâ„’2u\in\mathcal{L}^{2}, w=(ğˆâˆ’ğ‘)â€‹uw=(\mathbf{I}-\mathbf{R})u satisfies

|  |  |  |
| --- | --- | --- |
|  | wâ€‹(t)=uâ€‹(t)âˆ’ruâ€‹(t)=uâ€‹(t)âˆ’ğ’°â€‹(ğ†â€‹wâ€‹(t))w(t)=u(t)-r^{u}(t)=u(t)-\mathcal{U}\big(\mathbf{G}w(t)\big) |  |

and thus u=(ğˆ+ğ)â€‹wu=(\mathbf{I}+\mathbf{B})w. Moreover, adapting the results of AppendixÂ [C](https://arxiv.org/html/2601.03215v1#A3 "Appendix C Study of a nonlinear Volterra equation â€£ Trading with market resistance and concave price impact"), we see that for each uu, the equation

|  |  |  |
| --- | --- | --- |
|  | wâ€‹(t)+ğ’°â€‹(ğ†â€‹wâ€‹(t))=uâ€‹(t)w(t)+\mathcal{U}\big(\mathbf{G}w(t)\big)=u(t) |  |

admits a unique solution in â„’2\mathcal{L}^{2}. This ensures that ğˆ+ğ\mathbf{I}+\mathbf{B} is invertible and thus ğˆâˆ’ğ‘=(ğˆ+ğ)âˆ’1\mathbf{I}-\mathbf{R}=(\mathbf{I}+\mathbf{B})^{-1}.

To proveÂ ([62](https://arxiv.org/html/2601.03215v1#A6.E62 "In Lemma F.3. â€£ F.2 Properties of the operator ğ â€£ Appendix F Proof of Theorem 3.6 â€£ Trading with market resistance and concave price impact")), we use the fact that both ğˆ+ğ\mathbf{I}+\mathbf{B} and (ğˆ+ğ)âˆ’1(\mathbf{I}+\mathbf{B})^{-1} are Lipschitz, which follows readily from the fact that ğ\mathbf{B} is Lipschitz continuous because both ğ’°\mathcal{U} and ğ†\mathbf{G} are Lipschitz continuous and from the fact that ğ‘\mathbf{R} is Lipschitz continuous.
âˆ

Note that the operator ğ\mathbf{B} satisfies the assumptions of LemmaÂ [B.6](https://arxiv.org/html/2601.03215v1#A2.Thmtheorem6 "Lemma B.6. â€£ B.2 Operators in â„’Â² and in ğ¿Â² â€£ Appendix B Mathematical tools â€£ Trading with market resistance and concave price impact"): it is defined through a deterministic relation and thus can naturally extend to a non-anticipative operator ğË‡\widecheck{\mathbf{B}} in L2L^{2}. The same holds for ğ‘\mathbf{R} and we also have

|  |  |  |
| --- | --- | --- |
|  | ğˆâˆ’ğ‘Ë‡=(ğˆ+ğË‡)âˆ’1.\mathbf{I}-\widecheck{\mathbf{R}}=(\mathbf{I}+\widecheck{\mathbf{B}})^{-1}. |  |

The properties of ğË‡\widecheck{\mathbf{B}} are studied below.

###### Lemma F.4.

The operator ğË‡\widecheck{\mathbf{B}} is weakly continuous in L2L^{2}.

###### Proof.

Let xnâ‡€xx\_{n}\rightharpoonup x. Since ğ†1\mathbf{G}\_{1} is a convolution operator, it is also compact and therefore, we know that ğ†1â€‹xnâ†’ğ†1â€‹x\mathbf{G}\_{1}x\_{n}\to\mathbf{G}\_{1}x. Then since ğ’°\mathcal{U} is Lipschitz continuous, we deduce that ğË‡â€‹xnâ†’ğË‡â€‹x\widecheck{\mathbf{B}}x\_{n}\to\widecheck{\mathbf{B}}x which implies that ğË‡â€‹xnâ‡€ğË‡â€‹x\widecheck{\mathbf{B}}x\_{n}\rightharpoonup\widecheck{\mathbf{B}}x.
âˆ

###### Lemma F.5.

The operator (ğˆ+ğË‡)âˆ’1(\mathbf{I}+\widecheck{\mathbf{B}})^{-1} is weakly continuous in L2L^{2}.

###### Proof.

We consider ynâ‡€yy\_{n}\rightharpoonup y and we define

|  |  |  |
| --- | --- | --- |
|  | xn=(ğˆ+ğË‡)âˆ’1â€‹ynÂ andÂ x=(ğˆ+ğË‡)âˆ’1â€‹yx\_{n}=(\mathbf{I}+\widecheck{\mathbf{B}})^{-1}y\_{n}\quad\text{ and }\quad x=(\mathbf{I}+\widecheck{\mathbf{B}})^{-1}y |  |

so that

|  |  |  |
| --- | --- | --- |
|  | yn=xn+ğË‡â€‹xnÂ andÂ y=x+ğË‡â€‹x.y\_{n}=x\_{n}+\widecheck{\mathbf{B}}x\_{n}\quad\text{ and }\quad y=x+\widecheck{\mathbf{B}}x. |  |

We want to prove that xnâ‡€xx\_{n}\rightharpoonup x. The proof is done in two steps: first we show that the sequence (xn)(x\_{n}) lies in a weak compact set, and then show that if xnkâ‡€xâ€²x\_{n\_{k}}\rightharpoonup x^{\prime} for some nkn\_{k}, then we must have xâ€²=xx^{\prime}=x.

Step 1: (xn)(x\_{n}) lies in a weak compact set.
We start by showing that (xn)n(x\_{n})\_{n} is bounded in L2L^{2}. As a start, we define

|  |  |  |
| --- | --- | --- |
|  | rn=ynâˆ’xn=ynâˆ’(ğˆ+ğË‡)âˆ’1â€‹yn=ğ‘â€‹(yn).r\_{n}=y\_{n}-x\_{n}=y\_{n}-(\mathbf{I}+\widecheck{\mathbf{B}})^{-1}y\_{n}=\mathbf{R}(y\_{n}). |  |

We know from LemmaÂ [3.2](https://arxiv.org/html/2601.03215v1#S3.Thmtheorem2 "Lemma 3.2. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact") that ğ‘\mathbf{R} is Lipschitz continuous, and therefore there exists C>0C>0 such that

|  |  |  |
| --- | --- | --- |
|  | â€–rnâ€–â‰¤Câ€‹â€–ynâ€–.\norm{r\_{n}}\leq C\norm{y\_{n}}. |  |

Therefore, we have

|  |  |  |
| --- | --- | --- |
|  | â€–xnâ€–=â€–ynâˆ’rnâ€–â‰¤(C+1)â€‹â€–ynâ€–.\norm{x\_{n}}=\norm{y\_{n}-r\_{n}}\leq(C+1)\norm{y\_{n}}. |  |

But (yn)n(y\_{n})\_{n} is a bounded sequence in L2L^{2} because it is weakly convergent and therefore (xn)n(x\_{n})\_{n} is bounded. This implies in turn that (xn)n(x\_{n})\_{n} lies in a weak compact set because every bounded and closed set in a Hilbert space is weakly relatively compact.

Step 2: Identification of the weak accumulation point of (xn)n(x\_{n})\_{n}. Consider a weakly convergent subsequence of (xn)(x\_{n}), that we still write (xn)(x\_{n}) for conciseness. We denote by xâ€²x^{\prime} its limit and we prove that xâ€²=xx^{\prime}=x. By weak continuity of ğË‡\widecheck{\mathbf{B}}, we know that

|  |  |  |
| --- | --- | --- |
|  | ğË‡â€‹xnâ‡€ğË‡â€‹xâ€²\widecheck{\mathbf{B}}x\_{n}\rightharpoonup\widecheck{\mathbf{B}}x^{\prime} |  |

and thus

|  |  |  |
| --- | --- | --- |
|  | yn=xn+ğË‡â€‹xnâ‡€xâ€²+ğË‡â€‹xâ€².y\_{n}=x\_{n}+\widecheck{\mathbf{B}}x\_{n}\rightharpoonup x^{\prime}+\widecheck{\mathbf{B}}x^{\prime}. |  |

By uniqueness of the limit, we have y=xâ€²+ğË‡â€‹xâ€²y=x^{\prime}+\widecheck{\mathbf{B}}x^{\prime} which implies that xâ€²=(ğˆ+ğË‡)âˆ’1â€‹y=xx^{\prime}=(\mathbf{I}+\widecheck{\mathbf{B}})^{-1}y=x.
âˆ

### F.3 Proof of LemmaÂ [F.1](https://arxiv.org/html/2601.03215v1#A6.Thmtheorem1 "Lemma F.1. â€£ F.1 Outline of the proof â€£ Appendix F Proof of Theorem 3.6 â€£ Trading with market resistance and concave price impact")

FromÂ ([23](https://arxiv.org/html/2601.03215v1#S3.E23 "In Reformulation with operators on â„’Â². â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")), we know that

|  |  |  |
| --- | --- | --- |
|  | âˆ’ğ’¥â€‹(u)=âˆ’âŸ¨u,Î±âŸ©+Î³2â€‹â€–uâ€–2+âŸ¨u,(ğ‡+ğ†)âˆ˜(ğˆâˆ’ğ‘)â€‹uâŸ©+Ï•2â€‹â€–ğ—â€‹uâ€–2+Ï±2â€‹ğ”¼â€‹[(ğ—â€‹u)T2]âˆ’X0â€‹ğ”¼â€‹[ST].-\mathcal{J}(u)=-\langle u,\alpha\rangle+\frac{\gamma}{2}\norm{u}^{2}+\langle u,(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}-\mathbf{R})u\rangle+\frac{\phi}{2}\norm{{\mathbf{X}}u}^{2}+\frac{\varrho}{2}\mathbb{E}[({\mathbf{X}}u)\_{T}^{2}]-X\_{0}\mathbb{E}[S\_{T}]. |  |

Following AbiÂ Jaber etÂ al. [[4](https://arxiv.org/html/2601.03215v1#bib.bib4), Lemma 6.2], we know that uâ†¦âˆ’âŸ¨u,Î±âŸ©+Î³2â€‹â€–uâ€–2u\mapsto-\langle u,\alpha\rangle+\frac{\gamma}{2}\norm{u}^{2} and
uâ†¦Ï•â€‹â€–ğ—â€‹uâ€–2+Ï±â€‹ğ”¼â€‹[(ğ—â€‹u)T2]u\mapsto\phi\norm{{\mathbf{X}}u}^{2}+\varrho\mathbb{E}[({\mathbf{X}}u)\_{T}^{2}]
are weakly lower semi-continuous. It remains to study uâ†¦âŸ¨u,(ğ‡+ğ†)âˆ˜(ğˆâˆ’ğ‘)â€‹uâŸ©u\mapsto\langle u,(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}-\mathbf{R})u\rangle. LemmaÂ [F.3](https://arxiv.org/html/2601.03215v1#A6.Thmtheorem3 "Lemma F.3. â€£ F.2 Properties of the operator ğ â€£ Appendix F Proof of Theorem 3.6 â€£ Trading with market resistance and concave price impact") ensures that (ğ‡+ğ†)âˆ˜(ğˆâˆ’ğ‘)=(ğ‡+ğ†)âˆ˜(ğˆ+ğ)âˆ’1(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}-\mathbf{R})=(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}+\mathbf{B})^{-1}. This is done in two steps:

* â€¢

  Step 1. We first study (ğ‡Ë‡+ğ†Ë‡)âˆ˜(ğˆ+ğË‡)âˆ’1(\widecheck{\mathbf{H}}+\widecheck{\mathbf{G}})\circ(\mathbf{I}+\widecheck{\mathbf{B}})^{-1} in L2L^{2} and we show that uâ†¦âŸ¨u,(ğ‡Ë‡+ğ†Ë‡)âˆ˜(ğˆâˆ’ğ‘Ë‡)â€‹uâŸ©u\mapsto\langle u,(\widecheck{\mathbf{H}}+\widecheck{\mathbf{G}})\circ(\mathbf{I}-\widecheck{\mathbf{R}})u\rangle is weakly semi-continuous in L2L^{2}.
* â€¢

  Step 2. We then show that weak lower semi-continuity extends to â„’2\mathcal{L}^{2} using crucially that Î©\Omega is finite or countable.

Proof of Step 1. Recall first that although the operators ğ‡Ë‡\widecheck{\mathbf{H}}, ğ†Ë‡\widecheck{\mathbf{G}} and ğË‡\widecheck{\mathbf{B}} are defined on â„’2\mathcal{L}^{2}, they can be seen as operator in L2L^{2} because all these operators are defined through deterministic relations. We are now ready to prove that uâ†¦âŸ¨(ğ‡Ë‡+ğ†Ë‡)âˆ˜(ğˆË‡+ğË‡)âˆ’1â€‹u,uâŸ©u\mapsto\langle(\widecheck{\mathbf{H}}+\widecheck{\mathbf{G}})\circ(\widecheck{\mathbf{I}}+\widecheck{\mathbf{B}})^{-1}u,u\rangle is weakly continuous in L2L^{2}. Consider unâ‡€uu\_{n}\rightharpoonup u. We want to prove that

|  |  |  |
| --- | --- | --- |
|  | âŸ¨(ğ‡Ë‡+ğ†Ë‡)âˆ˜(ğˆË‡+ğË‡)âˆ’1â€‹un,unâŸ©â†’âŸ¨(ğ‡Ë‡+ğ†Ë‡)âˆ˜(ğˆË‡+ğË‡)âˆ’1â€‹u,uâŸ©.\langle(\widecheck{\mathbf{H}}+\widecheck{\mathbf{G}})\circ(\widecheck{\mathbf{I}}+\widecheck{\mathbf{B}})^{-1}u\_{n},u\_{n}\rangle\to\langle(\widecheck{\mathbf{H}}+\widecheck{\mathbf{G}})\circ(\widecheck{\mathbf{I}}+\widecheck{\mathbf{B}})^{-1}u,u\rangle. |  |

We have

|  |  |  |
| --- | --- | --- |
|  | |âŸ¨(ğ‡Ë‡+ğ†Ë‡)âˆ˜(ğˆË‡+ğË‡)âˆ’1â€‹un,unâŸ©âˆ’âŸ¨(ğ‡Ë‡+ğ†Ë‡)âˆ˜(ğˆË‡+ğË‡)âˆ’1â€‹u,uâŸ©|â‰¤I+II|\langle(\widecheck{\mathbf{H}}+\widecheck{\mathbf{G}})\circ(\widecheck{\mathbf{I}}+\widecheck{\mathbf{B}})^{-1}u\_{n},u\_{n}\rangle-\langle(\widecheck{\mathbf{H}}+\widecheck{\mathbf{G}})\circ(\widecheck{\mathbf{I}}+\widecheck{\mathbf{B}})^{-1}u,u\rangle|\leq\mathrm{I}+\mathrm{II} |  |

where

|  |  |  |  |
| --- | --- | --- | --- |
|  | I\displaystyle\mathrm{I} | =|âŸ¨(ğ‡Ë‡+ğ†Ë‡)âˆ˜(ğˆË‡+ğË‡)âˆ’1â€‹unâˆ’(ğ‡Ë‡+ğ†Ë‡)âˆ˜(ğˆË‡+ğË‡)âˆ’1â€‹u,unâŸ©|\displaystyle=|\langle(\widecheck{\mathbf{H}}+\widecheck{\mathbf{G}})\circ(\widecheck{\mathbf{I}}+\widecheck{\mathbf{B}})^{-1}u\_{n}-(\widecheck{\mathbf{H}}+\widecheck{\mathbf{G}})\circ(\widecheck{\mathbf{I}}+\widecheck{\mathbf{B}})^{-1}u,u\_{n}\rangle| |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  | II\displaystyle\mathrm{II} | =|âŸ¨(ğ‡Ë‡+ğ†Ë‡)âˆ˜(ğˆË‡+ğË‡)âˆ’1â€‹u,unâˆ’uâŸ©|.\displaystyle=|\langle(\widecheck{\mathbf{H}}+\widecheck{\mathbf{G}})\circ(\widecheck{\mathbf{I}}+\widecheck{\mathbf{B}})^{-1}u,u\_{n}-u\rangle|. |  |

Clearly IIâ†’0\mathrm{II}\to 0 because unâ‡€uu\_{n}\rightharpoonup u and (ğ‡Ë‡+ğ†Ë‡)âˆ˜(ğˆË‡+ğË‡)âˆ’1â€‹u(\widecheck{\mathbf{H}}+\widecheck{\mathbf{G}})\circ(\widecheck{\mathbf{I}}+\widecheck{\mathbf{B}})^{-1}u is in L2L^{2}. Moreover, using the weak continuity of (ğˆË‡+ğË‡)âˆ’1(\widecheck{\mathbf{I}}+\widecheck{\mathbf{B}})^{-1}, we have

|  |  |  |
| --- | --- | --- |
|  | (ğˆË‡+ğË‡)âˆ’1â€‹unâ‡€(ğˆË‡+ğË‡)âˆ’1â€‹u.(\widecheck{\mathbf{I}}+\widecheck{\mathbf{B}})^{-1}u\_{n}\rightharpoonup(\widecheck{\mathbf{I}}+\widecheck{\mathbf{B}})^{-1}u. |  |

Seeing that ğ‡Ë‡+ğ†Ë‡\widecheck{\mathbf{H}}+\widecheck{\mathbf{G}} is a compact operator because it is a convolution operator, we deduce that

|  |  |  |
| --- | --- | --- |
|  | (ğ‡Ë‡+ğ†Ë‡)âˆ˜(ğˆË‡+ğË‡)âˆ’1â€‹unâ†’(ğ‡Ë‡+ğ†Ë‡)âˆ˜(ğˆË‡+ğË‡)âˆ’1â€‹u.(\widecheck{\mathbf{H}}+\widecheck{\mathbf{G}})\circ(\widecheck{\mathbf{I}}+\widecheck{\mathbf{B}})^{-1}u\_{n}\to(\widecheck{\mathbf{H}}+\widecheck{\mathbf{G}})\circ(\widecheck{\mathbf{I}}+\widecheck{\mathbf{B}})^{-1}u. |  |

In addition, (un)n(u\_{n})\_{n} is bounded because it is weakly convergent, and thus

|  |  |  |
| --- | --- | --- |
|  | Iâ‰¤â€–(ğ‡Ë‡+ğ†Ë‡)âˆ˜(ğˆË‡+ğË‡)âˆ’1â€‹unâˆ’(ğ‡Ë‡+ğ†Ë‡)âˆ˜(ğˆË‡+ğË‡)âˆ’1â€‹uâ€–â€‹â€–unâ€–â†’0.I\leq\norm{(\widecheck{\mathbf{H}}+\widecheck{\mathbf{G}})\circ(\widecheck{\mathbf{I}}+\widecheck{\mathbf{B}})^{-1}u\_{n}-(\widecheck{\mathbf{H}}+\widecheck{\mathbf{G}})\circ(\widecheck{\mathbf{I}}+\widecheck{\mathbf{B}})^{-1}u}\norm{u\_{n}}\to 0. |  |

Proof of Step 2. We now prove that the weak lower semi-continuity extends to â„’2\mathcal{L}^{2}. Consider (un)n(u\_{n})\_{n} a sequence of â„’2\mathcal{L}^{2} processes converging weakly to uu. Following the proof of AbiÂ Jaber etÂ al. [[4](https://arxiv.org/html/2601.03215v1#bib.bib4), Lemma 6.2], we see that the for â„™\mathbb{P}-almost all Ï‰\omega, we have

|  |  |  |
| --- | --- | --- |
|  | unâ€‹(Ï‰,â‹…)â‡€uâ€‹(Ï‰,â‹…)Â inÂ â€‹L2.u\_{n}(\omega,\cdot)\rightharpoonup u(\omega,\cdot)\qquad\text{ in }L^{2}. |  |

Therefore, applying the results of Step 1, we have, for â„™\mathbb{P}-almost all Ï‰\omega

|  |  |  |
| --- | --- | --- |
|  | âŸ¨(ğ‡Ë‡+ğ†Ë‡)âˆ˜(ğˆË‡+ğË‡)âˆ’1â€‹unâ€‹(Ï‰,â‹…),unâ€‹(Ï‰,â‹…)âŸ©L2â€‹([0,T])â†’âŸ¨(ğ‡Ë‡+ğ†Ë‡)âˆ˜(ğˆË‡+ğË‡)âˆ’1â€‹uâ€‹(Ï‰,â‹…),uâ€‹(Ï‰,â‹…)âŸ©L2â€‹([0,T])\langle(\widecheck{\mathbf{H}}+\widecheck{\mathbf{G}})\circ(\widecheck{\mathbf{I}}+\widecheck{\mathbf{B}})^{-1}u\_{n}(\omega,\cdot),u\_{n}(\omega,\cdot)\rangle\_{L^{2}([0,T])}\to\langle(\widecheck{\mathbf{H}}+\widecheck{\mathbf{G}})\circ(\widecheck{\mathbf{I}}+\widecheck{\mathbf{B}})^{-1}u(\omega,\cdot),u(\omega,\cdot)\rangle\_{L^{2}([0,T])} |  |

as nâ†’âˆn\to\infty. Using Fatouâ€™s Lemma, we get

|  |  |  |
| --- | --- | --- |
|  | lim infnâ†’âˆğ”¼â€‹[âŸ¨(ğ‡Ë‡+ğ†Ë‡)âˆ˜(ğˆË‡+ğË‡)âˆ’1â€‹unâ€‹(Ï‰,â‹…),unâ€‹(Ï‰,â‹…)âŸ©L2â€‹([0,T])]â‰¥ğ”¼â€‹[âŸ¨(ğ‡Ë‡+ğ†Ë‡)âˆ˜(ğˆË‡+ğË‡)âˆ’1â€‹uâ€‹(Ï‰,â‹…),uâ€‹(Ï‰,â‹…)âŸ©L2â€‹([0,T])].\liminf\_{n\to\infty}\mathbb{E}[\langle(\widecheck{\mathbf{H}}+\widecheck{\mathbf{G}})\circ(\widecheck{\mathbf{I}}+\widecheck{\mathbf{B}})^{-1}u\_{n}(\omega,\cdot),u\_{n}(\omega,\cdot)\rangle\_{L^{2}([0,T])}]\geq\mathbb{E}[\langle(\widecheck{\mathbf{H}}+\widecheck{\mathbf{G}})\circ(\widecheck{\mathbf{I}}+\widecheck{\mathbf{B}})^{-1}u(\omega,\cdot),u(\omega,\cdot)\rangle\_{L^{2}([0,T])}]. |  |

Using the definition of the scalar product in â„’2\mathcal{L}^{2}, we deduce that

|  |  |  |
| --- | --- | --- |
|  | lim infnâ†’âˆâŸ¨(ğ‡+ğ†)âˆ˜(ğˆ+ğ)âˆ’1â€‹un,unâŸ©â„’2â€‹([0,T])â‰¥âŸ¨(ğ‡+ğ†)âˆ˜(ğˆ+ğ)âˆ’1â€‹u,uâŸ©â„’2â€‹([0,T]),\liminf\_{n\to\infty}\,\langle({\mathbf{H}}+{\mathbf{G}})\circ({\mathbf{I}}+{\mathbf{B}})^{-1}u\_{n},u\_{n}\rangle\_{\mathcal{L}^{2}([0,T])}\geq\langle({\mathbf{H}}+{\mathbf{G}})\circ({\mathbf{I}}+{\mathbf{B}})^{-1}u,u\rangle\_{\mathcal{L}^{2}([0,T])}, |  |

which exactly entails the weak lower semi-continuity of uâ†¦âŸ¨u,(ğ‡+ğ†)âˆ˜(ğˆâˆ’ğ‘)â€‹uâŸ©u\mapsto\langle u,(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}-\mathbf{R})u\rangle.

### F.4 Proof of LemmaÂ [F.2](https://arxiv.org/html/2601.03215v1#A6.Thmtheorem2 "Lemma F.2. â€£ F.1 Outline of the proof â€£ Appendix F Proof of Theorem 3.6 â€£ Trading with market resistance and concave price impact")

FromÂ ([23](https://arxiv.org/html/2601.03215v1#S3.E23 "In Reformulation with operators on â„’Â². â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact")), we know that

|  |  |  |  |
| --- | --- | --- | --- |
|  | âˆ’ğ’¥â€‹(u)\displaystyle-\mathcal{J}(u) | =âˆ’âŸ¨u,Î±âŸ©+Î³2â€‹â€–uâ€–2+âŸ¨u,(ğ‡+ğ†)âˆ˜(ğˆ+ğ)âˆ’1â€‹uâŸ©+Ï•2â€‹â€–ğ—â€‹uâ€–2+Ï±2â€‹ğ”¼â€‹[(ğ—â€‹u)T2]+X0â€‹ğ”¼â€‹[ST]\displaystyle=-\langle u,\alpha\rangle+\frac{\gamma}{2}\norm{u}^{2}+\langle u,(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}+\mathbf{B})^{-1}u\rangle+\frac{\phi}{2}\norm{{\mathbf{X}}u}^{2}+\frac{\varrho}{2}\mathbb{E}[({\mathbf{X}}u)\_{T}^{2}]+X\_{0}\mathbb{E}[S\_{T}] |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | â‰¥âˆ’âŸ¨u,Î±âŸ©+Î³2â€‹â€–uâ€–2+âŸ¨u,(ğ‡+ğ†)âˆ˜(ğˆ+ğ)âˆ’1â€‹uâŸ©+X0â€‹ğ”¼â€‹[ST].\displaystyle\geq-\langle u,\alpha\rangle+\frac{\gamma}{2}\norm{u}^{2}+\langle u,(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}+\mathbf{B})^{-1}u\rangle+X\_{0}\mathbb{E}[S\_{T}]. |  |

To prove the coercivity of âˆ’ğ’¥-\mathcal{J}, we first show the following bound.

###### Lemma F.6.

For each Ïµ>0\epsilon>0, there exists b>0b>0 such that

|  |  |  |
| --- | --- | --- |
|  | âŸ¨u,(ğ‡+ğ†)âˆ˜(ğˆ+ğ)âˆ’1â€‹uâŸ©â‰¥b+(Îºâˆ2âˆ’Ïµ)â€‹â€–uâ€–2.\langle u,(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}+\mathbf{B})^{-1}u\rangle\geq b+\Big(\frac{\kappa\_{\infty}}{2}-\epsilon\Big)\norm{u}^{2}. |  |

###### Proof of LemmaÂ [F.6](https://arxiv.org/html/2601.03215v1#A6.Thmtheorem6 "Lemma F.6. â€£ F.4 Proof of Lemma F.2 â€£ Appendix F Proof of Theorem 3.6 â€£ Trading with market resistance and concave price impact").

We fix uâˆˆâ„’2u\in\mathcal{L}^{2} and define v=(ğˆ+ğ)âˆ’1â€‹uv=(\mathbf{I}+\mathbf{B})^{-1}u so that

|  |  |  |
| --- | --- | --- |
|  | âŸ¨u,(ğ‡+ğ†)âˆ˜(ğˆ+ğ)âˆ’1â€‹uâŸ©=âŸ¨v+ğâ€‹v,(ğ‡+ğ†)â€‹vâŸ©=âŸ¨(ğ‡+ğ†)â€‹v,vâŸ©+âŸ¨(ğ‡+ğ†)â€‹v,ğâ€‹vâŸ©.\langle u,(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}+\mathbf{B})^{-1}u\rangle=\langle v+\mathbf{B}v,(\mathbf{H}+\mathbf{G})v\rangle=\langle(\mathbf{H}+\mathbf{G})v,v\rangle+\langle(\mathbf{H}+\mathbf{G})v,\mathbf{B}v\rangle. |  |

We then define U~â€‹(x)=Uâ€‹(x)âˆ’Î´â€‹x\widetilde{U}(x)=U(x)-\delta x
where Î´\delta is defined in AssumptionÂ [C](https://arxiv.org/html/2601.03215v1#ThmAssumption3 "Assumption C. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact"). Then U~\widetilde{U} is a Lipschitz continuous function and

|  |  |  |
| --- | --- | --- |
|  | U~â€‹(x)xâ†’0\frac{\widetilde{U}(x)}{x}\to 0 |  |

when xâ†’âˆx\to\infty. This implies in particular that for all Ïµ>0\epsilon>0, there exists c>0c>0 such that
|U~â€‹(x)|â‰¤c+Ïµâ€‹|x||\widetilde{U}(x)|\leq c+\epsilon|x| for all xâˆˆâ„x\in\mathbb{R}. We now define the operator

|  |  |  |
| --- | --- | --- |
|  | ğ~â€‹w=U~â€‹(ğ†â€‹w)\widetilde{\mathbf{B}}w=\widetilde{U}(\mathbf{G}w) |  |

so that ğ=ğ~+Î´â€‹ğ†\mathbf{B}=\widetilde{\mathbf{B}}+\delta\mathbf{G}. We then write

|  |  |  |  |
| --- | --- | --- | --- |
|  | âŸ¨u,(ğ‡+ğ†)âˆ˜(ğˆ+ğ)âˆ’1â€‹uâŸ©\displaystyle\langle u,(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}+\mathbf{B})^{-1}u\rangle | =âŸ¨(ğ‡+ğ†)â€‹v,vâŸ©+Î´â€‹âŸ¨(ğ‡+ğ†)â€‹v,ğ†â€‹vâŸ©+âŸ¨(ğ‡+ğ†)â€‹v,ğ~â€‹vâŸ©\displaystyle=\langle(\mathbf{H}+\mathbf{G})v,v\rangle+\delta\langle(\mathbf{H}+\mathbf{G})v,\mathbf{G}v\rangle+\langle(\mathbf{H}+\mathbf{G})v,\widetilde{\mathbf{B}}v\rangle |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | =âŸ¨ğ‡â€‹v,vâŸ©+âŸ¨ğ†â€‹v,vâŸ©+Î´â€‹âŸ¨ğ‡â€‹v,ğ†â€‹vâŸ©+Î´â€‹â€–ğ†â€‹vâ€–2+âŸ¨(ğ‡+ğ†)â€‹v,ğ~â€‹vâŸ©.\displaystyle=\langle\mathbf{H}v,v\rangle+\langle\mathbf{G}v,v\rangle+\delta\langle\mathbf{H}v,\mathbf{G}v\rangle+\delta\norm{\mathbf{G}v}^{2}+\langle(\mathbf{H}+\mathbf{G})v,\widetilde{\mathbf{B}}v\rangle. |  |

Using the specification of ğ‡\mathbf{H} in AssumptionÂ [B](https://arxiv.org/html/2601.03215v1#ThmAssumption2 "Assumption B. â€£ 3.1 Problem formulation â€£ 3 Optimal trading with market resistance â€£ Trading with market resistance and concave price impact"), we have that

|  |  |  |
| --- | --- | --- |
|  | âŸ¨ğ‡â€‹v,vâŸ©=Îºâˆ2â€‹â€–vâ€–2.\langle\mathbf{H}v,v\rangle=\frac{\kappa\_{\infty}}{2}\norm{v}^{2}. |  |

UsingÂ ([59](https://arxiv.org/html/2601.03215v1#A5.E59 "In Proof. â€£ Appendix E Proof of Theorem 3.3 â€£ Trading with market resistance and concave price impact")) and the fact that ğ†\mathbf{G} is semi-definite positive, we deduce that

|  |  |  |
| --- | --- | --- |
|  | âŸ¨u,(ğ‡+ğ†)âˆ˜(ğˆ+ğ)âˆ’1â€‹uâŸ©â‰¥Îºâˆ2â€‹â€–vâ€–2+âŸ¨(ğ‡+ğ†)â€‹v,ğ~â€‹vâŸ©.\langle u,(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}+\mathbf{B})^{-1}u\rangle\geq\frac{\kappa\_{\infty}}{2}\norm{v}^{2}+\langle(\mathbf{H}+\mathbf{G})v,\widetilde{\mathbf{B}}v\rangle. |  |

For the last term, we have

|  |  |  |  |
| --- | --- | --- | --- |
|  | |âŸ¨(ğ‡+ğ†)â€‹v,ğ~â€‹vâŸ©|\displaystyle|\langle(\mathbf{H}+\mathbf{G})v,\widetilde{\mathbf{B}}v\rangle| | â‰¤ğ”¼â€‹[âˆ«0T|(ğ‡+ğ†)â€‹vâ€‹(t)â€‹ğ~â€‹vâ€‹(t)|â€‹dt]\displaystyle\leq\mathbb{E}\bigg[\int\_{0}^{T}|(\mathbf{H}+\mathbf{G})v(t)\widetilde{\mathbf{B}}v(t)|\mathrm{d}t\bigg] |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | â‰¤câ€‹ğ”¼â€‹[âˆ«0T|(ğ‡+ğ†)â€‹vâ€‹(t)|â€‹dt]+Ïµâ€‹ğ”¼â€‹[âˆ«0T|(ğ‡+ğ†)â€‹vâ€‹(t)â€‹ğ†~â€‹vâ€‹(t)|â€‹dt]\displaystyle\leq c\mathbb{E}\bigg[\int\_{0}^{T}|(\mathbf{H}+\mathbf{G})v(t)|\mathrm{d}t\bigg]+\epsilon\mathbb{E}\bigg[\int\_{0}^{T}|(\mathbf{H}+\mathbf{G})v(t)\widetilde{\mathbf{G}}v(t)|\mathrm{d}t\bigg] |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | â‰¤câ€‹ğ”¼â€‹[âˆ«0T(ğ‡+ğ†)â€‹|v|â€‹(t)â€‹dt]+Ïµâ€‹ğ”¼â€‹[âˆ«0T(ğ‡+ğ†)â€‹|v|â€‹(t)â€‹ğ†~â€‹|v|â€‹(t)â€‹dt]\displaystyle\leq c\mathbb{E}\bigg[\int\_{0}^{T}(\mathbf{H}+\mathbf{G})|v|(t)\mathrm{d}t\bigg]+\epsilon\mathbb{E}\Big[\int\_{0}^{T}(\mathbf{H}+\mathbf{G})|v|(t)\widetilde{\mathbf{G}}|v|(t)\,\mathrm{d}t\Big] |  |

From the continuity properties of ğ‡\mathbf{H} and ğ†\mathbf{G}, we deduce that there exists c1,c2>0c\_{1},c\_{2}>0 such that

|  |  |  |
| --- | --- | --- |
|  | |âŸ¨(ğ‡+ğ†)â€‹v,ğ~â€‹vâŸ©|â‰¤c1â€‹â€–vâ€–+c2â€‹Ïµâ€‹â€–vâ€–2|\langle(\mathbf{H}+\mathbf{G})v,\widetilde{\mathbf{B}}v\rangle|\leq c\_{1}\norm{v}+c\_{2}\epsilon\norm{v}^{2} |  |

and therefore

|  |  |  |
| --- | --- | --- |
|  | âŸ¨u,(ğ‡+ğ†)âˆ˜(ğˆ+ğ)âˆ’1â€‹uâŸ©â‰¥(Îºâˆ2âˆ’c2â€‹Ïµ)â€‹â€–vâ€–2âˆ’c1â€‹â€–vâ€–.\langle u,(\mathbf{H}+\mathbf{G})\circ(\mathbf{I}+\mathbf{B})^{-1}u\rangle\geq\Big(\frac{\kappa\_{\infty}}{2}-c\_{2}\epsilon\Big)\norm{v}^{2}-c\_{1}\norm{v}. |  |

We conclude usingÂ ([62](https://arxiv.org/html/2601.03215v1#A6.E62 "In Lemma F.3. â€£ F.2 Properties of the operator ğ â€£ Appendix F Proof of Theorem 3.6 â€£ Trading with market resistance and concave price impact")).
âˆ

It remains to show how LemmaÂ [F.6](https://arxiv.org/html/2601.03215v1#A6.Thmtheorem6 "Lemma F.6. â€£ F.4 Proof of Lemma F.2 â€£ Appendix F Proof of Theorem 3.6 â€£ Trading with market resistance and concave price impact") implies LemmaÂ [F.2](https://arxiv.org/html/2601.03215v1#A6.Thmtheorem2 "Lemma F.2. â€£ F.1 Outline of the proof â€£ Appendix F Proof of Theorem 3.6 â€£ Trading with market resistance and concave price impact"). Using that uu and Î±\alpha are both in â„’2\mathcal{L}^{2}, then for each Ïµ>0\epsilon>0, there exists b>0b>0 such that

|  |  |  |
| --- | --- | --- |
|  | âˆ’ğ’¥â€‹(u)â‰¥b+(Îºâˆ+Î³2âˆ’Ïµ)â€‹â€–uâ€–2.-\mathcal{J}(u)\geq b+\Big(\frac{\kappa\_{\infty}+\gamma}{2}-\epsilon\Big)\norm{u}^{2}. |  |

We can conclude whenever Îºâˆ+Î³>0\kappa\_{\infty}+\gamma>0 by taking 0<Ïµ<Îºâˆ+Î³0<\epsilon<\kappa\_{\infty}+\gamma.