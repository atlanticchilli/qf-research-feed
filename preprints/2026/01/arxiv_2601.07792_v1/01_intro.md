---
authors:
- Javier Mancilla
- Theodoros D. Bouloumis
- Frederic Goguikian
doc_id: arxiv:2601.07792v1
family_id: arxiv:2601.07792
is_current: true
taxonomy:
  alpha_families: []
  asset_classes: []
  horizons: []
  themes: []
title: 'Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis
  Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking'
url_abs: http://arxiv.org/abs/2601.07792v1
url_html: https://arxiv.org/html/2601.07792v1
venue: arXiv q-fin
version: 1
year: 2026
---

program = IsingSamplingProgram(
    model, free_blocks, clamped_blocks=[])
samples = sample_states(
    key, program, schedule,
    init_state, [], [Block(nodes)])
```

## Appendix B Code Availability Statement

The code is available upon request to javier.m@squareonecap.com

## Acknowledgment

The authors thanks the Extropic team for developing and open-sourcing the THRML library.

## References

* [1]
  D. Bertsimas, C. Darnell, and R. Soucy (1999)
  Portfolio construction through mixed-integer programming at Grantham, Mayo, Van Otterloo and Company.
  Interfaces 29 (1),  pp. 49–66.
  Cited by: [§I](https://arxiv.org/html/2601.07792v1#S1.p3.1 "I Introduction ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking"),
  [§II-B](https://arxiv.org/html/2601.07792v1#S2.SS2.p2.1 "II-B Cardinality-Constrained Optimization ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [2]
  D. Bertsimas and R. Shioda (2009)
  Algorithm for cardinality constrained quadratic optimization.
  Computational Optimization and Applications 43 (1),  pp. 1–22.
  Cited by: [§II-B](https://arxiv.org/html/2601.07792v1#S2.SS2.p2.1 "II-B Cardinality-Constrained Optimization ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [3]
  D. Bienstock (1996)
  Computational study of a family of mixed-integer quadratic programming problems.
  Mathematical Programming 74 (2),  pp. 121–140.
  Cited by: [§I](https://arxiv.org/html/2601.07792v1#S1.p2.4 "I Introduction ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking"),
  [§II-B](https://arxiv.org/html/2601.07792v1#S2.SS2.p1.2 "II-B Cardinality-Constrained Optimization ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [4]
  K. Deb, A. Pratap, S. Agarwal, and T. Meyarivan (2002)
  A fast and elitist multiobjective genetic algorithm: NSGA-II.
  IEEE Transactions on Evolutionary Computation 6 (2),  pp. 182–197.
  Cited by: [§I](https://arxiv.org/html/2601.07792v1#S1.p3.1 "I Introduction ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking"),
  [§II-B](https://arxiv.org/html/2601.07792v1#S2.SS2.p2.1 "II-B Cardinality-Constrained Optimization ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [5]
  F. X. Diebold and R. S. Mariano (1995)
  Comparing predictive accuracy.
  Journal of Business & Economic Statistics 13 (3),  pp. 253–263.
  Cited by: [§IV-F](https://arxiv.org/html/2601.07792v1#S4.SS6.p1.1 "IV-F Statistical Testing ‣ IV Experimental Setup ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [6]
  Extropic AI (2024)
  Thermodynamic computing: the future of probabilistic ai.
  Note: WhitepaperAvailable online at extropic.ai
  Cited by: [§II-C](https://arxiv.org/html/2601.07792v1#S2.SS3.p6.1 "II-C Energy-Based Models in Machine Learning ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [7]
  Extropic AI (2024)
  THRML: thermodynamic hypergraphical model library.
  Note: <https://docs.thrml.ai/en/latest/>Accessed: 2025-01-01
  Cited by: [Appendix A](https://arxiv.org/html/2601.07792v1#A1.p1.1 "Appendix A THRML Library Usage ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking"),
  [§I](https://arxiv.org/html/2601.07792v1#S1.p4.1 "I Introduction ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking"),
  [§II-C](https://arxiv.org/html/2601.07792v1#S2.SS3.p6.1 "II-C Energy-Based Models in Machine Learning ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking"),
  [§III-D](https://arxiv.org/html/2601.07792v1#S3.SS4.p1.2 "III-D Gibbs Sampling via THRML ‣ III Methodology ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [8]
  F. J. Fabozzi, P. N. Kolm, D. A. Pachamanova, and S. M. Focardi (2007)
  Robust portfolio optimization and management.
   John Wiley & Sons.
  Cited by: [§II-A](https://arxiv.org/html/2601.07792v1#S2.SS1.p4.1 "II-A Classical Portfolio Optimization ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [9]
  E. Farhi, J. Goldstone, and S. Gutmann (2014)
  A quantum approximate optimization algorithm.
  arXiv preprint arXiv:1411.4028.
  Cited by: [§II-D](https://arxiv.org/html/2601.07792v1#S2.SS4.p1.1 "II-D Quantum and Quantum-Inspired Finance ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [10]
  F. Glover, G. Kochenberger, and Y. Du (2019)
  A tutorial on formulating and using QUBO models.
  arXiv preprint arXiv:1811.11538.
  Cited by: [§II-D](https://arxiv.org/html/2601.07792v1#S2.SS4.p1.1 "II-D Quantum and Quantum-Inspired Finance ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [11]
  G. E. Hinton and R. R. Salakhutdinov (2006)
  Reducing the dimensionality of data with neural networks.
  Science 313 (5786),  pp. 504–507.
  Cited by: [§II-C](https://arxiv.org/html/2601.07792v1#S2.SS3.p5.2 "II-C Energy-Based Models in Machine Learning ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [12]
  E. Ising (1925)
  Beitrag zur theorie des ferromagnetismus.
  Zeitschrift für Physik 31 (1),  pp. 253–258.
  Cited by: [item 1](https://arxiv.org/html/2601.07792v1#S1.I1.i1.p1.2 "In I Introduction ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking"),
  [§II-C](https://arxiv.org/html/2601.07792v1#S2.SS3.p3.3 "II-C Energy-Based Models in Machine Learning ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [13]
  C. S. Jensen, U. Kjærulff, and A. Kong (1995)
  Blocking gibbs sampling in very large probabilistic expert systems.
  International Journal of Human-Computer Studies 42 (6),  pp. 647–666.
  External Links: ISSN 1071-5819
  Cited by: [§II-C](https://arxiv.org/html/2601.07792v1#S2.SS3.p6.1 "II-C Energy-Based Models in Machine Learning ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [14]
  E. Jurczenko (2016)
  Risk-based and factor investing.
   ISTE Press - Elsevier.
  External Links: ISBN 978-1-78548-008-9
  Cited by: [§II-A](https://arxiv.org/html/2601.07792v1#S2.SS1.p3.2 "II-A Classical Portfolio Optimization ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [15]
  S. Kirkpatrick, C. D. Gelatt, and M. P. Vecchi (1983)
  Optimization by simulated annealing.
  Science 220 (4598),  pp. 671–680.
  Cited by: [§I](https://arxiv.org/html/2601.07792v1#S1.p3.1 "I Introduction ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking"),
  [§II-B](https://arxiv.org/html/2601.07792v1#S2.SS2.p2.1 "II-B Cardinality-Constrained Optimization ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [16]
  H. Lang et al. (2022)
  Quantum annealing for combinatorial optimization: a comparative study.
  IEEE Transactions on Quantum Engineering 3,  pp. 1–15.
  Cited by: [§II-B](https://arxiv.org/html/2601.07792v1#S2.SS2.p2.1 "II-B Cardinality-Constrained Optimization ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [17]
  O. Ledoit and M. Wolf (2004)
  Honey, i shrunk the sample covariance matrix.
  The Journal of Portfolio Management 30 (4),  pp. 110–119.
  Cited by: [§II-A](https://arxiv.org/html/2601.07792v1#S2.SS1.p4.1 "II-A Classical Portfolio Optimization ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [18]
  M. López de Prado (2016)
  Building diversified portfolios that outperform out of sample.
  The Journal of Financial Data Science 1 (1),  pp. 9–18.
  Note: (Hierarchical Risk Parity)
  Cited by: [§II-A](https://arxiv.org/html/2601.07792v1#S2.SS1.p4.1 "II-A Classical Portfolio Optimization ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [19]
  H. Markowitz (1952)
  Portfolio selection.
  The Journal of Finance 7 (1),  pp. 77–91.
  Cited by: [§I](https://arxiv.org/html/2601.07792v1#S1.p1.1 "I Introduction ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking"),
  [§II-A](https://arxiv.org/html/2601.07792v1#S2.SS1.p1.3 "II-A Classical Portfolio Optimization ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [20]
  R. O. Michaud and R. O. Michaud (2008)
  Efficient asset management: a practical guide to stock portfolio optimization and asset allocation.
  2nd edition, Oxford University Press.
  Cited by: [§II-A](https://arxiv.org/html/2601.07792v1#S2.SS1.p3.2 "II-A Classical Portfolio Optimization ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [21]
  R. Orús, S. Mugel, and E. Lizaso (2019)
  Quantum computing for finance: overview and prospects.
  Reviews in Physics 4,  pp. 100028.
  Cited by: [§II-D](https://arxiv.org/html/2601.07792v1#S2.SS4.p1.1 "II-D Quantum and Quantum-Inspired Finance ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").
* [22]
  E. Tang (2019)
  A quantum-inspired classical algorithm for recommendation systems.
  In Proceedings of the 51st Annual ACM SIGACT Symposium on Theory of Computing,
   pp. 217–228.
  Cited by: [§II-D](https://arxiv.org/html/2601.07792v1#S2.SS4.p2.1 "II-D Quantum and Quantum-Inspired Finance ‣ II Literature Review ‣ Non-Convex Portfolio Optimization via Energy-Based Models: A Comparative Analysis Using the Thermodynamic HypergRaphical Model Library (THRML) for Index Tracking").